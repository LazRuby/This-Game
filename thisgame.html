<!DOCTYPE html>
<html>
<head>
	<title>starting over</title>
    <link rel="shortcut icon" href="./pub/gimal/favi.ico"  sizes="64x64"/>
    <link rel= "stylesheet" type="text/css" href="pub/Gacha/Gacha.css">
    <link rel= "stylesheet" type="text/css" href="pub/Deck/Deck.css">
    <link rel= "stylesheet" type="text/css" href="pub/Deck_Skill/Deck_Skill.css">
	<style> @font-face{ font-family:Goyang; src:url(pub/Gacha/Goyang.ttf); } </style>
    <link rel="shortcut icon" href="./gimal/favi.ico"  sizes="64x64"/>
    <link rel="stylesheet" type="text/css" href="./pub/gamedesign.css"/>
	<script  src="https://code.jquery.com/jquery-latest.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
	<script type="text/javascript">
		var sot = 1;
		$(window).load(function(){
            var stone="true";
            $("#yel").click( function() {
				var result1 = parseInt(1/5);
				
				$('#yel').css('color','red');
                
                if(stone=="true"){
                    $("#ground").show();
                    stone="false";
                }else if(stone=="false"){
                     $("#ground").hide();
                    stone="true";
                }
			});
        });
		function change(){
			sot=1;
		}
	</script>
</head>
<body>
    <div id="daichi" style="display:none;">
           <div id='uptown'>
                <div id='rcost'>
                <a id="r_accost">
                    6
                </a>
                <br>
                <a>
                    --------
                </a>
                <br>
                <a>
                    6
                </a>
            </div>
            <div id='you_deck'>
                <img id="huda01" class='huda' src="./pub/board/gettc.png">
                <img id="huda02" class='huda' src="./pub/board/gettc.png">
                <img id="huda03" class='huda' src="./pub/board/gettc.png">
                <img id="huda04" class='huda' src="./pub/board/gettc.png">
                <img id="huda05" class='huda' src="./pub/board/gettc.png">
                <img id="huda06" class='huda' src="./pub/board/gettc.png">
                <img id="huda07" class='huda' src="./pub/board/gettc.png">
                <img id="huda08" class='huda' src="./pub/board/gettc.png">
            </div>
            </div>
           <div class="line">&nbsp</div>
           <br>
           <div id='ground'>
                <table id='board'>
                    <tr>
                        <th id="g1" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g2" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g3" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g4" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g5" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g6" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g7" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g8" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th id="g9" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g10" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g11" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g12" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g13" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g14" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g15" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g16" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th id="g17" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0"></div>
                        </th>
                        <th id="g18" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g19" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g20" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g21" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g22" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g23" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g24" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th id="g25" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g26" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g27" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g28" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g29" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g30" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g31" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g32" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                    </tr>
                    <tr>
                        <th id="g33" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g34" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g35" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g36" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g37" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g38" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g39" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g40" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                    </tr>
                    <tr>
                        <th id="g41" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g42" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g43" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g44" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g45" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g46" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6; z-index:2; display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g47" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g48" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6; z-index:2; display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th id="g49" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g50" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g51" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g52" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g53" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>	
                        </th>
                        <th id="g54" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g55" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g56" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <th id="g57" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g58" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g59" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g60" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g61" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g62" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g63" class='field'>
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                        <th id="g64" class="field">
                            <div class="mirai" style="width:100%; height:100%;opacity:0.6;z-index:2;display:none;position:absolute;top:0;left:0">
                            </div>
                        </th>
                    </tr>
            </table>
            <div>
                <button id='tend'>Turn end</button>
                <button id='chcard'>next huda</button>
            </div>
        </div>
            <div class="line">&nbsp</div>
            <div id='downtown'>
                <div id='my_deck'>
                    <img id="huda1" class='huda' src="./pub/board/gettc.png">
                    <img id="huda2" class='huda' src="./pub/board/gettc.png">
                    <img id="huda3" class='huda' src="./pub/board/gettc.png">
                    <img id="huda4" class='huda' src="./pub/board/gettc.png">
                    <img id="huda5" class='huda' src="./pub/board/gettc.png">
                    <img id="huda6" class='huda' src="./pub/board/gettc.png">
                    <img id="huda7" class='huda' src="./pub/board/gettc.png">
                    <img id="huda8" class='huda' src="./pub/board/gettc.png">
                </div>
                <div id='myd_block'>
                    <img id="bhuda1" class='huda' src="./pub/board/blac.jpg" style="opacity: 0.0;">
                    <img id="bhuda2" class='huda' src="./pub/board/blac.jpg" style="opacity: 0.0;">
                    <img id="bhuda3" class='huda' src="./pub/board/blac.jpg" style="opacity: 0.0;">
                    <img id="bhuda4" class='huda' src="./pub/board/blac.jpg" style="opacity: 0.0;">
                    <img id="bhuda5" class='huda' src="./pub/board/blac.jpg" style="opacity: 0.0;">
                    <img id="bhuda6" class='huda' src="./pub/board/blac.jpg" style="opacity: 0.0;">
                    <img id="bhuda7" class='huda' src="./pub/board/blac.jpg" style="opacity: 0.0;">
                    <img id="bhuda8" class='huda' src="./pub/board/blac.jpg" style="opacity: 0.0;">
                </div>
               <div id='bcost'>
                    <a id="b_accost">
                        6
                    </a>
                    <br>
                    <a>
                        --------
                    </a>
                    <br>
                    <a>
                        6
                    </a>
                </div>
            </div>
    </div>
    
    <div id='main_view'>
        
		<div id="map">
            
            <img id="main_map" class="map_img_class" src="/pub/board/Background.png" usemap="#001" border="0">
		
            <map name="001">
                
                <area shape="poly" id="skill_deck_id" coords="41,490,155,573,182,555,148,523,253,467,198,423" class="mapmouseover"/>
                <area shape="poly" id="config" coords="60,337,100,414,234,375,158,299" class="mapmouseover" />
                <area shape="poly" id="deck_id" coords="285,456,153,523,268,604,379,502" class="mapmouseover" />
                <area shape="poly" id="gacha_id" coords="677,534,519,688,728,706,796,528" class="mapmouseover" />
                <area shape="poly" id="mcr_r" coords="963,405,949,638,1176,603,1086,381" class="mapmouseover" />

            </map>

            <img id="main_map2" class="map_img_class" src="/pub/board/Background2.png" usemap="#002" border="0" style="display:none;">
            
             <map name="002">
                
                <area shape="poly" id="out_room" coords="41,490,155,573,182,555,148,523,253,467,198,423" class="mapmouseover"/>
                <area shape="poly" id="invite" coords="60,337,100,414,234,375,158,299" class="mapmouseover" />
                <area shape="poly" id="out_room2" coords="285,456,153,523,268,604,379,502" class="mapmouseover" />
                <area shape="poly" id="ready_b" coords="677,534,519,688,728,706,796,528" class="mapmouseover" />
                <area shape="poly" id="go_start" coords="963,405,949,638,1176,603,1086,381" class="mapmouseover" />

            </map>
            
	   </div>
        
        <div id="waitroom_back"></div>
        <div id='waitroom'>
            
				<div id="sub_waitr" style="width:100%; height:100%; display:block;">
					<div id='store_room' style="width:100%; height:95%; overflow-y: auto;"></div>
				</div>
            
				<div id="ready_room" style="width:100%; height:100%; display:none;">
                    
					<div id="room_name" style="width:100%; text-align: center;">
                        <a style="font-weight:bold; font-size:3em; color: white; font-family:'Goyang', Goyang;">d</a>
                    </div>
                    
					<div style="width:100%; height:95%;">
                        
						<div id="master_rarea" style="float:left; width:35%; height:95%; margin-top:0.8%; font-family:'Goyang', Goyang; text-align:center;">
							<img src="pub/board/Main Icon.png" style="width:85%; height:65%; margin-top: 5%;">
							<div class="ready_room_name">
								<a id="first_p" style="font-size:1.8em; font-weight: bold; color:white; text-align: center;">lazRuby2</a>
								</br>
								<a style="font-size:1.3em; font-weight: bold; color:white; text-align: center;">level 1</a>
							</div>
						</div>
                    
						<div style="width:10%; height:50%; float:left; margin-left: 9.2%; margin-top: 15.5%;">
							<img src="pub/board/VS.png" style="width:7vw; height:7vw;">
						</div>
                    
						<div id="rival_rarea" style="float:right; width:35%; height:95%; margin-top:0.8%; font-family:'Goyang', Goyang; text-align: center;">
							<img src="pub/board/Main Icon2.png" style="width:85%; height:65%; margin-top: 5%;">
                            <div id="ready" style="display: none;"><a style="font-weight: bold; text-align: center;">Ready</a></div>
							<div class="ready_room_name">
								<a id="second_p" style="font-size:1.8em; font-weight: bold; color:white; text-align: center;">lazRuby2</a>
								</br>
								<a style="font-size:1.3em; font-weight: bold; color:white;">level 1</a>
							</div>
						</div>
        
					</div>
				</div>
			</div>	
    </div>

	<div id="cre_room">
        
		<div style="width:100%; background-color: darkslategray; text-align:center; border-radius: 7px;"><a style="font-weight: bold; font-family:'Goyang', Goyang; font-size:2em; color:white;">Create Room</a></div>
        
		<form id="cre_form" style="margin-top: 2%; margin-left: 3%; text-align:center;"><br>
            <input id="cre_rname" type="text" placeholder="Room Name : " style="width:80%;"><br><br>
            <input id="cre_rpw" type="text" placeholder="Room PassWord : " style="width:80%;"><br>
        </form>
        
        <br>
        
         <div class = "check_cre" style="margin-top: 2%; margin-left: 3%; margin-bottom: 2%; text-align:center;">
            <img id="submit_cre" class="join"  style="width:3.5vw; border-radius: 7px;"src="pub/board/Ok.png">
            <img id="cancel_cre" class="join" style="width:3.5vw; border-radius: 7px;"src="pub/board/Cancle2.png">
        </div>
        
	</div>

    <div id="invite_room" style="display: none;">
		<div style="width:100%; background-color: darkslategray; text-align:center; border-radius: 7px;"><a style="font-weight: bold; font-family:'Goyang', Goyang; font-size:2em; color:white;">Invite</a></div>
        <div id="invite_list" style="font-size:1.2em; font-family:'Goyang', Goyang;">
            <ul>
                <li class="ro_list">
                        <a>초대 목록</a>
                        <ul id="plist" class="plist">
                        </ul>
                </li>
            </ul>
        </div>
        <div class = "check_invite" style="margin-top: 2%; text-align:center;">
            <button type="button" id="cancel_invite" class="join"><img style="width:3.5vw; border-radius: 7px;"src="pub/board/Cancle.png"></button>
        </div>
	</div>

	<div id='cutton' style="display:none;">
		<img id='show' src="./pub/board/black.jpg" style="opacity: 0.8; width:100%; height:100%">
		<div>
			<img id="hero">
			<img id="rival">
			<div id="hhp">
			<a id="ghp">HP:80/100</a>	
			<div id="edel" class="cup" sytle="background-color:white">
				&nbsp
			<div class="gaze">
			</div>
			</div>
			</div>

			<div id="rhp">
			<a id="ghp2">HP:80/100</a>	
			<div id="rdel" class="cup2" sytle="background-color:white">
				&nbsp
			<div class="gaze2">
			</div>
			</div>
			</div>
		</div>
		<div id="yaru">
			<button id='move' type="button">move</button>
			<br>
			<br>
			<button id='attack' type="button">attack</button>
			<br>
			<br>
			<button id='close' type="button">close</button>
		</div>
	</div>

    <div id="big_card" style="display: none;">
		<img id="bigc_img"/>
	</div>

    <div id="sikaba">
		<img id="sika_l" src="./pub/board/l_arrow.png" style="width:11%; height: 15%;float:left;margin-top: 12.5%;margin-left: 0.5%;">
		<div id="dead_hero1" class="dead_hero" style="float:left;width:15%;height:60%;margin-left: 4.5%;margin-top: 1%;">
			<img style="width:100%; height: 100%;">
			<a class="sika_name">name:</a>
			<br>
			<a class="sika_hp">hp:</a>
			<br>
			<a class="sika_ak">atk:</a>
		</div>
		<div id="dead_hero2" class="dead_hero" style="float:left;width:15%;height:60%;margin-left: 3%;margin-top: 1%;">
			<img style="width:100%; height: 100%;">
			<a class="sika_name">name:</a>
			<br>
			<a class="sika_hp">hp:</a>
			<br>
			<a class="sika_ak">atk:</a>
		</div>
		<div id="dead_hero3" class="dead_hero" style="float:left;width:15%;height:60%;margin-left: 3%;margin-top: 1%;">
			<img style="width:100%; height: 100%;">
			<a class="sika_name">name:</a>
			<br>
			<a class="sika_hp">hp:</a>
			<br>
			<a class="sika_ak">atk:</a>
		</div>
		<div id="dead_hero4" class="dead_hero" style="float:left;width:15%;height:60%;margin-left: 3%;margin-top: 1%;">
			<img style="width:100%; height: 100%;">
			<a class="sika_name">name:</a>
			<br>
			<a class="sika_hp">hp:</a>
			<br>
			<a class="sika_ak">atk:</a>
		</div>
		<img id="sika_r" src="./pub/board/r_arrow.png" style="width:11%; height: 15%;float:right;margin-top: 12.5%;margin-right: 0.5%;">
        <div style="width:30%; margin-top: 31%;margin-left: 45%;"><button id="sika_close">close</button></div>
	</div>

    <div id="setting_back">
    <div id="setting"> 
        
		<audio id="jk" loop> <source id="jh" src="./pub/board/Call Of Silence.mp3" type="audio/mp3"/> </audio>
        
		<a style="margin-left: 2.2%; margin-right: 2%; font-weight: bold; font-family:'Goyang', Goyang;">BGM</a>
		<input id="a_range" type="range" id="seek" value="100" min="0" max="100" style="width:60%;"/>
        
		<a style="margin-left: 2.2%; font-weight: bold; font-family:'Goyang', Goyang;">MUTE</a>
		<input id="a_muted" type="checkbox" name="chk_info" value="mute">
		<br>
            
        <img class="Icon_Class" id="surrender" src="pub/board/Surrender_Icon.png">
        <img class="Icon_Class" id="set_close" src="pub/board/Cancle3.png">
        
	</div>

    <div id="silkhat" style="display: none;"> 
        <img id="hat1" src="./pub/board/silkhat.png">
        <img id="hat2" src="./pub/board/silkhat.png">
        <img id="hat3" src="./pub/board/silkhat.png">
        <img id="hat4" src="./pub/board/silkhat.png">
        <img id="hat5" src="./pub/board/silkhat.png">
	</div>
    <div id="gacha_main" style="display:none; background-size:100vw 100vh;">
        
        <input type="button" id="gacha_exit">
        
        <div id="hero_sell"><img id="hero_sell_img" src="pub/Gacha/Skill_Sell.png"></div>
        <div id="skill_sell"><img id="hero_sell_img" src="pub/Gacha/Hero_Sell.png"></div>
        <div id="sell_end"><img id="sell_end_img" src="pub/Gacha/Sell_End.png"></div>
        
        <div id="gacha_go_back"></div>
        <div id="gacha_go">
            <img id="gacha_type_img" src="pub/Gacha/Hero.png">          <br><br>
            
            <div id="gacha_type_under">
                <img id="gacha_left" src="pub/Gacha/Left.png">          &nbsp;&nbsp;
                <img id="gacha_1_img" src="pub/Gacha/Gacha_1.png">      &nbsp;&nbsp;&nbsp;&nbsp;
                <img id="gacha_10_img" src="pub/Gacha/Gacha_10.png">    &nbsp;&nbsp;
                <img id="gacha_right" src="pub/Gacha/Right.png">
            </div>
        </div>

        <div id="gacha_standing">
            <img id="gacha_standing_img" src="pub/Gacha/Standing.png">
            <div id="gacha_standing_chat"><b>어서오세요!<br>새로운 영웅이 당신을 기다리고 있답니다!!<br>단 돈 100골드에 말이죠!!</b></div>
            <div id="sell_field" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
        </div>
        
        <div id="gacha_mycardlist_back" style="display: none;"></div>
        <div id="gacha_mycardlist" style="display: none;"></div>
        
        <div id="gacha_mycardlist2_back" style="display: none;"></div>
        <div id="gacha_mycardlist2" style="display: none;"></div>
        
        <div id="gacha_result_back" style="display: none;"></div>
        <div id="gacha_result" style="display: none;"></div>
        
    </div>

    <div id="deck_main" style="display:none; background-size:100vw 100vh;">
        
        <input type="button" id="deck_exit">
        
        <div id="deck_field_back"></div>
        <div id="deck_field"></div>
        
        <div id="deck_cardlist_back" style="display: none;"></div>
        <div id="deck_cardlist" style="display: none;"></div> 
        
        <div id="deck_spec_back"></div>
        <div id="deck_spec"></div>
        
        <div id="deck_reset_back"></div>
        <div id="deck_reset">덱 초기화</div>

    </div>

    <div id="deck_skill_main" style="display:none; background-size:100vw 100vh;">
        
        <input type="button" id="deck_skill_exit">
        
        <div id="deck_skill_field_back"></div>
        <div id="deck_skill_field" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
        
        <div id="deck_skill_cardlist_back"></div>
        <div id="deck_skill_cardlist" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
        
        <!--<div id="deck_skill_cardlist_detail_back"></div>-->
        <div id="deck_skill_cardlist_detail"></div>
        
        <div id="deck_skill_count_back"></div>
        <div id="deck_skill_count"></div>
        
        <div id="deck_skill_reset_back"></div>
        <div id="deck_skill_reset">덱 초기화</div>

    </div>

    <div id="mouseover_total_id" style="display:none;">
        
        <div id="skill_deck_id_text" class="mouseover_text" style="display:none;">스킬덱 편성화면으로 이동합니다.</div>
        <div id="deck_id_text" class="mouseover_text" style="display:none;">영웅덱 편성화면으로 이동합니다.</div>
        <div id="gacha_id_text" class="mouseover_text" style="display:none;">카드뽑기 화면으로 이동합니다.</div>
        <div id="mcr_r_text" class="mouseover_text" style="display:none;">방을 새로 만듭니다.</div>
        <div id="out_room_text" class="mouseover_text" style="display:none;">방에서 나갑니다.</div>
        <div id="invite_text" class="mouseover_text" style="display:none;">다른 유저를 방으로 초대합니다.</div>
        <div id="out_room2_text" class="mouseover_text" style="display:none;">방에서 나갑니다.</div>
        <div id="ready_b_text" class="mouseover_text" style="display:none;">게임시작을 위한 준비를 합니다.</div>
        <div id="go_start_text" class="mouseover_text" style="display:none;">게임을 시작합니다. (방장전용)</div>
        <div id="config_text" class="mouseover_text" style="display:none;">게임에 관한 옵션을 설정합니다.</div>
        
    </div>

    <div id="black_eft" style="display: none;"></div>

    <div id='mit_back'></div>
    <div id='mit'>
            
        <div style="text-align:center; width:100%;background-color: #F8F8FF;"><a style="font-family:'Goyang', Goyang; font-weight: bold; font-size:95%; color:black;">Player Infomation</a></div>
            
        <div style="width:100%; height:45%;">
            <img src="pub/board/Main Icon.png" style="width:100%; height:100%; margin-top: 5%;">
        </div>
                
        <div id="player_profile" style="margin-top:1.5vh; width:100%; height:50%; font-size: 75%; text-align:center; font-family:'Goyang', Goyang;">
            <a id="profile_id" style="font-weight: bold;">:: LazRuby ::</a> <br><br>
            <a id="profile_level">Loding...</a> <br>
            <a id="profile_exp">Loding...</a> <br>
            <a id="profile_gold">Loding...</a> <br>
            <a id="profile_win">Loding...</a> <br>
            <a id="profile_lose">Loding...</a> <br>
        </div>			
    </div>

    <div id="info_menu_back"></div>
    <div id="info_menu">
        <div id="info_on" class="info_in">Info</div>
        <div id="chat_on" class="info_in">Chat</div>
    </div>

    <div id='cfield_back'></div>
    <div id='cfield' style="display: none;">
            
        <div style="text-align: center;"><a style="margin-top: 1%; font-weight: bold; font-size:2em; color:white; font-family:'Goyang', Goyang;">Chatting Room</a></div>
            
        <div style=""> <textarea id="chatLog" class="chat_log" style="width : 53vw; height : 35vh; margin-left: 1.2%; margin-top: 1.5%;" readonly></textarea> </div>
            
        <form id="chat" style="margin-top: 1.5%; margin-left: 1.2%;">
            <input id="message" class="message" type="text" style="width : 53vw; height : 3vh;">
            <input type="submit" class="chat" value="chat" style="display: none"/>
        </form>
            
    </div>

    <div id="flash_eft" style="display: none;"></div>
    <div id="back_img" style="display: none;"></div>
    <div id="set_arrow" style="display: none;">
        <img id="upper_arrow" src="./pub/board/up_arrow.png">
        <img id="lefter_arrow" src="./pub/board/l_arrow.png">
        <img id="righter_arrow" src="./pub/board/r_arrow.png">
        <img id="downfer_arrow" src="./pub/board/down_arrow.png">
    </div>
    <div id="set_arrow2" style="display: none;">
        <img id="upper_arrow2" src="./pub/board/up_arrow.png">
        <img id="lefter_arrow2" src="./pub/board/l_arrow.png">
        <img id="righter_arrow2" src="./pub/board/r_arrow.png">
        <img id="downfer_arrow2" src="./pub/board/down_arrow.png">
    </div>
<script>
    $('#black_eft').show();
    var socket = io();
    var l_count=0;
    var svet="";
    var room_check=false;
    var ori_name;
    var m_turn;
    var swit="true";
    var pass="false";
    var psrc;
    var pid;
    var pname;
    var cid;
    var cpi;
    var epass="false";
    var gplace;
    var grandc="false";
    var bswitch="true";
    var bacount=0;
    var stone = "true";
    var yousd, mesd;
    var d_click="true";
    var timer;
    var f_check = "true";
    var turn_c = 0;
    var onepiece=false;
    var de_cost = 6;
    var turn_count=0;
    var live1=null, live2=null;
    var range_count=-1;
    var range_damage=0;
    var excaribur_damage=0;
    var siro = {
    			setval:function(name,hp,attack,pro,pos,team,id){
    				this.name=name;
    				this.hp=hp;
    				this.attack=attack;
    				this.pro=pro;
    				this.pos=pos;
    				this.team=team;
    				this.id=id;
    			},
    			setsrc:function(src){
    				this.src=src;
    			}
			};
    var Create= function(piece){
				var Sora = function(){
					this.name;
					this.hp;
					this.attack;
					this.pro;
					this.pos;
					this.team;
					this.id;
					this.src;
                    this.ori_hp;
                    this.ori_attack;
                    this.armor;
				}
				Sora.prototype=piece;
				Sora.prototype.constructor=Sora;
				return new Sora;
			}

    var bom = {
				set_rh:function(rhero){
					this.rhero=rhero;
				},
				set_bh:function(bhero){
					this.bhero=bhero;
				},
				set_count:function(count){
					this.count=count;
				},
                set_btrap:function(btrap){
                    this.btrap=btrap;
                },
                set_bstrap:function(bstrap){
                    this.bstrap=bstrap;
                },
                set_rtrap:function(rtrap){
                    this.rtrap=rtrap;
                },
                set_rstrap:function(rstrap){
                    this.rstrap=rstrap;
                },
                get_count:function(){
                    return this.count;
                } 
			};
    var Make = function(Kcan){
				var Haru = function(){
					this.rhero;
					this.bhero;
					this.count;
                    this.btrap;
                    this.bstrap;
                    this.rtrap;
                    this.rstrap;
                    this.sturn;
                    this.sturn_count;
                    this.ob_count;
				}
				Haru.prototype=Kcan;
				Haru.prototype.constructor=Haru;
				return new Haru;
			}
    var huda = {
    			setval:function(name,effect,pro,enumber){
    				this.name=name;
    				this.effect=effect;
    				this.pro=pro;
    				this.enumber=enumber;
    			},
    			setsrc:function(src){
    				this.src=src;
    			}
			};
    var Card= function(catachi){
				var yuu = function(){
					this.name;
    				this.effect;
    				this.pro;
    				this.enumber;
                    this.src;
                    this.target;
                    this.cost;
                    this.how;
				}
				yuu.prototype=catachi;
				yuu.prototype.constructor=yuu;
				return new yuu;
			}
    
    var bking;
    var rking;
    var rqueen;
    var bqueen;
    var rb01,rb02;
    var bb01,bb02;
    var rk01,rk02;
    var bk01,bk02;
    var rl01, rl02;
    var bl01,bl02;
    var rp01,rp02,rp03,rp04,rp05,rp06,rp07,rp08;
    var bp01,bp02,bp03,bp04,bp05,bp06,bp07,bp08;
    var kan = new Array();
    var chuda = new Array();
    var isgame = "false";
    var isSelecthuda='false';
    var hucard = new Array();
    var hsn;
    var hudacount=0;
    var dhuid;
    
    var done_num = 1;
    var done_id;
    var room_incount;
    var done_ready = 1;
    var start_condition = 1;
    var ricount;
    var sikabane = new Array();
    var sika_inc=0;
    var sika_forth = new Array();
    var sika_count=0;
    var yeto = 1;
    var rival_sika = new Array();
    var r_sika_count = 0;
    var hat_val;
    var range_count;
    $("#myd_block>img").on({ 
        click: function(e) {
				var hid = $(e.target).attr("id");
				if($("#"+hid).css("opacity")==0.0){
					var hid = $(e.target).attr("id");
					//alert(hid);
					var did = hid.substring(1);
					$("#"+did).click();
				}else if($("#"+hid).css("opacity")==0.6){
					alert("you already used this card.");
				}
    },
        mouseover: function(e){
            var hid = $(e.target).attr("id");
            var did = hid.substring(1);
            $("#"+did).mouseover();
    },  mouseleave: function(e){
            var hid = $(e.target).attr("id");
            var did = hid.substring(1);
            $("#"+did).mouseleave();
    }});
    $("#go_start").on("click",function(e){
                if(room_incount==1){
                    if(start_condition==2){
				        socket.emit('hazime game', svet.trim(), ori_name);
                    }else{
                        alert("please wait, untill rival's state change the ready");
                    }
                }else{
                    alert("you are not room master, so please click the ready button, and wait a second.");
                }
            });
    $("#mcr_r").on("click",function(e){
				$("#cre_room").show();
			});
    $("#cancel_cre").on("click",function(e){
				$("#cre_room").hide();
				$("#cre_rname").val("");
				$("#cre_rpw").val("");
            });
    $("#submit_cre").on('click',function(e){
				//alert("dd");
				if(!room_check){
                    socket.emit('make room', $("#cre_rname").val(), ori_name);
                    $("#cre_room").hide();
                    $("#sub_waitr").hide();
                    $("#ready_room").show();
                    $("#game_menu").show();
                    $("#def_menu").hide();
                    $("#room_name>a").text($("#cre_rname").val());
                    svet = $("#cre_rname").val();
                    $("#cfield").hide();
                    $("#cre_rname").val("");
                    $("#cre_rpw").val("");
                    $("#first_p").text(ori_name);
                    $("#main_map2").show();
                    $("#main_map").hide();
                    $('#black_eft').hide();
                    room_incount=1;
                    e.preventDefault();
               }else{
                   alert("현재 이미 방에 입장 중이셔서 방을 만들 수 없습니다.");
                   $('#rname').val("");
                   e.preventDefault();
               }
			});
    $("#cre_form").on('submit',function(e){
                if(!room_check){
                    socket.emit('make room', $("#cre_rname").val(), ori_name);
                    $("#cre_room").hide();
                    $("#sub_waitr").hide();
                    $("#ready_room").show();
                    $("#game_menu").show();
                    $("#room_name>a").text($("#cre_rname").val());
                    $("#cfield").hide();
                    $("#cre_rname").val("");
                    $("#cre_rpw").val("");
                    $("#def_menu").hide();
                    e.preventDefault();
               }else{
                   alert("현재 이미 방에 입장 중이셔서 방을 만들 수 없습니다.");
                   $('#rname').val("");
                   e.preventDefault();
               }
			});
    
    $("#chat").on('submit',function(e){
                var send_message = $("#message").val();
                socket.emit('send chat', ori_name, send_message);
                $('#message').val("");
                e.preventDefault();
			});
    
    $("#out_room").on("click",function(e){
                socket.emit('change none_state', yousd);
				$("#ready_room").hide();
				$("#game_menu").hide();
                $("#def_menu").show();
				$("#sub_waitr").show();
				//$("#cfield").show();
				$("#"+done_id).remove();
                room_check=false;
                socket.emit('out and list', ori_name);
                if(room_incount==1){
                    socket.emit('change room_master', yousd);
                }else if(room_incount==2){
                    done_ready=1;
                    $("#ready").hide();
                    socket.emit('out of room', yousd);
                }
    });
    $("#out_room2").on("click",function(e){
                socket.emit('change none_state', yousd);
				$("#ready_room").hide();
				$("#game_menu").hide();
                $("#def_menu").show();
				$("#sub_waitr").show();
				//$("#cfield").show();
				$("#"+done_id).remove();
                $("#main_map").show();
                $("#main_map2").hide();
                room_check=false;
                socket.emit('out and list', ori_name);
                if(room_incount==1){
                    socket.emit('change room_master', yousd);
                }else if(room_incount==2){
                    done_ready=1;
                    $("#ready").hide();
                    socket.emit('out of room', yousd);
                }
    });
    socket.on('chat send', function(myname, message){
        var view_message = myname+" : "+message;
        $('#chatLog').append(view_message+'\n');
       //alert(msg);
       $('#chatLog').scrollTop($('#chatLog')[0].scrollHeight);
    });
    socket.on('room_master change', function(text){
        room_incount=1;
        $("#first_p").text(ori_name);
        $("#rival_rarea").hide();
    });
    socket.on('room out', function(text){
        $("#rival_rarea").hide();
    });
    socket.on('convert color',function(rname){
        $("#"+rname).css("background-color","#6495ED");
    });
    socket.on('register id',function(mid,yid){
        mesd = mid;
        yousd = yid;
        socket.emit('send rivalname', ori_name, yousd);
    });
    socket.on('send logout', function(logout){
       alert("로그아웃되셨습니다.");
       location.href="/";
     });
    socket.on('ready_state change', function(text){
        $("#ready").show();
        start_condition = 2;
     });
    socket.on('none_state change', function(text){
        $("#ready").hide();
        start_condition = 1;
     });
    socket.on('sturn release', function(num){
        var hasn = 64-num+1;
        var jumon = "#g"+hasn+'>.sturn';
        $(jumon).remove();
        kan[hasn-1].sturn="false";
        kan[hasn-1].sturn_count=0;
     });
    $("#ready_b").on("click",function(e){
        if(room_incount==2){
				if(done_ready==1){
					$("#ready").show();
					done_ready=2;
                    socket.emit('change ready_state', yousd);
				}else if(done_ready==2){
					$("#ready").hide();
					done_ready=1;
                    socket.emit('change none_state', yousd);
				}
        }else{
            alert("you are room master, so don't change your' state change ready!");
        }
    });
    $('#my_deck>img').on({
        click: function(e){
        if(isgame=="true"){
            isSelecthuda="true";
            var hid = $(e.target).attr("id")+"";
            dhuid=hid;
            var hst = hid.substring(4).trim();
            hsn = parseInt(hst);
            //alert(hucard[hsn-1].target);
            $('.field').on('click',function(ee){
                var hhid=hid;
                if(isgame=="true" && isSelecthuda=="true"){
                if(hucard[hsn-1].effect=="trap"){
                    if(confirm("지금 이곳에 함정을 설치 하시겠습니까?")){
                    if(de_cost>=hucard[hsn-1].cost){
                        de_cost-=hucard[hsn-1].cost;
                        $("#b_accost").text(de_cost+"");
                        var fid = $(ee.target).attr("id")+"";
                        var fst = fid.substring(1).trim();
					    var fsn = parseInt(fst);
                        if(kan[fsn-1].count==0 && kan[fsn-1].btrap!="true"){
                            $(ee.target).css("background-color","red");
                            kan[fsn-1].set_btrap("true");
                            kan[fsn-1].set_bstrap(hucard[hsn-1]);
                            isSelecthuda="false";
                            $("#b"+dhuid).css("opacity",0.6);
                            socket.emit('set rival_trap', kan[fsn-1].bstrap,yousd,fsn);
                        }else{
                            alert("you do not set trap in this place");
                        }
                    }else{
                        alert("cost가 모자르단다.");
                    }
                    }else{
                        console.log("설치취소");
                    }
                }else{
                        
                    
                    }
                }else{
                    //alert("this turn is not yours!");
                }
            });
            if(isgame=="true" && isSelecthuda=="true"){
            if(hucard[hsn-1].effect=="magic"){
                //alert("지금 영웅은 : "+hucard[hsn-1].target);
                var p_is = check_hero(hucard[hsn-1].target);
                //console.log("지금 영웅은 : "+p_is);
                if(p_is!=64){
                        if(confirm("영웅에게 마법을 사용하시겠습니까?")){
                            if(de_cost>=hucard[hsn-1].cost){
                                    de_cost-=hucard[hsn-1].cost;
                                    $("#b_accost").text(de_cost+"");
                                if(hucard[hsn-1].pro=="inhp"){
                                        kan[p_is].bhero.hp+=hucard[hsn-1].enumber;
                                        var pp_is=p_is+1;
                                        $("#b"+ hid).css("opacity",0.6);
                                        $("#g"+pp_is).children('.bpsta').children('.p_hp').text(kan[p_is].bhero.hp);
                                        if(kan[p_is].bhero.hp>kan[p_is].bhero.ori_hp){
                                            //
                                        }
                                        socket.emit('set rival_magichp', yousd,kan[p_is].bhero.pos,hucard[hsn-1].enumber);
                                }else if(hucard[hsn-1].pro=="inat"){
                                        kan[p_is].bhero.attack+=hucard[hsn-1].enumber;
                                        var pp_is2=p_is+1;
                                        $("#b"+ hid).css("opacity",0.6); $("#g"+pp_is2).children('.bpsta').children('.p_attack').text(kan[p_is].bhero.attack);
                                        socket.emit('set rival_magicat', yousd,kan[p_is].bhero.pos,hucard[hsn-1].enumber);
                                }else if(hucard[hsn-1].pro=="indu"){
                                        kan[p_is].bhero.hp+=hucard[hsn-1].enumber;
                                        kan[p_is].bhero.attack+=hucard[hsn-1].enumber;
                                        var pp_is3=p_is+1;
                                        $("#g"+pp_is3).children('.bpsta').children('.p_hp').text(kan[p_is].bhero.hp);
                                        $("#b"+ hid).css("opacity",0.6); $("#g"+pp_is3).children('.bpsta').children('.p_attack').text(kan[p_is].bhero.attack);
                                        socket.emit('set rival_magicduo', yousd,kan[p_is].bhero.pos,hucard[hsn-1].enumber);
                                }else if(hucard[hsn-1].pro=="rdhp"){
                                    if(confirm("방향 범위 마법을 사용하시겠습니까?")){
                                        if(de_cost>=hucard[hsn-1].cost){
                                            //de_cost-=hucard[hsn-1].cost;
                                            $("#b_accost").text(de_cost+"");
                                            $("#b"+ hid).css("opacity",0.6);
                                            range_attack(hucard[hsn-1].target,hucard[hsn-1].enumber,hucard[hsn-1].how);
                                        }else{
                                            alert("cost가 모자르단다.");
                                        }
                                    }else{

                                    }
                                }else if(hucard[hsn-1].pro=="odir_at"){
                                    if(confirm("방향 관통 마법을 사용하시겠습니까?")){
                                        if(de_cost>=hucard[hsn-1].cost){
                                            //de_cost-=hucard[hsn-1].cost;
                                            $("#b_accost").text(de_cost+"");
                                            $("#b"+ hid).css("opacity",0.6);
                                            one_directionAttack(hucard[hsn-1].target,hucard[hsn-1].enumber);
                                        }else{
                                            alert("cost가 모자르단다.");
                                        }
                                    }else{

                                    }
                                }else if(hucard[hsn-1].pro=="inhp_ran"){
                                    if(confirm("무작위 체력 회복 마법을 사용하시겠습니까?")){
                                        if(de_cost>=hucard[hsn-1].cost){
                                            //de_cost-=hucard[hsn-1].cost;
                                            $("#b_accost").text(de_cost+"");
                                            $("#b"+ hid).css("opacity",0.6);
                                            inhp_ran_commit(hucard[hsn-1].target,hucard[hsn-1].enumber);
                                        }else{
                                            alert("cost가 모자르단다.");
                                        }
                                    }else{

                                    }
                                }else if(hucard[hsn-1].pro=="p_inhp_deat"){
                                    if(confirm("체력을 회복하고 공격력을 감소하시겠습니까?")){
                                        if(de_cost>=hucard[hsn-1].cost){
                                            //de_cost-=hucard[hsn-1].cost;
                                            $("#b_accost").text(de_cost+"");
                                            $("#b"+ hid).css("opacity",0.6);
                                            inhp_commit(hucard[hsn-1].target,hucard[hsn-1].enumber);
                                            inat_commit(hucard[hsn-1].target,hucard[hsn-1].enumber*-1);
                                        }else{
                                            alert("cost가 모자르단다.");
                                        }
                                    }else{

                                    }
                                }else if(hucard[hsn-1].pro=="p_dehp_inat"){
                                    if(confirm("체력을 감소하고 공격력을 증가하시겠습니까?")){
                                        if(de_cost>=hucard[hsn-1].cost){
                                            //de_cost-=hucard[hsn-1].cost;
                                            $("#b_accost").text(de_cost+"");
                                            $("#b"+ hid).css("opacity",0.6);
                                            inhp_commit(hucard[hsn-1].target,hucard[hsn-1].enumber*-1);
                                            inat_commit(hucard[hsn-1].target,hucard[hsn-1].enumber);
                                        }else{
                                            alert("cost가 모자르단다.");
                                        }
                                    }else{

                                    }
                                }
                            }else{
                                alert("cost가 모자르단다.");
                            }
                        }else{
                                console.log("마법취소");
                        }
                    }else{
                            if(hucard[hsn-1].pro=="sturn"){
                                if(confirm("스턴 마법을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        degeki();
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }else if(hucard[hsn-1].pro=="mind"){
                                if(confirm("마인드 컨트롤 마법을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        mind_control();
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }else if(hucard[hsn-1].pro=="all_atup"){
                                if(confirm("전체 공격 상승 마법을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        all_commit_attack("r",hucard[hsn-1].enumber*-1);
                                        all_commit_attack("b",hucard[hsn-1].enumber*-1);
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }else if(hucard[hsn-1].pro=="part_atup"){
                                if(confirm("아군 전체 공격 상승 마법을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        all_commit_attack("b",hucard[hsn-1].enumber*-1);
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }else if(hucard[hsn-1].pro=="all_hpup"){
                                if(confirm("전체 체력 상승 마법을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        all_commit_hp("r",hucard[hsn-1].enumber*-1);
                                        all_commit_hp("b",hucard[hsn-1].enumber*-1);
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }else if(hucard[hsn-1].pro=="part_hpup"){
                                if(confirm("아군 전체 체력 상승 마법을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        all_commit_hp("b",hucard[hsn-1].enumber*-1);
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }else if(hucard[hsn-1].pro=="all_hpatup"){
                                if(confirm("아군 전체 공격,체력 상승 마법을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        //all_commit_hp("r",hucard[hsn-1].enumber*-1);
                                        all_commit_hp("b",hucard[hsn-1].enumber*-1);
                                        //all_commit_attack("r",hucard[hsn-1].enumber*-1);
                                        all_commit_attack("b",hucard[hsn-1].enumber*-1);
                                        
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }else if(hucard[hsn-1].pro=="obstacle"){
                                if(confirm("전체 장애물 설치 마법을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        set_obstacle();
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }else if(hucard[hsn-1].pro=="silkhat"){
                                if(confirm("모자 장수의 마법을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        set_magical_hat();
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }else if(hucard[hsn-1].pro=="heal_kill"){
                                if(confirm("상대에게는 벌을 아군에게는 기적을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        all_commit_hp("b",hucard[hsn-1].enumber*-1);
                                        all_commit_attack("r",hucard[hsn-1].enumber);
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }else if(hucard[hsn-1].pro=="ch_athp"){
                                if(confirm("상대의 체력과 공격력을 바꾸는 마법을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        change_ha();
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }else if(hucard[hsn-1].pro=="deho_inat"){
                                if(confirm("아군전체의 체력을 희생해 공격을 올리는 마법을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        all_commit_hp("b",hucard[hsn-1].enumber);
                                        all_commit_attack("b",hucard[hsn-1].enumber*-1);
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }else if(hucard[hsn-1].pro=="part_r_hpup"){
                                if(confirm("적 전체 체력 마법을 사용하시겠습니까?")){
                                    if(de_cost>=hucard[hsn-1].cost){
                                        de_cost-=hucard[hsn-1].cost;
                                        $("#b_accost").text(de_cost+"");
                                        $("#b"+ hid).css("opacity",0.6);
                                        all_commit_hp("r",hucard[hsn-1].enumber*-1);
                                    }else{
                                        alert("cost가 모자르단다.");
                                    }
                                }else{
                                    
                                }
                            }
                        
                    }
            }
            }
        }
    },
    mouseover: function(e){
        var bcsrc = $(e.target).attr("src"); 
        var img_count = $(e.target).attr("id")+"";
        var cost_count = img_count.substring(4).trim();
        var hsn_int = parseInt(cost_count);
        var real_cost = $("#cost_"+hsn_int).html();
        $("#bigc_img").attr("src",bcsrc);
        $("#big_cost").html(""+real_cost);
        $("#big_card").show();
        
    },
    mouseleave: function(e){
        $("#bigc_img").attr("src","");
        $("#big_card").hide();
    }});
    $("#sika_close").on("click",function(e){
        $("#dead_hero1").show();
        $("#dead_hero2").show();
        $("#dead_hero3").show();
        $("#dead_hero4").show();
        sika_count=0;
        sika_forth[0]=sikabane[sika_count];
        sika_forth[1]=sikabane[sika_count+1];
        sika_forth[2]=sikabane[sika_count+2];
        sika_forth[3]=sikabane[sika_count+3];
        $("#sikaba").hide();
    });
    
    $("#a_muted").on('click',function(e){
        if(document.getElementById('a_muted').checked){
            document.getElementById('jk').muted = true;
            //$("#a_range").attr("value",0);
            document.getElementById('a_range').value = 0;
        }else{
            document.getElementById('jk').muted = false;
            //$("#a_range").attr("value",100);
            document.getElementById('a_range').value = 100;
        }
    });
    $("#chcard").on('click',function(e){
        //round_huda();
        //sikabane_show();
        //set_magical_hat();
        //change_ha();
        $("#setting").show();
        $('#black_eft').show();
        //set_obstacle();
    });
    socket.on('obstacle delete', function(pos){
         delete_obstacle(pos);
     });
    socket.on('obstacle set', function(pos){
         set_obtwo(pos);
     });
    socket.on('hp_attack change', function(pos){
         change_ah(pos);
     });
    $("#set_close").on('click',function(e){
        $("#setting").hide();
        $('#black_eft').hide();
    });
    $("#surrender").on('click',function(e){
        socket.emit('you win', yousd);
        $('black_Eft').hide();
        i_lose();
    });
    $("#a_range").on("change",function(e){
        document.getElementById('jk').volume=document.getElementById('a_range').value/100;
    });
    $("#silkhat>img").on("click",function(e){
				var hid = $(e.target).attr("id");
				var did = hid.substring(3);
				//alert(did);
                if(did==kan[cpi.pos-1].rhero.armor){
                    kan[cpi.pos-1].rhero.armor=0;
                    socket.emit('zero armor', yousd, cpi.pos);
                    alert("bingo");
                    attacking();
                }else{
                    de_cost-=2;
                    $("#b_accost").text(de_cost+"");
                    kan[cpi.pos-1].rhero.armor=0;
                    socket.emit('zero armor', yousd, cpi.pos);
                    alert("it is not rhero in this hat");
                }
        $("#silkhat").hide();
    });
     socket.on('zero armorment', function(pos){
        var rpos2 = 64-pos+1;
        kan[rpos2-1].bhero.armor = 0;
     });
    socket.on('inhence armorment',function(pos, num){
        var rpos = 64-pos+1;
        kan[rpos-1].rhero.armor = num;
    });
    
    socket.on('set sikabane', function(dhd, sika_yeto){
                    rival_sika[r_sika_count++] = sika_yeto;
                    var rdhd = 64-dhd+1;
    
					var ppl = document.createElement('img');
					ppl.setAttribute("id",sika_yeto.id);
					ppl.setAttribute("src",sika_yeto.src);
					document.getElementById("g"+rdhd).appendChild(ppl);
                    
                    var pstad = document.createElement('div');
						pstad.setAttribute("class","rpsta");
						document.getElementById("g"+rdhd).appendChild(pstad);
					var p_hpd = document.createElement('a');
						p_hpd.setAttribute("class","p_hp");
					var p_text = document.createTextNode(''+sika_yeto.hp);
						p_hpd.appendChild( p_text );
						$("#g"+rdhd).children(".rpsta").append(p_hpd);
					var p_prod = document.createElement('a');
						p_prod.setAttribute("class","p_pro");
					var p_text2 = document.createTextNode(''+sika_yeto.pro);
						p_prod.appendChild( p_text2 );
						$("#g"+rdhd).children(".rpsta").append(p_prod);
					var p_atd = document.createElement('a');
						p_atd.setAttribute("class","p_attack");
					var p_text3 = document.createTextNode(''+sika_yeto.attack); 
						p_atd.appendChild( p_text3 );
						$("#g"+rdhd).children(".rpsta").append(p_atd);
                    
                    kan[rdhd-1].count = 10;
                    kan[rdhd-1].rhero = sika_yeto;
                    kan[rdhd-1].rhero.pos = rdhd;
                    kan[rdhd-1].rhero.team = 'r';
            
                    $("#"+sika_yeto.id).click( function(et) {
                        if(swit=="true"){
                            var offset = $("#uptown").offset();
                            $('html, body').animate({scrollTop : offset.top}, 300);
                            var hero = document.getElementById( sika_yeto.id ).getAttribute('src');
                            $('#cutton').css('display','block');
                            swit="false";
                            $("#rival").attr('src', hero);
                            $("#rival").attr('style', "opacity:1");
                            if(kan[sika_yeto.pos-1].count!=30) {
                                //$("#hero").attr('src', "./black.jpg");
                                $("#hero").attr('style', "opacity:0");
                                $("#hhp").hide();
                                $("#rhp").show();
                                var rhp = sika_yeto.hp/sika_yeto.ori_hp;
                                $("#ghp2").text("HP:"+sika_yeto.hp+"/"+sika_yeto.ori_hp);
                                $(".gaze2").width(rhp*100+"%");
                                if(sika_yeto.hp>sika_yeto.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                            }else{
                                $("#hero").attr('style', "opacity:1");
                            }
                        }else{
                            $('#cutton').css('display','none');
                            swit="true";
                        }
			});
        
     });
    $(".dead_hero>img").on("click",function(e){
        var dh = $(e.target).parent().attr("id");
        var dh_num = dh.substring(dh.length-1)-1;
        
        swit="false";
        for(var i = 40; i<48; i++){
					if(kan[i].count==0){
						var num = i+1;
						var te='g'+num;
						var cstad = document.createElement('div');
						cstad.setAttribute("class","semetory");
                 		document.getElementById(te).appendChild(cstad);
					}
				}
        $(".semetory").click("click",function(er){
                    sika_forth[dh_num].id = "yeto"+yeto;
                    var sika_yeto =  sika_forth[dh_num];
					var hid = $(er.target).parent().attr("id");
					var did = hid.substring(1);
                    var dhd = parseInt(did);
					var ppl = document.createElement('img');
					ppl.setAttribute("id",sika_forth[dh_num].id);
					ppl.setAttribute("src",sika_forth[dh_num].src);
					document.getElementById("g"+did).appendChild(ppl);
					$(".semetory").remove();
                    
                    var pstad = document.createElement('div');
						pstad.setAttribute("class","bpsta");
						document.getElementById(hid).appendChild(pstad);
					var p_hpd = document.createElement('a');
						p_hpd.setAttribute("class","p_hp");
					var p_text = document.createTextNode(''+sika_forth[dh_num].hp);
						p_hpd.appendChild( p_text );
						$("#"+hid).children(".bpsta").append(p_hpd);
					var p_prod = document.createElement('a');
						p_prod.setAttribute("class","p_pro");
					var p_text2 = document.createTextNode(''+sika_forth[dh_num].pro);
						p_prod.appendChild( p_text2 );
						$("#"+hid).children(".bpsta").append(p_prod);
					var p_atd = document.createElement('a');
						p_atd.setAttribute("class","p_attack");
					var p_text3 = document.createTextNode(''+sika_forth[dh_num].attack); 
						p_atd.appendChild( p_text3 );
						$("#"+hid).children(".bpsta").append(p_atd);
                    
                    yeto++;
                    kan[dhd-1].count = 20;
                    kan[dhd-1].bhero = sika_yeto;
                    kan[dhd-1].bhero.pos = dhd;
                    kan[dhd-1].bhero.team = 'b';
            
                    socket.emit('set rival_sikabane', yousd, dhd, sika_yeto);
                    //alert(kan[did-1].count);
                    $("#"+sika_forth[dh_num].id).click( function(et) {
                        if(grandc=="false"){
                            cid = sika_yeto.id;
                            cpi = sika_yeto;
                            epass="true";
                        }
                        //alert(cpi.pro);
                        if(swit=="true"){
                            var offset = $("#uptown").offset();
                            $('html, body').animate({scrollTop : offset.top}, 300);
                            var hero = document.getElementById( sika_yeto.id ).getAttribute('src');
                            $('#cutton').css('display','block');
                            swit="false";
                            $("#hero").attr('src', hero);
                            $("#hero").attr('style', "opacity:1");
                            if(kan[sika_yeto.pos-1].count!=30) {
                                //$("#hero").attr('src', "./black.jpg");
                                $("#rival").attr('style', "opacity:0");
                                $("#rhp").hide();
                                $("#hhp").show();
                                var rhp = sika_yeto.hp/sika_yeto.ori_hp;
                                $("#ghp").text("HP:"+sika_yeto.hp+"/"+sika_yeto.ori_hp);
                                $(".gaze").width(rhp*100+"%");
                                if(sika_yeto.hp>sika_yeto.ori_hp){
                                        $(".gaze").width(100+"%");
                                    }
                            }else{
                                $("#rival").attr('style', "opacity:1");
                            }
                        }else{
                            $('#cutton').css('display','none');
                            swit="true";
                        }
			});
        });
    });
    $("#sika_l").click(function(e){
        if(sika_count-4<0){ 
            sika_count=sikabane.length;
            sika_count+=4-(sika_count%4);
        }
        sika_count-=4;
        if(sika_count+3>sikabane.length){
                var x =  sikabane.length-sika_count;
                $("#dead_hero1").hide();
                $("#dead_hero2").hide();
                $("#dead_hero3").hide();
                $("#dead_hero4").hide();
                for(var i=0;i<x;i++){
                    var j = i+1;
                    sika_forth[i]=sikabane[sika_count+i];
                    $("#dead_hero"+j+">img").attr("src",sikabane[sika_count+i].src);
                    $("#dead_hero"+j+">.sika_name").text("name : "+sikabane[sika_count+i].name);
                    $("#dead_hero"+j+">.sika_hp").text("hp : "+sikabane[sika_count+i].hp);
                    $("#dead_hero"+j+">.sika_ak").text("atk : "+sikabane[sika_count+i].attack);
                    $("#dead_hero"+j).show();
                }
           }
        else{
                $("#dead_hero1").show();
                $("#dead_hero2").show();
                $("#dead_hero3").show();
                $("#dead_hero4").show();
                sika_forth[0]=sikabane[sika_count];
                sika_forth[1]=sikabane[sika_count+1];   
                sika_forth[2]=sikabane[sika_count+2];   
                sika_forth[3]=sikabane[sika_count+3];   
                $("#dead_hero1>img").attr("src",sikabane[sika_count].src);
                $("#dead_hero1>.sika_name").text("name : "+sikabane[sika_count].name);
                $("#dead_hero1>.sika_hp").text("hp : "+sikabane[sika_count].hp);
                $("#dead_hero1>.sika_ak").text("atk : "+sikabane[sika_count].attack);
                $("#dead_hero2>img").attr("src",sikabane[sika_count+1].src);
                $("#dead_hero2>.sika_name").text("name : "+sikabane[sika_count+1].name);
                $("#dead_hero2>.sika_hp").text("hp : "+sikabane[sika_count+1].hp);
                $("#dead_hero2>.sika_ak").text("atk : "+sikabane[sika_count+1].attack);
                $("#dead_hero3>img").attr("src",sikabane[sika_count+2].src);
                $("#dead_hero3>.sika_name").text("name : "+sikabane[sika_count+2].name);
                $("#dead_hero3>.sika_hp").text("hp : "+sikabane[sika_count+2].hp);
                $("#dead_hero3>.sika_ak").text("atk : "+sikabane[sika_count+2].attack);
                $("#dead_hero4>img").attr("src",sikabane[sika_count+3].src);
                $("#dead_hero4>.sika_name").text("name : "+sikabane[sika_count+3].name);
                $("#dead_hero4>.sika_hp").text("hp : "+sikabane[sika_count+3].hp);
                $("#dead_hero4>.sika_ak").text("atk : "+sikabane[sika_count+3].attack);
           }
        
    });
    $("#sika_r").click(function(e){
        if(sika_count+4>=sikabane.length) sika_count=0;
        else sika_count+=4;
        if(sika_count+3>sikabane.length){
                var x =  sikabane.length-sika_count;
                $("#dead_hero1").hide();
                $("#dead_hero2").hide();
                $("#dead_hero3").hide();
                $("#dead_hero4").hide();
                for(var i=0;i<x;i++){
                    var j = i+1;
                    sika_forth[i]=sikabane[sika_count+i];
                    $("#dead_hero"+j+">img").attr("src",sikabane[sika_count+i].src);
                    $("#dead_hero"+j+">.sika_name").text("name : "+sikabane[sika_count+i].name);
                    $("#dead_hero"+j+">.sika_hp").text("hp : "+sikabane[sika_count+i].hp);
                    $("#dead_hero"+j+">.sika_ak").text("atk : "+sikabane[sika_count+i].attack);
                    $("#dead_hero"+j).show();
                }
           }
        else{
                $("#dead_hero1").show();
                $("#dead_hero2").show();
                $("#dead_hero3").show();
                $("#dead_hero4").show();
                sika_forth[0]=sikabane[sika_count];
                sika_forth[1]=sikabane[sika_count+1];   
                sika_forth[2]=sikabane[sika_count+2];   
                sika_forth[3]=sikabane[sika_count+3];
                $("#dead_hero1>img").attr("src",sikabane[sika_count].src);
                $("#dead_hero1>.sika_name").text("name : "+sikabane[sika_count].name);
                $("#dead_hero1>.sika_hp").text("hp : "+sikabane[sika_count].hp);
                $("#dead_hero1>.sika_ak").text("atk : "+sikabane[sika_count].attack);
                $("#dead_hero2>img").attr("src",sikabane[sika_count+1].src);
                $("#dead_hero2>.sika_name").text("name : "+sikabane[sika_count+1].name);
                $("#dead_hero2>.sika_hp").text("hp : "+sikabane[sika_count+1].hp);
                $("#dead_hero2>.sika_ak").text("atk : "+sikabane[sika_count+1].attack);
                $("#dead_hero3>img").attr("src",sikabane[sika_count+2].src);
                $("#dead_hero3>.sika_name").text("name : "+sikabane[sika_count+2].name);
                $("#dead_hero3>.sika_hp").text("hp : "+sikabane[sika_count+2].hp);
                $("#dead_hero3>.sika_ak").text("atk : "+sikabane[sika_count+2].attack);
                $("#dead_hero4>img").attr("src",sikabane[sika_count+3].src);
                $("#dead_hero4>.sika_name").text("name : "+sikabane[sika_count+3].name);
                $("#dead_hero4>.sika_hp").text("hp : "+sikabane[sika_count+3].hp);
                $("#dead_hero4>.sika_ak").text("atk : "+sikabane[sika_count+3].attack);
           }
        
    });
    
    $('#idname').on('click',function(e){
        if(cpi!=null){
            alert(cpi.name);
        }
    });
    $('#invite').on('click',function(e){
        $("#invite_room").show();
    });
    $('#cancel_invite').on('click',function(e){
        $("#invite_room").hide();
    });
    $('#room').on('submit', function(e){
       if(!room_check){
            socket.emit('make room', $('#rname').val(), ori_name);
            //console.log()
            //alert($('#idname').val());
            $("#roomname").text("방이름 : "+$('#rname').val());
            $('#rname').val("");
            $("#rname").focus();
            e.preventDefault();
       }else{
           alert("현재 이미 방에 입장 중이셔서 방을 만들 수 없습니다.");
           $('#rname').val("");
           e.preventDefault();
       }
       
     });
    
    socket.on('control mind', function(num){
        var dsn = 64-num+1;
        kan[dsn-1].rhero = kan[dsn-1].bhero;
        kan[dsn-1].bhero = null;
        kan[dsn-1].count = kan[dsn-1].count-20+10;
        var mindid = kan[dsn-1].rhero.id;
        var mmid = kan[dsn-1].rhero;
        mmid.team='r';
        $("#g"+dsn+">#"+mindid).remove();
        $("#g"+dsn+">.bpsta").remove();
        var ecstad2 = document.createElement('img');
        ecstad2.setAttribute("src",mmid.src);
        ecstad2.setAttribute("class",mmid.pro);
        ecstad2.setAttribute("id",mindid);
        document.getElementById("g"+dsn).appendChild(ecstad2);
        
        var pstad = document.createElement('div');
        pstad.setAttribute("class","rpsta");
        document.getElementById("g"+dsn).appendChild(pstad);
        var p_hpd = document.createElement('a');
        p_hpd.setAttribute("class","p_hp");
        var p_text = document.createTextNode(''+mmid.hp);
        p_hpd.appendChild( p_text );
        $("#g"+dsn).children(".rpsta").append(p_hpd);
        
        var p_prod = document.createElement('div');
        p_prod.setAttribute("class","p_pro");
        var ksrc = getpro_img(mmid.pro,'r');
        $("#g"+dsn).children(".rpsta").append(p_prod);
        $("#g"+dsn+">.rpsta>.p_pro").css("background-image",'url('+ksrc+')');
        
        var p_atd = document.createElement('a');
        p_atd.setAttribute("class","p_attack");
        var p_text3 = document.createTextNode(''+mmid.attack); 
        p_atd.appendChild( p_text3 );
        $("#g"+dsn).children(".rpsta").append(p_atd);
        
        $("#"+mindid).click( function() {
                if(swit=="true"){
                    var hero = document.getElementById( mindid ).getAttribute('src');
                    $('#cutton').css('display','block');
                    swit="false";
                    $("#rival").attr('src', hero);
                    $("#rival").attr('style', "opacity:1");
                    if(kan[rk01.pos-1].count!=30) {
                        $("#hero").attr('style', "opacity:0");
                        $("#hhp").hide();
                        $("#rhp").show();
                        var rhp = mmid.hp/mmid.ori_hp;
                        $("#ghp2").text("HP:"+mmid.hp+"/"+mmid.ori_hp);
                        $(".gaze2").width(rhp*100+"%");
                        if(mmid.hp>mmid.ori_hp){
                                    $(".gaze2").width(100+"%");
                            }
                    }else{
                        $("#hero").attr('style', "opacity:1");
                    }
                }else{
                    $('#cutton').css('display','none');
                    swit="true";
                }
            });
     });
    
    socket.on('change name', function(name,id){
       $('#idname').text(name);
        $('#profile_id').text(name);
        ori_name=name;
        mesd = id;
        socket.emit('deck_load', mesd, ori_name);
        socket.emit('card_load', mesd, ori_name);
        
        socket.emit('skill_mycard_load', mesd, ori_name);
        socket.emit('skill_allcard_load', mesd, ori_name);
        socket.emit('login_push', mesd, ori_name);
        create_table();
     });
    
    socket.on('set trap_rival', function(strap,fsn){
        var dsn = 64-fsn+1;
        kan[dsn-1].set_rtrap("true");
        kan[dsn-1].set_rstrap(strap);
     });
    
    socket.on('append list', function(name,userid){
         var ori_id = ori_name; 
         
         var plid = $("#store_room").attr("id")+""; 
         var cstad = document.createElement('div');
         cstad.setAttribute("class","done_room");
         cstad.setAttribute("id","done_id"+done_num);
         var child_a = document.createElement('a');
         var text_node = document.createTextNode(name);
         child_a.appendChild(text_node);
         var parent_id = document.createElement("store_room");
         cstad.appendChild(child_a);
         document.getElementById(plid).appendChild(cstad);
         
    $("#done_id"+done_num).on("click",function(e){
             if(!room_check){
                    //room_check=true;
                    console.log("만세");
                    var event2 = $(e.target).attr('id');
                    var e_text2 = $("#"+event2+">a").text();
                    var tt = e_text2.trim();
                    svet=tt;
                    socket.emit('In room', tt, ori_id,event2);
                    $("#main_map2").show();
                    $("#main_map").hide();
                }else{
                    alert("이미 방에 들어가신 상태입니다. 다른 가기 위해서는 현재 방을 나와주세요.");
                }
             });
            done_num++;
     });
    
    socket.on('send list', function(r_name, s_name){
            var ori_id = ori_name;
            
            $("#store_room").empty();
            done_num=0;
            for(var i=0;i<r_name.length;i++){
                
                 var a = r_name[i];
                 var plid = $("#store_room").attr("id")+""; 
                 var cstad = document.createElement('div');
                 cstad.setAttribute("class","done_room");
                 cstad.setAttribute("id","done_id"+done_num);
                 //done_id = "done_id"+done_num;

                 var child_a = document.createElement('a');
                 var text_node = document.createTextNode(a);
                 child_a.appendChild(text_node);
                 var parent_id = document.createElement("store_room");
                 cstad.appendChild(child_a);
                 document.getElementById(plid).appendChild(cstad);
                 if(s_name!=null && s_name[i]=="full"){
                     $("#done_id"+done_num).css("background-image","url('pub/board/Play.png')");
                 }
                 $("#done_id"+done_num).on("click",function(e){
                 if(!room_check){
                        //room_check=true;
                        console.log("만세");
                        var event2 = $(e.target).attr('id');
                        var e_text2 = $("#"+event2+">a").text();
                        var tt = e_text2.trim();
                        svet=tt;
                        $("#main_map").show();
                        $("#main_map2").hide();
                        socket.emit('In room', tt, ori_id,event2);
                    }else{
                        alert("이미 방에 들어가신 상태입니다. 다른 가기 위해서는 현재 방을 나와주세요.");
                    }
                 });
                done_num++;
            }
         
     });
    socket.on('print currlist', function(curlist){
            ricount=0;
            $("#plist").empty();
            for(var i=0;i<curlist.length;i++){
                if(curlist[i]==ori_name){ 
                    continue;
                }
                var a = curlist[i];
                var child_a = document.createElement('li');
                child_a.setAttribute("class","currplayer"+ricount);
                var text_node = document.createTextNode(a);
                child_a.appendChild(text_node);
                document.getElementById('plist').appendChild(child_a);
                
                $('.currplayer'+ricount).on("click",function(e){
                            var event = $(e.target);
                            var e_text = event.text();
                            var ee = e_text.trim();
                            socket.emit('invite you', ee, $("#room_name").text());
                });
                ricount++;
            }
     });
    socket.on('maneku invite', function(r_name){
            console.log("방이름 : "+r_name);
            var qs = window.confirm("초대를 받으셨습니다. 입장하시겠습니까?");
            if(qs){
                for(var i=1; i<done_num;i++){
                    var event2 = 'done_id'+i;
                    var e_text2 = $("#"+event2+">a").text();
                    var tt = e_text2.trim();
                    svet=tt;
                    if(tt==r_name){
                        socket.emit('In room', tt, ori_name,event2);
                    }
                }
            }else{
                console.log("refuse");
            }
     });
    socket.on('comenot room', function(r_name){
            alert("인원이 초과 되셔서 못들어 오십니다.");
     });
    socket.on('set rival_name', function(oname,yrid){
            $("#rival_rarea").show();
            yousd=yrid;
            $("#second_p").text(oname);
            socket.emit('send firstname', ori_name, yrid);
     });
    socket.on('set first_name',function(firstname){
         $("#rival_rarea").show();
         $("#first_p").text(firstname);
         $("#second_p").text(ori_name);
    });
    socket.on('comein room', function(r_name){
            room_incount=2;
            room_check=true;
            $("#def_menu").hide();
            $("#cre_room").hide();
            $("#sub_waitr").hide();
            $("#ready_room").show();
            $("#game_menu").show();
            $("#rival_rarea").show();
            $("#room_name>a").text(r_name);
            $("#cfield").hide();
            //$("#second_p").text(ori_name);
            //socket.emit('send rivalname', ori_name, yousd);
     });
    socket.on('set huda', function(hu1,hu2,hu3,hu4,hu5,hu6,hu7,hu8,hu9,hu10,hu11,hu12,
                                   hu13,hu14,hu15,hu16,hu17,hu18,hu19,hu20,hu21,hu22,hu23,
                                   hu24,hu25,hu26,hu27,hu28,hu29,hu30,hu31,hu32,hu33,
                                   hu34,hu35,hu36,hu37,hu38,hu39,hu40,hu41,hu42,hu43,
                                   hu44,hu45,hu46,hu47,hu48){
        
            var chu1 = JSON.parse(hu1);
            var chu2 = JSON.parse(hu2);
            var chu3 = JSON.parse(hu3);
            var chu4 = JSON.parse(hu4);
            var chu5 = JSON.parse(hu5);
            var chu6 = JSON.parse(hu6);
            var chu7 = JSON.parse(hu7);
            var chu8 = JSON.parse(hu8);
            var chu9 = JSON.parse(hu9);
            var chu10 = JSON.parse(hu10);
            var chu11 = JSON.parse(hu11);
            var chu12 = JSON.parse(hu12);
            var chu13 = JSON.parse(hu13);
            var chu14 = JSON.parse(hu14);
            var chu15 = JSON.parse(hu15);
            var chu16 = JSON.parse(hu16);
            var chu17 = JSON.parse(hu17);
            var chu18 = JSON.parse(hu18);
            var chu19 = JSON.parse(hu19);
            var chu20 = JSON.parse(hu20);
            var chu21 = JSON.parse(hu21);
            var chu22 = JSON.parse(hu22);
            var chu23 = JSON.parse(hu23);
            var chu24 = JSON.parse(hu24);
            var chu25 = JSON.parse(hu25);
            var chu26 = JSON.parse(hu26);
            var chu27 = JSON.parse(hu27);
            var chu28 = JSON.parse(hu28);
            var chu29 = JSON.parse(hu29);
            var chu30 = JSON.parse(hu30);
            var chu31 = JSON.parse(hu31);
            var chu32 = JSON.parse(hu32);
            var chu33 = JSON.parse(hu33);
            var chu34 = JSON.parse(hu34);
            var chu35 = JSON.parse(hu35);
            var chu36 = JSON.parse(hu36);
            var chu37 = JSON.parse(hu37);
            var chu38 = JSON.parse(hu38);
            var chu39 = JSON.parse(hu39);
            var chu40 = JSON.parse(hu40);
            var chu41 = JSON.parse(hu41);
            var chu42 = JSON.parse(hu42);
            var chu43 = JSON.parse(hu43);
            var chu44 = JSON.parse(hu44);
            var chu45 = JSON.parse(hu45);
            var chu46 = JSON.parse(hu46);
            var chu47 = JSON.parse(hu47);
            var chu48 = JSON.parse(hu48);
            
            hudacount=7;
        
            chuda[0] = Card(huda);
            chuda[0].setval(chu1.name,chu1.effect,chu1.pro,chu1.enumber);
            chuda[0].src = chu1.src;
            chuda[0].target = chu1.target;
            chuda[0].cost = chu1.cost;
            chuda[0].how = chu1.how;
            chuda[1] = Card(huda);
            chuda[1].setval(chu2.name,chu2.effect,chu2.pro,chu2.enumber);
            chuda[1].src = chu2.src;
            chuda[1].target = chu2.target;
            chuda[1].cost = chu2.cost;
            chuda[1].how = chu2.how;
            chuda[2] = Card(huda);
            chuda[2].setval(chu3.name,chu3.effect,chu3.pro,chu3.enumber);
            chuda[2].src = chu3.src;
            chuda[2].target = chu3.target;
            chuda[2].cost = chu3.cost;
            chuda[2].how = chu3.how;
            chuda[3] = Card(huda);
            chuda[3].setval(chu4.name,chu4.effect,chu4.pro,chu4.enumber);
            chuda[3].src = chu4.src;
            chuda[3].target = chu4.target;
            chuda[3].cost = chu4.cost;
            chuda[3].how = chu4.how;
            chuda[4] = Card(huda);
            chuda[4].setval(chu5.name,chu5.effect,chu5.pro,chu5.enumber);
            chuda[4].src = chu5.src;
            chuda[4].target = chu5.target;
            chuda[4].cost = chu5.cost;
            chuda[4].how = chu5.how;
            chuda[5] = Card(huda);
            chuda[5].setval(chu6.name,chu6.effect,chu6.pro,chu6.enumber);
            chuda[5].src = chu6.src;
            chuda[5].target = chu6.target;
            chuda[5].cost = chu6.cost;
            chuda[5].how = chu6.how;
            chuda[6] = Card(huda);
            chuda[6].setval(chu7.name,chu7.effect,chu7.pro,chu7.enumber);
            chuda[6].src = chu7.src;
            chuda[6].target = chu7.target;
            chuda[6].cost = chu7.cost;
            chuda[6].how = chu7.how;
            chuda[7] = Card(huda);
            chuda[7].setval(chu8.name,chu8.effect,chu8.pro,chu8.enumber);
            chuda[7].src = chu8.src;
            chuda[7].target = chu8.target;
            chuda[7].cost = chu8.cost;
            chuda[7].how = chu8.how;
            chuda[8] = Card(huda);
            chuda[8].setval(chu9.name,chu9.effect,chu9.pro,chu9.enumber);
            chuda[8].src = chu9.src;
            chuda[8].target = chu9.target;
            chuda[8].cost = chu9.cost;
            chuda[8].how = chu9.how;
            chuda[9] = Card(huda);
            chuda[9].setval(chu10.name,chu10.effect,chu10.pro,chu10.enumber);
            chuda[9].src = chu10.src;
            chuda[9].target = chu10.target;
            chuda[9].cost = chu10.cost;
            chuda[9].how = chu10.how;
            chuda[10] = Card(huda);
            chuda[10].setval(chu11.name,chu11.effect,chu11.pro,chu11.enumber);
            chuda[10].src = chu11.src;
            chuda[10].target = chu11.target;
            chuda[10].cost = chu11.cost;
            chuda[10].how = chu11.how;
            chuda[11] = Card(huda);
            chuda[11].setval(chu12.name,chu12.effect,chu12.pro,chu12.enumber);
            chuda[11].src = chu12.src;
            chuda[11].target = chu12.target;
            chuda[11].cost = chu12.cost;
            chuda[11].how = chu12.how;
            
            chuda[12] = Card(huda);
            chuda[12].setval(chu13.name,chu13.effect,chu13.pro,chu13.enumber);
            chuda[12].src = chu13.src;
            chuda[12].target = chu13.target;
            chuda[12].cost = chu13.cost;
            chuda[12].how = chu13.how;
            chuda[13] = Card(huda);
            chuda[13].setval(chu14.name,chu14.effect,chu14.pro,chu14.enumber);
            chuda[13].src = chu14.src;
            chuda[13].target = chu14.target;
            chuda[13].cost = chu14.cost;
            chuda[13].how = chu14.how;
            chuda[14] = Card(huda);
            chuda[14].setval(chu15.name,chu15.effect,chu15.pro,chu15.enumber);
            chuda[14].src = chu15.src;
            chuda[14].target = chu15.target;
            chuda[14].cost = chu15.cost;
            chuda[14].how = chu15.how;
            chuda[15] = Card(huda);
            chuda[15].setval(chu16.name,chu16.effect,chu16.pro,chu16.enumber);
            chuda[15].src = chu16.src;
            chuda[15].target = chu16.target;
            chuda[15].cost = chu16.cost;
            chuda[15].how = chu16.how;
            chuda[16] = Card(huda);
            chuda[16].setval(chu17.name,chu17.effect,chu17.pro,chu17.enumber);
            chuda[16].src = chu17.src;
            chuda[16].target = chu17.target;
            chuda[16].cost = chu17.cost;
            chuda[16].how = chu17.how;
            chuda[17] = Card(huda);
            chuda[17].setval(chu18.name,chu18.effect,chu18.pro,chu18.enumber);
            chuda[17].src = chu18.src;
            chuda[17].target = chu18.target;
            chuda[17].cost = chu18.cost;
            chuda[17].how = chu18.how;
            chuda[18] = Card(huda);
            chuda[18].setval(chu19.name,chu19.effect,chu19.pro,chu19.enumber);
            chuda[18].src = chu19.src;
            chuda[18].target = chu19.target;
            chuda[18].cost = chu19.cost;
            chuda[18].how = chu19.how;
            chuda[19] = Card(huda);
            chuda[19].setval(chu20.name,chu20.effect,chu20.pro,chu20.enumber);
            chuda[19].src = chu20.src;
            chuda[19].target = chu20.target;
            chuda[19].cost = chu20.cost;
            chuda[19].how = chu20.how;
            chuda[20] = Card(huda);
            chuda[20].setval(chu21.name,chu21.effect,chu21.pro,chu21.enumber);
            chuda[20].src = chu21.src;
            chuda[20].target = chu21.target;
            chuda[20].cost = chu21.cost;
            chuda[20].how = chu21.how;
            chuda[21] = Card(huda);
            chuda[21].setval(chu22.name,chu22.effect,chu22.pro,chu22.enumber);
            chuda[21].src = chu22.src;
            chuda[21].target = chu22.target;
            chuda[21].cost = chu22.cost;
            chuda[21].how = chu22.how;
            chuda[22] = Card(huda);
            chuda[22].setval(chu23.name,chu23.effect,chu23.pro,chu23.enumber);
            chuda[22].src = chu23.src;
            chuda[22].target = chu23.target;
            chuda[22].cost = chu23.cost;
            chuda[22].how = chu23.how;
            chuda[23] = Card(huda);
            chuda[23].setval(chu24.name,chu24.effect,chu24.pro,chu24.enumber);
            chuda[23].src = chu24.src;
            chuda[23].target = chu24.target;
            chuda[23].cost = chu24.cost;
            chuda[23].how = chu24.how;
        
            chuda[24] = Card(huda);
            chuda[24].setval(chu25.name,chu25.effect,chu25.pro,chu25.enumber);
            chuda[24].src = chu25.src;
            chuda[24].target = chu25.target;
            chuda[24].cost = chu25.cost;
            chuda[24].how = chu25.how;
            chuda[25] = Card(huda);
            chuda[25].setval(chu26.name,chu26.effect,chu26.pro,chu26.enumber);
            chuda[25].src = chu26.src;
            chuda[25].target = chu26.target;
            chuda[25].cost = chu26.cost;
            chuda[25].how = chu26.how;
            chuda[26] = Card(huda);
            chuda[26].setval(chu27.name,chu27.effect,chu27.pro,chu27.enumber);
            chuda[26].src = chu27.src;
            chuda[26].target = chu27.target;
            chuda[26].cost = chu27.cost;
            chuda[26].how = chu27.how;
            chuda[27] = Card(huda);
            chuda[27].setval(chu28.name,chu28.effect,chu28.pro,chu28.enumber);
            chuda[27].src = chu28.src;
            chuda[27].target = chu28.target;
            chuda[27].cost = chu28.cost;
            chuda[27].how = chu28.how;
            chuda[28] = Card(huda);
            chuda[28].setval(chu29.name,chu29.effect,chu29.pro,chu29.enumber);
            chuda[28].src = chu29.src;
            chuda[28].target = chu29.target;
            chuda[28].cost = chu29.cost;
            chuda[28].how = chu29.how;
            chuda[29] = Card(huda);
            chuda[29].setval(chu30.name,chu30.effect,chu30.pro,chu30.enumber);
            chuda[29].src = chu30.src;
            chuda[29].target = chu30.target;
            chuda[29].cost = chu30.cost;
            chuda[29].how = chu30.how;
            chuda[30] = Card(huda);
            chuda[30].setval(chu31.name,chu31.effect,chu31.pro,chu31.enumber);
            chuda[30].src = chu31.src;
            chuda[30].target = chu31.target;
            chuda[30].cost = chu31.cost;
            chuda[30].how = chu31.how;
            chuda[31] = Card(huda);
            chuda[31].setval(chu32.name,chu32.effect,chu32.pro,chu32.enumber);
            chuda[31].src = chu32.src;
            chuda[31].target = chu32.target;
            chuda[31].cost = chu32.cost;
            chuda[31].how = chu32.how;
            chuda[32] = Card(huda);
            chuda[32].setval(chu33.name,chu33.effect,chu33.pro,chu33.enumber);
            chuda[32].src = chu33.src;
            chuda[32].target = chu33.target;
            chuda[32].cost = chu33.cost;
            chuda[32].how = chu33.how;
            chuda[33] = Card(huda);
            chuda[33].setval(chu34.name,chu34.effect,chu34.pro,chu34.enumber);
            chuda[33].src = chu34.src;
            chuda[33].target = chu34.target;
            chuda[33].cost = chu34.cost;
            chuda[33].how = chu34.how;
            chuda[34] = Card(huda);
            chuda[34].setval(chu35.name,chu35.effect,chu35.pro,chu35.enumber);
            chuda[34].src = chu35.src;
            chuda[34].target = chu35.target;
            chuda[34].cost = chu35.cost;
            chuda[34].how = chu35.how;
            chuda[35] = Card(huda);
            chuda[35].setval(chu36.name,chu36.effect,chu36.pro,chu36.enumber);
            chuda[35].src = chu36.src;
            chuda[35].target = chu36.target;
            chuda[35].cost = chu36.cost;
            chuda[35].how = chu36.how;
        
            chuda[36] = Card(huda);
            chuda[36].setval(chu37.name,chu37.effect,chu37.pro,chu37.enumber);
            chuda[36].src = chu37.src;
            chuda[36].target = chu37.target;
            chuda[36].cost = chu37.cost;
            chuda[36].how = chu37.how;
            chuda[37] = Card(huda);
            chuda[37].setval(chu38.name,chu38.effect,chu38.pro,chu38.enumber);
            chuda[37].src = chu38.src;
            chuda[37].target = chu38.target;
            chuda[37].cost = chu38.cost;
            chuda[37].how = chu38.how;
            chuda[38] = Card(huda);
            chuda[38].setval(chu39.name,chu39.effect,chu39.pro,chu39.enumber);
            chuda[38].src = chu39.src;
            chuda[38].target = chu39.target;
            chuda[38].cost = chu39.cost;
            chuda[38].how = chu39.how;
            chuda[39] = Card(huda);
            chuda[39].setval(chu40.name,chu40.effect,chu40.pro,chu40.enumber);
            chuda[39].src = chu40.src;
            chuda[39].target = chu40.target;
            chuda[39].cost = chu40.cost;
            chuda[39].how = chu40.how;
            chuda[40] = Card(huda);
            chuda[40].setval(chu41.name,chu41.effect,chu41.pro,chu41.enumber);
            chuda[40].src = chu41.src;
            chuda[40].target = chu41.target;
            chuda[40].cost = chu41.cost;
            chuda[40].how = chu41.how;
            chuda[41] = Card(huda);
            chuda[41].setval(chu42.name,chu42.effect,chu42.pro,chu42.enumber);
            chuda[41].src = chu42.src;
            chuda[41].target = chu42.target;
            chuda[41].cost = chu42.cost;
            chuda[41].how = chu42.how;
            chuda[42] = Card(huda);
            chuda[42].setval(chu43.name,chu43.effect,chu43.pro,chu43.enumber);
            chuda[42].src = chu43.src;
            chuda[42].target = chu43.target;
            chuda[42].cost = chu43.cost;
            chuda[42].how = chu43.how;
            chuda[43] = Card(huda);
            chuda[43].setval(chu44.name,chu44.effect,chu44.pro,chu44.enumber);
            chuda[43].src = chu44.src;
            chuda[43].target = chu44.target;
            chuda[43].cost = chu44.cost;
            chuda[43].how = chu44.how;
            chuda[44] = Card(huda);
            chuda[44].setval(chu45.name,chu45.effect,chu45.pro,chu45.enumber);
            chuda[44].src = chu45.src;
            chuda[44].target = chu45.target;
            chuda[44].cost = chu45.cost;
            chuda[44].how = chu45.how;
            chuda[45] = Card(huda);
            chuda[45].setval(chu46.name,chu46.effect,chu46.pro,chu46.enumber);
            chuda[45].src = chu46.src;
            chuda[45].target = chu46.target;
            chuda[45].cost = chu46.cost;
            chuda[45].how = chu46.how;
            chuda[46] = Card(huda);
            chuda[46].setval(chu47.name,chu47.effect,chu47.pro,chu47.enumber);
            chuda[46].src = chu47.src;
            chuda[46].target = chu47.target;
            chuda[46].cost = chu47.cost;
            chuda[46].how = chu47.how;
            chuda[47] = Card(huda);
            chuda[47].setval(chu48.name,chu48.effect,chu48.pro,chu48.enumber);
            chuda[47].src = chu48.src;
            chuda[47].target = chu48.target;
            chuda[47].cost = chu48.cost;
            chuda[47].how = chu48.how;
            
            shuffle_huda();
        
            for(var i=0; i<8; i++){
                hucard[i]=chuda[i];
            }
            
            $("#huda1").attr("src",chuda[0].src);
            $("#huda2").attr("src",chuda[1].src);
            $("#huda3").attr("src",chuda[2].src);
            $("#huda4").attr("src",chuda[3].src);
            $("#huda5").attr("src",chuda[4].src);
            $("#huda6").attr("src",chuda[5].src);
            $("#huda7").attr("src",chuda[6].src);
            $("#huda8").attr("src",chuda[7].src);
            $("#cost_1").html(chuda[0].cost);
            $("#cost_2").html(chuda[1].cost);
            $("#cost_3").html(chuda[2].cost);
            $("#cost_4").html(chuda[3].cost);
            $("#cost_5").html(chuda[4].cost);
            $("#cost_6").html(chuda[5].cost);
            $("#cost_7").html(chuda[6].cost);
            $("#cost_8").html(chuda[7].cost);
     });
    socket.on('set king', function(med,youd){
        $("#back_img").show();
        var aomg = JSON.parse(med);
        var aomg2 = JSON.parse(youd);
        //alert(aomg2.name);
        
        
        if(aomg!=null){
                var todo01 = document.createElement('img');
                todo01.setAttribute("id","king02");
                todo01.setAttribute("class","king");
                document.getElementById("g61").appendChild(todo01);

                var dtodo01 = document.createElement('div');
                dtodo01.setAttribute("class","bpsta");
                document.getElementById("g61").appendChild(dtodo01);

                var atodo01 = document.createElement('a');
                atodo01.setAttribute("class","p_attack");
                $("#g61").children(".bpsta").append(atodo01);
                
                var prtodo01 = document.createElement('div');
                prtodo01.setAttribute("class","p_pro");
                $("#g61").children(".bpsta").append(prtodo01);
                var ksrc = getpro_img('king','b');
                $("#g61>.bpsta>.p_pro").css("background-image",'url('+ksrc+')');
            
                var ptodo01 = document.createElement('a');
                ptodo01.setAttribute("class","p_hp");
                $("#g61").children(".bpsta").append(ptodo01);
            
                bking = Create(siro);
                bking.setval(aomg.name,aomg.hp,aomg.attack,"king",aomg.pos,'b','king02');
                bking.src = aomg.src;
                bking.ori_hp=aomg.hp;
                bking.ori_attack=aomg.attack;
                $("#king02").attr("src",aomg.src);
            
                $("#g"+aomg.pos).children('.bpsta').children('.p_hp').text(aomg.hp);
                //$("#g"+aomg.pos).children('.bpsta').children('.p_pro').text(aomg.pro);
                $("#g"+aomg.pos).children('.bpsta').children('.p_attack').text(aomg.attack);
                
                $("#king02").click( function() {
				    if(grandc=="false"){
					   cid = "king02";
					   cpi = bking;
					   epass="true";
				    }
				    if(swit=="true"){
                       var offset = $("#uptown").offset();
                       $('html, body').animate({scrollTop : offset.top}, 300);
					   var hero = document.getElementById( 'king02' ).getAttribute('src');
					   $('#cutton').css('display','block');
					   swit="false";
					   $("#hero").attr('src', hero);
					   $("#hero").attr('style', "opacity:1");
					   if(kan[bking.pos-1].count!=30) {
						  //$("#hero").attr('src', "./black.jpg");
						  $("#rival").attr('style', "opacity:0");
						  $("#rhp").hide();
						  $("#hhp").show();
						  var rhp = bking.hp/bking.ori_hp;
						  $("#ghp").text("HP:"+bking.hp+"/"+bking.ori_hp);
						  $(".gaze").width(rhp*100+"%");
                          if(bking.hp>bking.ori_hp){
                                $(".gaze").width(100+"%");
                            }
					   }else{
						  $("#rival").attr('style', "opacity:1");
					   }
				    }else{
					   $('#cutton').css('display','none');
					   swit="true";
				    }
			});
           }else{
                bking=null;
                $("#king02").parent().children('.bpsta').remove();
                $("#king02").remove();
           }
        
            if(aomg2!=null){
                
                var todo02 = document.createElement('img');
                todo02.setAttribute("id","king01");
                todo02.setAttribute("class","king");
                document.getElementById("g4").appendChild(todo02);

                var dtodo02 = document.createElement('div');
                dtodo02.setAttribute("class","rpsta");
                document.getElementById("g4").appendChild(dtodo02);
                
                var atodo02 = document.createElement('a');
                atodo02.setAttribute("class","p_attack");
                $("#g4").children(".rpsta").append(atodo02);
                
                var prtodo02 = document.createElement('div');
                prtodo02.setAttribute("class","p_pro");
                $("#g4").children(".rpsta").append(prtodo02);
                var ksrc2 = getpro_img('king','r');
                $("#g4>.rpsta>.p_pro").css("background-image",'url('+ksrc2+')');

                var ptodo02 = document.createElement('a');
                ptodo02.setAttribute("class","p_hp");
                $("#g4").children(".rpsta").append(ptodo02);
                
                rking = Create(siro);
                rking.setval(aomg2.name,aomg2.hp,aomg2.attack,"king",aomg2.rpos,'r',"king01");
                rking.src = aomg2.src;
                rking.ori_hp=aomg2.hp;
                rking.ori_attack=aomg2.attack;
                //$("#king01").attr("src",youd["king"].src);
                $("#king01").attr("src",aomg2.src);
        
                $("#g"+rking.pos).children('.rpsta').children('.p_hp').text(rking.hp);
                //$("#g"+rking.pos).children('.rpsta').children('.p_pro').text(rking.pro);
                $("#g"+rking.pos).children('.rpsta').children('.p_attack').text(rking.attack);
        
                $("#king01").click( function() {
				if(swit=="true"){
                    var offset = $("#uptown").offset();
                    $('html, body').animate({scrollTop : offset.top}, 300);
					var hero = document.getElementById( 'king01' ).getAttribute('src');
					$('#cutton').css('display','block');
					swit="false";
					$("#rival").attr('src', hero);
					$("#rival").attr('style', "opacity:1");
					if(kan[rking.pos-1].count!=30) {
						
						$("#hero").attr('style', "opacity:0");
						$("#hhp").hide();
						$("#rhp").show();
						var rhp = rking.hp/rking.ori_hp;
						$("#ghp2").text("HP:"+rking.hp+"/"+rking.ori_hp);
						$(".gaze2").width(rhp*100+"%");
                        if(rking.hp>rking.ori_hp){
                            $(".gaze2").width(100+"%");
                        }
					}else{
						$("#hero").attr('style', "opacity:1");
					}
				}else{
					$('#cutton').css('display','none');
					swit="true";
				}
			});
            }else{
                rking=null;
                $("#king01").parent().children('.rpsta').remove();
                $("#king01").remove();
            }
        //$("#king02").attr("src",king[7]);
        //alert(bking.id);    
        
        
        
    });
    socket.on('set queen', function(med,youd){
        
        var aomg = JSON.parse(med);
        var aomg2 = JSON.parse(youd);
        
        if(aomg!=null){ 
            
            var qtodo01 = document.createElement('img');
            qtodo01.setAttribute("id","queen02");
            qtodo01.setAttribute("class","quuen");
            document.getElementById("g60").appendChild(qtodo01);

            var qdtodo01 = document.createElement('div');
            qdtodo01.setAttribute("class","bpsta");
            document.getElementById("g60").appendChild(qdtodo01);

            var qatodo01 = document.createElement('a');
            qatodo01.setAttribute("class","p_attack");
            $("#g60").children(".bpsta").append(qatodo01);
            
            var qprtodo01 = document.createElement('div');
            qprtodo01.setAttribute("class","p_pro");
            $("#g60").children(".bpsta").append(qprtodo01);
            var qsrc = getpro_img('queen','b');
            $("#g60>.bpsta>.p_pro").css("background-image",'url('+qsrc+')');

            var qptodo01 = document.createElement('a');
            qptodo01.setAttribute("class","p_hp");
            $("#g60").children(".bpsta").append(qptodo01);
            
            bqueen = Create(siro);
            bqueen.setval(aomg.name,aomg.hp,aomg.attack,"queen",aomg.pos,'b','queen02');
            bqueen.src = aomg.src;
            bqueen.ori_hp=aomg.hp;
            bqueen.ori_attack = aomg.attack;
            
            $("#queen02").attr("src",aomg.src);
            
            $("#g"+aomg.pos).children('.bpsta').children('.p_hp').text(aomg.hp);
            //$("#g"+aomg.pos).children('.bpsta').children('.p_pro').text(aomg.pro);
            $("#g"+aomg.pos).children('.bpsta').children('.p_attack').text(aomg.attack);
            
            $("#queen02").click( function() {
				if(grandc=="false"){
					cid = "queen02";
					cpi = bqueen;
					epass="true";
				}
				if(swit=="true"){
                    var offset = $("#uptown").offset();
                    $('html, body').animate({scrollTop : offset.top}, 300);
					var hero = document.getElementById( 'queen02' ).getAttribute('src');
					$('#cutton').css('display','block');
					swit="false";
					$("#hero").attr('src', hero);
					$("#hero").attr('style', "opacity:1");
					if(kan[bqueen.pos-1].count!=30) {
						//$("#hero").attr('src', "./black.jpg");
						$("#rival").attr('style', "opacity:0");
						$("#rhp").hide();
						$("#hhp").show();
						var rhp = bqueen.hp/bqueen.ori_hp;
						$("#ghp").text("HP:"+bqueen.hp+"/"+bqueen.ori_hp);
						$(".gaze").width(rhp*100+"%");
                        if(bqueen.hp>bqueen.ori_hp){
                            $(".gaze").width(100+"%");
                        }
					}else{
						$("#rival").attr('style', "opacity:1");
					}
				}else{
					$('#cutton').css('display','none');
					swit="true";
				}
			});
            
        }else{
            bqueen=null;
            $("#queen02").parent().children('.bpsta').remove();
            $("#queen02").remove();
        }
        
        if(aomg2!=null){
            
            var qtodo02 = document.createElement('img');
            qtodo02.setAttribute("id","queen01");
            qtodo02.setAttribute("class","quuen");
            document.getElementById("g5").appendChild(qtodo02);

            var qdtodo02 = document.createElement('div');
            qdtodo02.setAttribute("class","rpsta");
            document.getElementById("g5").appendChild(qdtodo02);

            var qatodo02 = document.createElement('a');
            qatodo02.setAttribute("class","p_attack");
            $("#g5").children(".rpsta").append(qatodo02); 

            var qprtodo02 = document.createElement('div');
            qprtodo02.setAttribute("class","p_pro");
            $("#g5").children(".rpsta").append(qprtodo02);
            var qsrc2 = getpro_img('queen','r');
            $("#g5>.rpsta>.p_pro").css("background-image",'url('+qsrc2+')');
            
            var qptodo02 = document.createElement('a');
            qptodo02.setAttribute("class","p_hp");
            $("#g5").children(".rpsta").append(qptodo02);
            
            rqueen = Create(siro);
            rqueen.setval(aomg2.name,aomg2.hp,aomg2.attack,"queen",aomg2.rpos,'r','queen01');
            rqueen.src = aomg2.src;
            rqueen.ori_hp=aomg2.hp;
            rqueen.ori_attack = aomg2.attack;
            
            $("#queen01").attr("src",aomg2.src);
            
            $("#g"+rqueen.pos).children('.rpsta').children('.p_hp').text(rqueen.hp);
            //$("#g"+rqueen.pos).children('.rpsta').children('.p_pro').text(rqueen.pro);
            $("#g"+rqueen.pos).children('.rpsta').children('.p_attack').text(rqueen.attack);
        
            $("#queen01").click( function() {
				if(swit=="true"){
                    var offset = $("#uptown").offset();
                    $('html, body').animate({scrollTop : offset.top}, 300);
					var hero = document.getElementById( 'queen01' ).getAttribute('src');
					$('#cutton').css('display','block');
					swit="false";
					$("#rival").attr('src', hero);
					$("#rival").attr('style', "opacity:1");
					if(kan[rqueen.pos-1].count!=30) {
						//$("#hero").attr('src', "./black.jpg");
						$("#hero").attr('style', "opacity:0");
						$("#hhp").hide();
						$("#rhp").show();
						var rhp = rqueen.hp/rqueen.ori_hp;
						$("#ghp2").text("HP:"+rqueen.hp+"/"+rqueen.ori_hp);
						$(".gaze2").width(rhp*100+"%");
                        if(rqueen.hp>rqueen.ori_hp){
                            $(".gaze2").width(100+"%");
                        }
					}else{
						$("#hero").attr('style', "opacity:1");
					}
				}else{
					$('#cutton').css('display','none');
					swit="true";
				}
			});
        }else{
            rqueen=null;
            $("#queen01").parent().children('.rpsta').remove();
            $("#queen01").remove();
        }
        
    });
    
    socket.on('set knight', function(med1,med2,youd1,youd2){
        
        var mk01 = JSON.parse(med1);
        var mk02 = JSON.parse(med2);
        var yk02 = JSON.parse(youd1);
        var yk01 = JSON.parse(youd2);
        
        if(mk01!=null){
            
                var knppl = document.createElement('img');
                knppl.setAttribute("id","ni03");
                knppl.setAttribute("class","kni");
                document.getElementById("g58").appendChild(knppl);

                var knpstad = document.createElement('div');
                knpstad.setAttribute("class","bpsta");
                document.getElementById("g58").appendChild(knpstad);

                var knp_atd = document.createElement('a');
                knp_atd.setAttribute("class","p_attack");
                $("#g58").children(".bpsta").append(knp_atd);  
            
                var knp_prod = document.createElement('div');
                knp_prod.setAttribute("class","p_pro");
                $("#g58").children(".bpsta").append(knp_prod);
                var kisrc = getpro_img('knight','b');
                $("#g58>.bpsta>.p_pro").css("background-image",'url('+kisrc+')');

                var knp_hpd = document.createElement('a');
                knp_hpd.setAttribute("class","p_hp");
                $("#g58").children(".bpsta").append(knp_hpd);  
            
                bk01 = Create(siro);
                bk01.setval(mk01.name,mk01.hp,mk01.attack,"knight",mk01.pos,'b','ni03');
                bk01.src = mk01.src;
                bk01.ori_hp = mk01.hp;
                bk01.ori_attack = mk01.attack;
            
                $("#ni03").attr("src",mk01.src);
                $("#g"+mk01.pos).children('.bpsta').children('.p_hp').text(mk01.hp);
                //$("#g"+mk01.pos).children('.bpsta').children('.p_pro').text(mk01.pro);
                $("#g"+mk01.pos).children('.bpsta').children('.p_attack').text(mk01.attack);
                
                $("#ni03").click( function() {
				if(grandc=="false"){
					cid = "ni03";
					cpi = bk01;
					epass="true";
				}
				if(swit=="true"){
                    var offset = $("#uptown").offset();
                    $('html, body').animate({scrollTop : offset.top}, 300);
					var hero = document.getElementById( 'ni03' ).getAttribute('src');
					$('#cutton').css('display','block');
					swit="false";
					$("#hero").attr('src', hero);
					$("#hero").attr('style', "opacity:1");
					if(kan[bk01.pos-1].count!=30) {
						//$("#hero").attr('src', "./black.jpg");
						$("#rival").attr('style', "opacity:0");
						$("#rhp").hide();
						$("#hhp").show();
						var rhp = bk01.hp/bk01.ori_hp;
						$("#ghp").text("HP:"+bk01.hp+"/"+bk01.ori_hp);
						$(".gaze").width(rhp*100+"%");
                        if(bk01.hp>bk01.ori_hp){
                            $(".gaze").width(100+"%");
                        }
					}else{
						$("#rival").attr('style', "opacity:1");
					}
				}else{
					$('#cutton').css('display','none');
					swit="true";
				}
			});
            
           }else{
               bk01=null;
               $("#ni03").parent().children('.bpsta').remove();
               $("#ni03").remove();
           }
            
        if(mk02!=null){
            
                var knppl02 = document.createElement('img');
                knppl02.setAttribute("id","ni04");
                knppl02.setAttribute("class","kni");
                document.getElementById("g63").appendChild(knppl02);

                var knpstad02 = document.createElement('div');
                knpstad02.setAttribute("class","bpsta");
                document.getElementById("g63").appendChild(knpstad02);

                var knp_atd02 = document.createElement('a');
                knp_atd02.setAttribute("class","p_attack");
                $("#g63").children(".bpsta").append(knp_atd02);

                var knp_prod02 = document.createElement('div');
                knp_prod02.setAttribute("class","p_pro");
                $("#g63").children(".bpsta").append(knp_prod02);
                var kisrc2 = getpro_img('knight','b');
                $("#g63>.bpsta>.p_pro").css("background-image",'url('+kisrc2+')');

                var knp_hpd02 = document.createElement('a');
                knp_hpd02.setAttribute("class","p_hp");
                $("#g63").children(".bpsta").append(knp_hpd02); 
            
                bk02 = Create(siro);
                bk02.setval(mk02.name,mk02.hp,mk02.attack,"knight",mk02.pos,'b','ni04');
                bk02.src = mk02.src;
                bk02.ori_hp = mk02.hp;
                bk02.ori_attack = mk02.attack;
                
                $("#ni04").attr("src",mk02.src);
                $("#g"+mk02.pos).children('.bpsta').children('.p_hp').text(mk02.hp);
                //$("#g"+mk02.pos).children('.bpsta').children('.p_pro').text(mk02.pro);
                $("#g"+mk02.pos).children('.bpsta').children('.p_attack').text(mk02.attack);
                
                $("#ni04").on({
				    click: function() {
					   if(grandc=="false"){
						  cid = "ni04";
						  cpi = bk02;
						  epass="true";
					   }
				       if(swit=="true"){
                           var offset = $("#uptown").offset();
                           $('html, body').animate({scrollTop : offset.top}, 300);
					       var hero = document.getElementById( 'ni04' ).getAttribute('src');
					       $('#cutton').css('display','block');
					       swit="false";
					       $("#hero").attr('src', hero);
					       $("#hero").attr('style', "opacity:1");
					       if(kan[bk02.pos-1].count!=30) {
						      //$("#hero").attr('src', "./black.jpg");
						      $("#rival").attr('style', "opacity:0");
						      $("#rhp").hide();
						      $("#hhp").show();
						      var rhp = bk02.hp/bk02.ori_hp;
						      $("#ghp").text("HP:"+bk02.hp+"/"+bk02.ori_hp);
						      $(".gaze").width(rhp*100+"%");
                            if(bk02.hp>bk02.ori_hp){
                                $(".gaze").width(100+"%");
                            }
					       }else{
						          $("#rival").attr('style', "opacity:1");
					       }
				        }else{
					       $('#cutton').css('display','none');
					       swit="true";
				        }
				    }
			 });
            }else{
                bk02=null;
                $("#ni04").parent().children('.bpsta').remove();
                $("#ni04").remove();
            }
        
        if(yk01!=null){
            
                    var knppl03 = document.createElement('img');
                    knppl03.setAttribute("id","ni01");
                    knppl03.setAttribute("class","kni");
                    document.getElementById("g2").appendChild(knppl03);

                    var knpstad03 = document.createElement('div');
                    knpstad03.setAttribute("class","rpsta");
                    document.getElementById("g2").appendChild(knpstad03);
            
                    var knp_atd03 = document.createElement('a');
                    knp_atd03.setAttribute("class","p_attack");
                    $("#g2").children(".rpsta").append(knp_atd03);

                    var knp_prod03 = document.createElement('div');
                    knp_prod03.setAttribute("class","p_pro");
                    $("#g2").children(".rpsta").append(knp_prod03);
                    var kisrc3 = getpro_img('knight','r');
                    $("#g2>.rpsta>.p_pro").css("background-image",'url('+kisrc3+')');

                    var knp_hpd03 = document.createElement('a');
                    knp_hpd03.setAttribute("class","p_hp");
                    $("#g2").children(".rpsta").append(knp_hpd03);
            
                    rk01 = Create(siro);
                    rk01.setval(yk01.name,yk01.hp,yk01.attack,"knight",yk01.rpos,'r','ni01');
                    rk01.src = yk01.src;
                    rk01.ori_hp = yk01.hp;
                    rk01.ori_attack = yk01.attack;
                    
                    $("#ni01").attr("src",yk01.src);
                    $("#g"+rk01.pos).children('.rpsta').children('.p_hp').text(rk01.hp);
                    //$("#g"+rk01.pos).children('.rpsta').children('.p_pro').text(rk01.pro);
                    $("#g"+rk01.pos).children('.rpsta').children('.p_attack').text(rk01.attack);
                
                    $("#ni01").click( function() {
                        if(swit=="true"){
                            var offset = $("#uptown").offset();
                            $('html, body').animate({scrollTop : offset.top}, 300);
                            var hero = document.getElementById( 'ni01' ).getAttribute('src');
                            $('#cutton').css('display','block');
                            swit="false";
                            $("#rival").attr('src', hero);
                            $("#rival").attr('style', "opacity:1");
                            if(kan[rk01.pos-1].count!=30) {
                                $("#hero").attr('style', "opacity:0");
                                $("#hhp").hide();
                                $("#rhp").show();
                                var rhp = rk01.hp/rk01.ori_hp;
                                $("#ghp2").text("HP:"+rk01.hp+"/"+rk01.ori_hp);
                                $(".gaze2").width(rhp*100+"%");
                                if(rk01.hp>rk01.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                            }else{
                                $("#hero").attr('style', "opacity:1");
                            }
                        }else{
                            $('#cutton').css('display','none');
                            swit="true";
                        }
                    });
               }else{
                    rk01=null;
                    $("#ni01").parent().children('.rpsta').remove();
                    $("#ni01").remove();
               }
        
            if(yk02!=null){
                
                var knppl04 = document.createElement('img');
                knppl04.setAttribute("id","ni02");
                knppl04.setAttribute("class","kni");
                document.getElementById("g7").appendChild(knppl04);

                var knpstad04 = document.createElement('div');
                knpstad04.setAttribute("class","rpsta");
                document.getElementById("g7").appendChild(knpstad04);

                var knp_atd04 = document.createElement('a');
                knp_atd04.setAttribute("class","p_attack");
                $("#g7").children(".rpsta").append(knp_atd04);
                
                var knp_prod04 = document.createElement('div');
                knp_prod04.setAttribute("class","p_pro");
                $("#g7").children(".rpsta").append(knp_prod04);
                var kisrc4 = getpro_img('knight','r');
                $("#g7>.rpsta>.p_pro").css("background-image",'url('+kisrc4+')');

                var knp_hpd04 = document.createElement('a');
                knp_hpd04.setAttribute("class","p_hp");
                $("#g7").children(".rpsta").append(knp_hpd04);
                
                rk02 = Create(siro);
                rk02.setval(yk02.name,yk02.hp,yk02.attack,"knight",yk02.rpos,'r','ni02');
                rk02.src = yk02.src;
                rk02.ori_hp = yk02.hp;
                rk02.ori_attack = yk02.attack;
                
                $("#ni02").attr("src",yk02.src);
                $("#g"+rk02.pos).children('.rpsta').children('.p_hp').text(rk02.hp);
                //$("#g"+rk02.pos).children('.rpsta').children('.p_pro').text(rk02.pro);
                $("#g"+rk02.pos).children('.rpsta').children('.p_attack').text(rk02.attack);
                
                $("#ni02").click( function() {
                        if(swit=="true"){
                            var offset = $("#uptown").offset();
                            $('html, body').animate({scrollTop : offset.top}, 300);
                            var hero = document.getElementById( 'ni02' ).getAttribute('src');
                            $('#cutton').css('display','block');
                            swit="false";
                            $("#rival").attr('src', hero);
                            $("#rival").attr('style', "opacity:1");
                            if(kan[rk02.pos-1].count!=30) {
                                //$("#hero").attr('src', "./black.jpg");
                                $("#hero").attr('style', "opacity:0");
                                $("#hhp").hide();
                                $("#rhp").show();
                                var rhp = rk02.hp/rk02.ori_hp;
                                $("#ghp2").text("HP:"+rk02.hp+"/"+rk02.ori_hp);
                                $(".gaze2").width(rhp*100+"%");
                                if(rk02.hp>rk02.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                            }else{
                                $("#hero").attr('style', "opacity:1");
                            }
                        }else{
                            $('#cutton').css('display','none');
                            swit="true";
                        }
                    });
                
            }else{
                rk02=null;
                $("#ni02").parent().children('.rpsta').remove();
                $("#ni02").remove();
            }
    });
    
    socket.on('set bishop', function(med1,med2,youd1,youd2){
        
        var mk01 = JSON.parse(med1);
        var mk02 = JSON.parse(med2);
        var yk02 = JSON.parse(youd1);
        var yk01 = JSON.parse(youd2);
        //alert(aomg2.name);
        
        if(yk01!=null){
            
                var bippl01 = document.createElement('img');
                bippl01.setAttribute("id","bi01");
                bippl01.setAttribute("class","bis");
                document.getElementById("g3").appendChild(bippl01);

                var bipstad01 = document.createElement('div');
                bipstad01.setAttribute("class","rpsta");
                document.getElementById("g3").appendChild(bipstad01);

                var bip_atd01 = document.createElement('a');
                bip_atd01.setAttribute("class","p_attack");
                $("#g3").children(".rpsta").append(bip_atd01);
            
                var bip_prod01 = document.createElement('div');
                bip_prod01.setAttribute("class","p_pro");
                $("#g3").children(".rpsta").append(bip_prod01);
                var bisrc = getpro_img('bishop','r');
                $("#g3>.rpsta>.p_pro").css("background-image",'url('+bisrc+')');

                var bip_hpd01 = document.createElement('a');
                bip_hpd01.setAttribute("class","p_hp");
                $("#g3").children(".rpsta").append(bip_hpd01);
            
                rb01 = Create(siro);
                rb01.setval(yk01.name,yk01.hp,yk01.attack,"bishop",yk01.rpos,'r','bi01');
                rb01.src = yk01.src;
                rb01.ori_hp = yk01.hp;
                rb01.ori_attack = yk01.attack;
                
                $("#bi01").attr("src",yk01.src);
                $("#g"+rb01.pos).children('.rpsta').children('.p_hp').text(rb01.hp);
                //$("#g"+rb01.pos).children('.rpsta').children('.p_pro').text(rb01.pro);
                $("#g"+rb01.pos).children('.rpsta').children('.p_attack').text(rb01.attack);
            
                $("#bi01").on({
                        click: function() {
                            if(swit=="true"){
                                var offset = $("#uptown").offset();
                                $('html, body').animate({scrollTop : offset.top}, 300);
                                var hero = document.getElementById( 'bi01' ).getAttribute('src');
                                $('#cutton').css('display','block');
                                swit="false";
                                $("#rival").attr('src', hero);
                                $("#rival").attr('style', "opacity:1");
                                if(kan[rb01.pos-1].count!=30) {
                                    //$("#hero").attr('src', "./black.jpg");
                                    $("#hero").attr('style', "opacity:0");
                                    $("#hhp").hide();
                                    $("#rhp").show();
                                    var rhp = rb01.hp/rb01.ori_hp;
                                    $("#ghp2").text("HP:"+rb01.hp+"/"+rb01.ori_hp);
                                    $(".gaze2").width(rhp*100+"%");
                                    if(rb01.hp>rb01.ori_hp){
                                        $(".gaze2").width(100+"%");
                                    }
                                }else{
                                    $("#hero").attr('style', "opacity:1");
                                }
                            }else{
                                $('#cutton').css('display','none');
                                swit="true";
                            }
                        },
                        mouseover: function(e){
                            if(sot==1){
                                sot=0;
                                $(e.target).parent().children('.glass').css("display","block");
                                $(e.target).parent().children('.glass').on("mouseout",function(event){
                                    sot=1;
                                    $(event.target).css("display","none");
                                })
                            }
                        },
                        mouseout: function(e){
                            $(e.target).parent().children('.glass').css("display","none");
                            sot=1;
                        }
                    });
           }else{
               rb01=null;
               $("#bi01").parent().children('.rpsta').remove();
               $("#bi01").remove();
           }
            
        if(yk02!=null){
            
                var bippl02 = document.createElement('img');
                bippl02.setAttribute("id","bi02");
                bippl02.setAttribute("class","bis");
                document.getElementById("g6").appendChild(bippl02);

                var bipstad02 = document.createElement('div');
                bipstad02.setAttribute("class","rpsta");
                document.getElementById("g6").appendChild(bipstad02);

                var bip_atd02 = document.createElement('a');
                bip_atd02.setAttribute("class","p_attack");
                $("#g6").children(".rpsta").append(bip_atd02);
            
                var bip_prod02 = document.createElement('div');
                bip_prod02.setAttribute("class","p_pro");
                $("#g6").children(".rpsta").append(bip_prod02);
                var bisrc2 = getpro_img('bishop','r');
                $("#g6>.rpsta>.p_pro").css("background-image",'url('+bisrc2+')');

                var bip_hpd02 = document.createElement('a');
                bip_hpd02.setAttribute("class","p_hp");
                $("#g6").children(".rpsta").append(bip_hpd02);
            
                rb02 = Create(siro);
                rb02.setval(yk02.name,yk02.hp,yk02.attack,"bishop",yk02.rpos,'r','bi02');
                rb02.src = yk02.src;
                rb02.ori_hp = yk02.hp;
                rb02.ori_attack = yk02.attack;
            
                $("#bi02").attr("src",yk02.src);
                $("#g"+rb02.pos).children('.rpsta').children('.p_hp').text(rb02.hp);
                //$("#g"+rb02.pos).children('.rpsta').children('.p_pro').text(rb02.pro);
                $("#g"+rb02.pos).children('.rpsta').children('.p_attack').text(rb02.attack);
            
                $("#bi02").click( function() {
				if(swit=="true"){
                    var offset = $("#uptown").offset();
                    $('html, body').animate({scrollTop : offset.top}, 300);
					var hero = document.getElementById( 'bi02' ).getAttribute('src');
					$('#cutton').css('display','block');
					swit="false";
					$("#rival").attr('src', hero);
					$("#rival").attr('style', "opacity:1");
					if(kan[rb02.pos-1].count!=30) {
						//$("#hero").attr('src', "./black.jpg");
						$("#hero").attr('style', "opacity:0");
						$("#hhp").hide();
						$("#rhp").show();
						var rhp = rb02.hp/rb02.ori_hp;
						$("#ghp2").text("HP:"+rb02.hp+"/"+rb02.ori_hp);
						$(".gaze2").width(rhp*100+"%");
                        if(rb02.hp>rb02.ori_hp){
                                $(".gaze2").width(100+"%");
                            }
					}else{
						$("#hero").attr('style', "opacity:1");
					}
				}else{
					$('#cutton').css('display','none');
					swit="true";
				}
			});
           }else{
                rb02=null;
                $("#bi02").parent().children('.rpsta').remove();
                $("#bi02").remove();
           }
        
        if(mk01!=null){
            
                var bippl03 = document.createElement('img');
                bippl03.setAttribute("id","bi03");
                bippl03.setAttribute("class","bis");
                document.getElementById("g59").appendChild(bippl03);

                var bipstad03 = document.createElement('div');
                bipstad03.setAttribute("class","bpsta");
                document.getElementById("g59").appendChild(bipstad03);

                var bip_atd03 = document.createElement('a');
                bip_atd03.setAttribute("class","p_attack");
                $("#g59").children(".bpsta").append(bip_atd03);
            
                var bip_prod03 = document.createElement('div');
                bip_prod03.setAttribute("class","p_pro");
                $("#g59").children(".bpsta").append(bip_prod03);
                var bisrc3 = getpro_img('bishop','b');
                $("#g59>.bpsta>.p_pro").css("background-image",'url('+bisrc3+')');

                var bip_hpd03 = document.createElement('a');
                bip_hpd03.setAttribute("class","p_hp");
                $("#g59").children(".bpsta").append(bip_hpd03);
            
                bb01 = Create(siro);
                bb01.setval(mk01.name,mk01.hp,mk01.attack,"bishop",mk01.pos,'b','bi03');
                bb01.src = mk01.src;
                bb01.ori_hp = mk01.hp;
                bb01.ori_attack = mk01.attack;
                
                $("#bi03").attr("src",mk01.src);
                $("#g"+mk01.pos).children('.bpsta').children('.p_hp').text(mk01.hp);
                //$("#g"+mk01.pos).children('.bpsta').children('.p_pro').text(mk01.pro);
                $("#g"+mk01.pos).children('.bpsta').children('.p_attack').text(mk01.attack);
            
                $("#bi03").click( function() {
                    if(grandc=="false"){
                        cid = "bi03";
                        cpi = bb01;
                        epass="true";
                    }
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'bi03' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', hero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[bb01.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = bb01.hp/bb01.ori_hp;
                            $("#ghp").text("HP:"+bb01.hp+"/"+bb01.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(bb01.hp>bb01.ori_hp){
                                    $(".gaze").width(100+"%");
                                }
                        }else{
                            $("#rival").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                bb01=null;
                $("#bi03").parent().children('.bpsta').remove();
                $("#bi03").remove();
           }
        
        if(mk02!=null){
            
                var bippl04 = document.createElement('img');
                bippl04.setAttribute("id","bi04");
                bippl04.setAttribute("class","bis");
                document.getElementById("g62").appendChild(bippl04);

                var bipstad04 = document.createElement('div');
                bipstad04.setAttribute("class","bpsta");
                document.getElementById("g62").appendChild(bipstad04);

                var bip_atd04 = document.createElement('a');
                bip_atd04.setAttribute("class","p_attack");
                $("#g62").children(".bpsta").append(bip_atd04);
            
                var bip_prod04 = document.createElement('div');
                bip_prod04.setAttribute("class","p_pro");
                $("#g62").children(".bpsta").append(bip_prod04);
                var bisrc4 = getpro_img('bishop','b');
                $("#g62>.bpsta>.p_pro").css("background-image",'url('+bisrc4+')');

                var bip_hpd04 = document.createElement('a');
                bip_hpd04.setAttribute("class","p_hp");
                $("#g62").children(".bpsta").append(bip_hpd04);
            
                bb02 = Create(siro);
                bb02.setval(mk02.name,mk02.hp,mk02.attack,"bishop",mk02.pos,'b','bi04');
                bb02.src = mk02.src;
                bb02.ori_hp = mk02.hp;
                bb02.ori_attack = mk02.attack;
            
                $("#bi04").attr("src",mk02.src);
                $("#g"+mk02.pos).children('.bpsta').children('.p_hp').text(mk02.hp);
                //$("#g"+mk02.pos).children('.bpsta').children('.p_pro').text(mk02.pro);
                $("#g"+mk02.pos).children('.bpsta').children('.p_attack').text(mk02.attack);
                
                $("#bi04").click( function() {
                    if(grandc=="false"){
                        cid = "bi04";
                        cpi = bb02;
                        epass="true";
                    }
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'bi04' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', hero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[bb02.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = bb02.hp/bb02.ori_hp;
                            $("#ghp").text("HP:"+bb02.hp+"/"+bb02.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(bb02.hp>bb02.ori_hp){
                                    $(".gaze").width(100+"%");
                                }
                        }else{
                            $("#rival").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                bb02=null;
                $("#bi04").parent().children('.bpsta').remove();
                $("#bi04").remove();
           }
        
    });
    
    socket.on('set rook', function(med1,med2,youd1,youd2){
        
        var mk01 = JSON.parse(med1);
        var mk02 = JSON.parse(med2);
        var yk02 = JSON.parse(youd1);
        var yk01 = JSON.parse(youd2);
        //alert(aomg2.name);
        
        if(yk01!=null){
            
                var loppl01 = document.createElement('img');
                loppl01.setAttribute("id","lo01");
                loppl01.setAttribute("class","rok");
                document.getElementById("g1").appendChild(loppl01);

                var lopstad01 = document.createElement('div');
                lopstad01.setAttribute("class","rpsta");
                document.getElementById("g1").appendChild(lopstad01);

                var lop_atd01 = document.createElement('a');
                lop_atd01.setAttribute("class","p_attack");
                $("#g1").children(".rpsta").append(lop_atd01);
            
                var lop_prod01 = document.createElement('div');
                lop_prod01.setAttribute("class","p_pro");
                $("#g1").children(".rpsta").append(lop_prod01);
                var losrc = getpro_img('rook','r');
                $("#g1>.rpsta>.p_pro").css("background-image",'url('+losrc+')');

                var lop_hpd01 = document.createElement('a');
                lop_hpd01.setAttribute("class","p_hp");
                $("#g1").children(".rpsta").append(lop_hpd01);
            
                rl01 = Create(siro);
                rl01.setval(yk01.name,yk01.hp,yk01.attack,"rook",yk01.rpos,'r','lo01');
                rl01.src = yk01.src;
                rl01.ori_hp = yk01.hp;
                rl01.ori_attack = yk01.attack;
            
                $("#lo01").attr("src",yk01.src);
                $("#g"+rl01.pos).children('.rpsta').children('.p_hp').text(rl01.hp);
                //$("#g"+rl01.pos).children('.rpsta').children('.p_pro').text(rl01.pro);
                $("#g"+rl01.pos).children('.rpsta').children('.p_attack').text(rl01.attack);
            
                $("#lo01").click( function() {
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'lo01' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#rival").attr('src', hero);
                        $("#rival").attr('style', "opacity:1");
                        if(kan[rl01.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#hero").attr('style', "opacity:0");
                            $("#hhp").hide();
                            $("#rhp").show();
                            var rhp = rl01.hp/rl01.ori_hp;
                            $("#ghp2").text("HP:"+rl01.hp+"/"+rl01.ori_hp);
                            $(".gaze2").width(rhp*100+"%");
                            if(rl01.hp>rl01.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                        }else{
                            $("#hero").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                rl01=null;
                $("#lo01").parent().children('.rpsta').remove();
                $("#lo01").remove();
           }
        
        if(yk02!=null){
            
                var loppl02 = document.createElement('img');
                loppl02.setAttribute("id","lo02");
                loppl02.setAttribute("class","rok");
                document.getElementById("g8").appendChild(loppl02);

                var lopstad02 = document.createElement('div');
                lopstad02.setAttribute("class","rpsta");
                document.getElementById("g8").appendChild(lopstad02);

                var lop_atd02 = document.createElement('a');
                lop_atd02.setAttribute("class","p_attack");
                $("#g8").children(".rpsta").append(lop_atd02);
            
                var lop_prod02 = document.createElement('div');
                lop_prod02.setAttribute("class","p_pro");
                $("#g8").children(".rpsta").append(lop_prod02);
                var losrc2 = getpro_img('rook','r');
                $("#g8>.rpsta>.p_pro").css("background-image",'url('+losrc2+')');
            
                var lop_hpd02 = document.createElement('a');
                lop_hpd02.setAttribute("class","p_hp");
                $("#g8").children(".rpsta").append(lop_hpd02);
                
                rl02 = Create(siro);
                rl02.setval(yk02.name,yk02.hp,yk02.attack,"rook",yk02.rpos,'r','lo02');
                rl02.src = yk02.src;
                rl02.ori_hp = yk02.hp;
                rl02.ori_attack = yk02.attack;
                
                $("#lo02").attr("src",yk02.src);
                $("#g"+rl02.pos).children('.rpsta').children('.p_hp').text(rl02.hp);
                //$("#g"+rl02.pos).children('.rpsta').children('.p_pro').text(rl02.pro);
                $("#g"+rl02.pos).children('.rpsta').children('.p_attack').text(rl02.attack);
                
                $("#lo02").click( function() {
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'lo02' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#rival").attr('src', hero);
                        $("#rival").attr('style', "opacity:1");
                        if(kan[rl02.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#hero").attr('style', "opacity:0");
                            $("#hhp").hide();
                            $("#rhp").show();
                            var rhp = rl02.hp/rl02.ori_hp;
                            $("#ghp2").text("HP:"+rl02.hp+"/"+rl02.ori_hp);
                            $(".gaze2").width(rhp*100+"%");
                            if(rl02.hp>rl02.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                        }else{
                            $("#hero").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                yk02=null;
                $("#lo02").parent().children('.rpsta').remove();
                $("#lo02").remove();
           }
        
        if(mk01!=null){
            
                var loppl03 = document.createElement('img');
                loppl03.setAttribute("id","lo03");
                loppl03.setAttribute("class","rok");
                document.getElementById("g57").appendChild(loppl03);

                var lopstad03 = document.createElement('div');
                lopstad03.setAttribute("class","bpsta");
                document.getElementById("g57").appendChild(lopstad03);

                var lop_atd03 = document.createElement('a');
                lop_atd03.setAttribute("class","p_attack");
                $("#g57").children(".bpsta").append(lop_atd03);
            
                var lop_prod03 = document.createElement('div');
                lop_prod03.setAttribute("class","p_pro");
                $("#g57").children(".bpsta").append(lop_prod03);
                var losrc3 = getpro_img('rook','b');
                $("#g57>.bpsta>.p_pro").css("background-image",'url('+losrc3+')');
            
                var lop_hpd03 = document.createElement('a');
                lop_hpd03.setAttribute("class","p_hp");
                $("#g57").children(".bpsta").append(lop_hpd03);
            
                bl01 = Create(siro);
                bl01.setval(mk01.name,mk01.hp,mk01.attack,"rook",mk01.pos,'b','lo03');
                bl01.src = mk01.src;
                bl01.ori_hp = mk01.hp;
                bl01.ori_attack = mk01.attack;
                
                $("#lo03").attr("src",mk01.src);
                $("#g"+mk01.pos).children('.bpsta').children('.p_hp').text(mk01.hp);
                //$("#g"+mk01.pos).children('.bpsta').children('.p_pro').text(mk01.pro);
                $("#g"+mk01.pos).children('.bpsta').children('.p_attack').text(mk01.attack);
                
                $("#lo03").click( function() {
                    if(grandc=="false"){
                        cid = "lo03";
                        cpi = bl01;
                        epass="true";
                    }
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'lo03' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', hero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[bl01.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = bl01.hp/bl01.ori_hp;
                            $("#ghp").text("HP:"+bl01.hp+"/"+bl01.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(bl01.hp>bl01.ori_hp){
                                    $(".gaze").width(100+"%");
                                }
                        }else{
                            $("#rival").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                mk01=null;
                $("#lo03").parent().children('.bpsta').remove();
                $("#lo03").remove();
           }
        
        if(mk02!=null){
            
                var loppl04 = document.createElement('img');
                loppl04.setAttribute("id","lo04");
                loppl04.setAttribute("class","rok");
                document.getElementById("g64").appendChild(loppl04);

                var lopstad04 = document.createElement('div');
                lopstad04.setAttribute("class","bpsta");
                document.getElementById("g64").appendChild(lopstad04);

                var lop_atd04 = document.createElement('a');
                lop_atd04.setAttribute("class","p_attack");
                $("#g64").children(".bpsta").append(lop_atd04);
            
                var lop_prod04 = document.createElement('div');
                lop_prod04.setAttribute("class","p_pro");
                $("#g64").children(".bpsta").append(lop_prod04);
                var losrc4 = getpro_img('rook','b');
                $("#g64>.bpsta>.p_pro").css("background-image",'url('+losrc4+')');

                var lop_hpd04 = document.createElement('a');
                lop_hpd04.setAttribute("class","p_hp");
                $("#g64").children(".bpsta").append(lop_hpd04);
            
                bl02 = Create(siro);
                bl02.setval(mk02.name,mk02.hp,mk02.attack,"rook",mk02.pos,'b','lo04');
                bl02.src = mk02.src;
                bl02.ori_hp = mk02.hp;
                bl02.ori_attack = mk02.attack;
        
                $("#lo04").attr("src",mk02.src);
                $("#g"+mk02.pos).children('.bpsta').children('.p_hp').text(mk02.hp);
                //$("#g"+mk02.pos).children('.bpsta').children('.p_pro').text(mk02.pro);
                $("#g"+mk02.pos).children('.bpsta').children('.p_attack').text(mk02.attack);
                
                $("#lo04").click( function() {
                    if(grandc=="false"){
                        cid = "lo04";
                        cpi = bl02;
                        epass="true";
                    }
                    //alert(cpi.pro);
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'lo04' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', hero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[bl02.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = bl02.hp/bl02.ori_hp;
                            $("#ghp").text("HP:"+bl02.hp+"/"+bl02.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(bl02.hp>bl02.ori_hp){
                                    $(".gaze").width(100+"%");
                                }
                        }else{
                            $("#rival").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                mk02=null;
                $("#lo04").parent().children('.bpsta').remove();
                $("#lo04").remove();
           }
        
    });
    socket.on('set phone', function(med1,med2,med3,med4,med5,med6,med7,med8,youd1,youd2,youd3,youd4,youd5,youd6,youd7,youd8){
        
        var mk01 = JSON.parse(med1);
        var mk02 = JSON.parse(med2);
        var mk03 = JSON.parse(med3);
        var mk04 = JSON.parse(med4);
        var mk05 = JSON.parse(med5);
        var mk06 = JSON.parse(med6);
        var mk07 = JSON.parse(med7);
        var mk08 = JSON.parse(med8);
        
        var yk08 = JSON.parse(youd1);
        var yk07 = JSON.parse(youd2);
        var yk06 = JSON.parse(youd3);
        var yk05 = JSON.parse(youd4);
        var yk04 = JSON.parse(youd5);
        var yk03 = JSON.parse(youd6);
        var yk02 = JSON.parse(youd7);
        var yk01 = JSON.parse(youd8);
        //alert(aomg2.name);
        
        if(yk01!=null){
            
                var prppl01 = document.createElement('img');
                prppl01.setAttribute("id","p01");
                prppl01.setAttribute("class","pon");
                document.getElementById("g9").appendChild(prppl01);

                var prpstad01 = document.createElement('div');
                prpstad01.setAttribute("class","rpsta");
                document.getElementById("g9").appendChild(prpstad01);

                var prp_atd01 = document.createElement('a');
                prp_atd01.setAttribute("class","p_attack");
                $("#g9").children(".rpsta").append(prp_atd01);
            
                var prp_prod01 = document.createElement('div');
                prp_prod01.setAttribute("class","p_pro");
                $("#g9").children(".rpsta").append(prp_prod01);
                var phsrc = getpro_img('phone','r');
                $("#g9>.rpsta>.p_pro").css("background-image",'url('+phsrc+')');

                var prp_hpd01 = document.createElement('a');
                prp_hpd01.setAttribute("class","p_hp");
                $("#g9").children(".rpsta").append(prp_hpd01);
            
                rp01 = Create(siro);
                rp01.setval(yk01.name,yk01.hp,yk01.attack,"phone",yk01.rpos,'r','p01');
                rp01.src = yk01.src;
                rp01.ori_hp = yk01.hp;
                rp01.ori_attack = yk01.attack;
                
                $("#p01").attr("src",yk01.src);
                $("#g"+rp01.pos).children('.rpsta').children('.p_hp').text(rp01.hp);
                //$("#g"+rp01.pos).children('.rpsta').children('.p_pro').text(rp01.pro);
                $("#g"+rp01.pos).children('.rpsta').children('.p_attack').text(rp01.attack);
                
                $("#p01").click( function() {
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p01' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#rival").attr('src', hero);
                        $("#rival").attr('style', "opacity:1");
                        if(kan[rp01.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#hero").attr('style', "opacity:0");
                            $("#hhp").hide();
                            $("#rhp").show();
                            var rhp = rp01.hp/rp01.ori_hp;
                            $("#ghp2").text("HP:"+rp01.hp+"/"+rp01.ori_hp);
                            $(".gaze2").width(rhp*100+"%");
                            if(rp01.hp>rp01.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                        }else{
                            $("#hero").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                yk01=null;
                $("#p01").parent().children('.rpsta').remove();
                $("#p01").remove();
           }
        
        if(yk02!=null){
            
                var prppl02 = document.createElement('img');
                prppl02.setAttribute("id","p02");
                prppl02.setAttribute("class","pon");
                document.getElementById("g10").appendChild(prppl02);

                var prpstad02 = document.createElement('div');
                prpstad02.setAttribute("class","rpsta");
                document.getElementById("g10").appendChild(prpstad02);

                var prp_atd02 = document.createElement('a');
                prp_atd02.setAttribute("class","p_attack");
                $("#g10").children(".rpsta").append(prp_atd02);
            
                var prp_prod02 = document.createElement('div');
                prp_prod02.setAttribute("class","p_pro");
                $("#g10").children(".rpsta").append(prp_prod02);
                var phsrc2 = getpro_img('phone','r');
                $("#g10>.rpsta>.p_pro").css("background-image",'url('+phsrc2+')');

                var prp_hpd02 = document.createElement('a');
                prp_hpd02.setAttribute("class","p_hp");
                $("#g10").children(".rpsta").append(prp_hpd02);
            
                rp02 = Create(siro);
                rp02.setval(yk02.name,yk02.hp,yk02.attack,"phone",yk02.rpos,'r','p02');
                rp02.src = yk02.src;
                rp02.ori_hp = yk02.hp;
                rp02.ori_attack = yk02.attack;
            
                $("#p02").attr("src",yk02.src);
                $("#g"+rp02.pos).children('.rpsta').children('.p_hp').text(rp02.hp);
                //$("#g"+rp02.pos).children('.rpsta').children('.p_pro').text(rp02.pro);
                $("#g"+rp02.pos).children('.rpsta').children('.p_attack').text(rp02.attack);
                
                $("#p02").click( function() {
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p02' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#rival").attr('src', hero);
                        $("#rival").attr('style', "opacity:1");
                        if(kan[rp02.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#hero").attr('style', "opacity:0");
                            $("#hhp").hide();
                            $("#rhp").show();
                            var rhp = rp02.hp/rp02.ori_hp;
                            $("#ghp2").text("HP:"+rp02.hp+"/"+rp02.ori_hp);
                            $(".gaze2").width(rhp*100+"%");
                            if(rp02.hp>rp02.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                        }else{
                            $("#hero").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                rp02=null;
                $("#p02").parent().children('.rpsta').remove();
                $("#p02").remove();
           }
        
        if(yk03!=null){
            
                var prppl03 = document.createElement('img');
                prppl03.setAttribute("id","p03");
                prppl03.setAttribute("class","pon");
                document.getElementById("g11").appendChild(prppl03);

                var prpstad03 = document.createElement('div');
                prpstad03.setAttribute("class","rpsta");
                document.getElementById("g11").appendChild(prpstad03);

                var prp_atd03 = document.createElement('a');
                prp_atd03.setAttribute("class","p_attack");
                $("#g11").children(".rpsta").append(prp_atd03);
            
                var prp_prod03 = document.createElement('div');
                prp_prod03.setAttribute("class","p_pro");
                $("#g11").children(".rpsta").append(prp_prod03);
                var phsrc3 = getpro_img('phone','r');
                $("#g11>.rpsta>.p_pro").css("background-image",'url('+phsrc3+')');

                var prp_hpd03 = document.createElement('a');
                prp_hpd03.setAttribute("class","p_hp");
                $("#g11").children(".rpsta").append(prp_hpd03);
            
                rp03 = Create(siro);
                rp03.setval(yk03.name,yk03.hp,yk03.attack,"phone",yk03.rpos,'r','p03');
                rp03.src = yk03.src;
                rp03.ori_hp = yk03.hp;
                rp03.ori_attack = yk03.attack; 
            
                $("#p03").attr("src",yk03.src);
                $("#g"+rp03.pos).children('.rpsta').children('.p_hp').text(rp03.hp);
                //$("#g"+rp03.pos).children('.rpsta').children('.p_pro').text(rp03.pro);
                $("#g"+rp03.pos).children('.rpsta').children('.p_attack').text(rp03.attack);
            
                $("#p03").click( function() {
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p03' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#rival").attr('src', hero);
                        $("#rival").attr('style', "opacity:1");
                        if(kan[rp03.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#hero").attr('style', "opacity:0");
                            $("#hhp").hide();
                            $("#rhp").show();
                            var rhp = rp03.hp/rp03.ori_hp;
                            $("#ghp2").text("HP:"+rp03.hp+"/"+rp03.ori_hp);
                            $(".gaze2").width(rhp*100+"%");
                            if(rp03.hp>rp03.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                        }else{
                            $("#hero").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                yk03=null;
                $("#p03").parent().children('.rpsta').remove();
                $("#p03").remove();
           }
            
        if(yk04!=null){
            
                var prppl04 = document.createElement('img');
                prppl04.setAttribute("id","p04");
                prppl04.setAttribute("class","pon");
                document.getElementById("g12").appendChild(prppl04);

                var prpstad04 = document.createElement('div');
                prpstad04.setAttribute("class","rpsta");
                document.getElementById("g12").appendChild(prpstad04);

                var prp_atd04 = document.createElement('a');
                prp_atd04.setAttribute("class","p_attack");
                $("#g12").children(".rpsta").append(prp_atd04);
            
                var prp_prod04 = document.createElement('div');
                prp_prod04.setAttribute("class","p_pro");
                $("#g12").children(".rpsta").append(prp_prod04);
                var phsrc4 = getpro_img('phone','r');
                $("#g12>.rpsta>.p_pro").css("background-image",'url('+phsrc4+')');

                var prp_hpd04 = document.createElement('a');
                prp_hpd04.setAttribute("class","p_hp");
                $("#g12").children(".rpsta").append(prp_hpd04);
            
                rp04 = Create(siro);
                rp04.setval(yk04.name,yk04.hp,yk04.attack,"phone",yk04.rpos,'r','p04');
                rp04.src = yk04.src;
                rp04.ori_hp = yk04.hp;
                rp04.ori_attack = yk04.attack;
                
                $("#p04").attr("src",yk04.src);
                $("#g"+rp04.pos).children('.rpsta').children('.p_hp').text(rp04.hp);
                //$("#g"+rp04.pos).children('.rpsta').children('.p_pro').text(rp04.pro);
                $("#g"+rp04.pos).children('.rpsta').children('.p_attack').text(rp04.attack);
                
                $("#p04").click( function() {
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p04' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#rival").attr('src', hero);
                        $("#rival").attr('style', "opacity:1");
                        if(kan[rp04.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#hero").attr('style', "opacity:0");
                            $("#hhp").hide();
                            $("#rhp").show();
                            var rhp = rp04.hp/rp04.ori_hp;
                            $("#ghp2").text("HP:"+rp04.hp+"/"+rp04.ori_hp);
                            $(".gaze2").width(rhp*100+"%");
                            if(rp04.hp>rp04.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                        }else{
                            $("#hero").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                yk04=null;
                $("#p04").parent().children('.rpsta').remove();
                $("#p04").remove();
           }
            
       if(yk05!=null){
           
                var prppl05 = document.createElement('img');
                prppl05.setAttribute("id","p05");
                prppl05.setAttribute("class","pon");
                document.getElementById("g13").appendChild(prppl05);

                var prpstad05 = document.createElement('div');
                prpstad05.setAttribute("class","rpsta");
                document.getElementById("g13").appendChild(prpstad05);

                var prp_atd05 = document.createElement('a');
                prp_atd05.setAttribute("class","p_attack");
                $("#g13").children(".rpsta").append(prp_atd05);
           
                var prp_prod05 = document.createElement('div');
                prp_prod05.setAttribute("class","p_pro");
                $("#g13").children(".rpsta").append(prp_prod05);
                var phsrc5 = getpro_img('phone','r');
                $("#g13>.rpsta>.p_pro").css("background-image",'url('+phsrc5+')');

                var prp_hpd05 = document.createElement('a');
                prp_hpd05.setAttribute("class","p_hp");
                $("#g13").children(".rpsta").append(prp_hpd05);
           
                rp05 = Create(siro);
                rp05.setval(yk05.name,yk05.hp,yk05.attack,"phone",yk05.rpos,'r','p05');
                rp05.src = yk05.src; 
                rp05.ori_hp = yk05.hp;
                rp05.ori_attack = yk05.attack;
                
                $("#p05").attr("src",yk05.src);
                $("#g"+rp05.pos).children('.rpsta').children('.p_hp').text(rp05.hp);
                //$("#g"+rp05.pos).children('.rpsta').children('.p_pro').text(rp05.pro);
                $("#g"+rp05.pos).children('.rpsta').children('.p_attack').text(rp05.attack);
           
                $("#p05").click( function() {
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p05' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#rival").attr('src', hero);
                        $("#rival").attr('style', "opacity:1");
                        if(kan[rp05.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#hero").attr('style', "opacity:0");
                            $("#hhp").hide();
                            $("#rhp").show();
                            var rhp = rp05.hp/rp05.ori_hp;
                            $("#ghp2").text("HP:"+rp05.hp+"/"+rp05.ori_hp);
                            $(".gaze2").width(rhp*100+"%");
                            if(rp05.hp>rp05.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                        }else{
                            $("#hero").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
          }else{
                yk05=null;
                $("#p05").parent().children('.rpsta').remove();
                $("#p05").remove();
          } 
           
        if(yk06!=null){
            
                var prppl06 = document.createElement('img');
                prppl06.setAttribute("id","p06");
                prppl06.setAttribute("class","pon");
                document.getElementById("g14").appendChild(prppl06);

                var prpstad06 = document.createElement('div');
                prpstad06.setAttribute("class","rpsta");
                document.getElementById("g14").appendChild(prpstad06);

                var prp_atd06 = document.createElement('a');
                prp_atd06.setAttribute("class","p_attack");
                $("#g14").children(".rpsta").append(prp_atd06);
            
                var prp_prod06 = document.createElement('div');
                prp_prod06.setAttribute("class","p_pro");
                $("#g14").children(".rpsta").append(prp_prod06);
                var phsrc6 = getpro_img('phone','r');
                $("#g14>.rpsta>.p_pro").css("background-image",'url('+phsrc6+')');

                var prp_hpd06 = document.createElement('a');
                prp_hpd06.setAttribute("class","p_hp");
                $("#g14").children(".rpsta").append(prp_hpd06);
            
                rp06 = Create(siro);
                rp06.setval(yk06.name,yk06.hp,yk06.attack,"phone",yk06.rpos,'r','p06');
                rp06.src = yk06.src;
                rp06.ori_hp = yk06.hp;
                rp06.ori_attack = yk06.attack;
            
                $("#p06").attr("src",yk06.src);
                $("#g"+rp06.pos).children('.rpsta').children('.p_hp').text(rp06.hp);
                //$("#g"+rp06.pos).children('.rpsta').children('.p_pro').text(rp06.pro);
                $("#g"+rp06.pos).children('.rpsta').children('.p_attack').text(rp06.attack);
            
                $("#p06").click( function() {
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p06' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#rival").attr('src', hero);
                        $("#rival").attr('style', "opacity:1");
                        if(kan[rp06.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#hero").attr('style', "opacity:0");
                            $("#hhp").hide();
                            $("#rhp").show();
                            var rhp = rp06.hp/rp06.ori_hp;
                            $("#ghp2").text("HP:"+rp06.hp+"/"+rp06.ori_hp);
                            $(".gaze2").width(rhp*100+"%");
                            if(rp06.hp>rp06.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                        }else{
                            $("#hero").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                yk06=null;
                $("#p06").parent().children('.rpsta').remove();
                $("#p06").remove();
           }
        
        if(yk07!=null){
            
                var prppl07 = document.createElement('img');
                prppl07.setAttribute("id","p07");
                prppl07.setAttribute("class","pon");
                document.getElementById("g15").appendChild(prppl07);

                var prpstad07 = document.createElement('div');
                prpstad07.setAttribute("class","rpsta");
                document.getElementById("g15").appendChild(prpstad07);

                var prp_atd07 = document.createElement('a');
                prp_atd07.setAttribute("class","p_attack");
                $("#g15").children(".rpsta").append(prp_atd07);
            
                var prp_prod07 = document.createElement('div');
                prp_prod07.setAttribute("class","p_pro");
                $("#g15").children(".rpsta").append(prp_prod07);
                var phsrc7 = getpro_img('phone','r');
                $("#g15>.rpsta>.p_pro").css("background-image",'url('+phsrc7+')');

                var prp_hpd07 = document.createElement('a');
                prp_hpd07.setAttribute("class","p_hp");
                $("#g15").children(".rpsta").append(prp_hpd07);
            
                rp07 = Create(siro);
                rp07.setval(yk07.name,yk07.hp,yk07.attack,"phone",yk07.rpos,'r','p07');
                rp07.src = yk07.src;
                rp07.ori_hp = yk07.hp;
                rp07.ori_attack = yk07.attack;
                
                $("#p07").attr("src",yk07.src);
                $("#g"+rp07.pos).children('.rpsta').children('.p_hp').text(rp07.hp);
                //$("#g"+rp07.pos).children('.rpsta').children('.p_pro').text(rp07.pro);
                $("#g"+rp07.pos).children('.rpsta').children('.p_attack').text(rp07.attack);
                
                $("#p07").click( function() {
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p07' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#rival").attr('src', hero);
                        $("#rival").attr('style', "opacity:1");
                        if(kan[rp07.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#hero").attr('style', "opacity:0");
                            $("#hhp").hide();
                            $("#rhp").show();
                            var rhp = rp07.hp/rp07.ori_hp;
                            $("#ghp2").text("HP:"+rp07.hp+"/"+rp07.ori_hp);
                            $(".gaze2").width(rhp*100+"%");
                            if(rp07.hp>rp07.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                        }else{
                            $("#hero").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                yk07=null;
                $("#p07").parent().children('.rpsta').remove();
                $("#p07").remove();
           }
        
        if(yk08!=null){
            
                var prppl08 = document.createElement('img');
                prppl08.setAttribute("id","p08");
                prppl08.setAttribute("class","pon");
                document.getElementById("g16").appendChild(prppl08);

                var prpstad08 = document.createElement('div');
                prpstad08.setAttribute("class","rpsta");
                document.getElementById("g16").appendChild(prpstad08);

                var prp_atd08 = document.createElement('a');
                prp_atd08.setAttribute("class","p_attack");
                $("#g16").children(".rpsta").append(prp_atd08);
            
                var prp_prod08 = document.createElement('div');
                prp_prod08.setAttribute("class","p_pro");
                $("#g16").children(".rpsta").append(prp_prod08);
                var phsrc8 = getpro_img('phone','r');
                $("#g16>.rpsta>.p_pro").css("background-image",'url('+phsrc8+')');

                var prp_hpd08 = document.createElement('a');
                prp_hpd08.setAttribute("class","p_hp");
                $("#g16").children(".rpsta").append(prp_hpd08);
            
                rp08 = Create(siro);
                rp08.setval(yk08.name,yk08.hp,yk08.attack,"phone",yk08.rpos,'r','p08');
                rp08.src = yk08.src;
                rp08.ori_hp = yk08.hp;
                rp08.ori_attack = yk08.attack;
        
                $("#p08").attr("src",yk08.src);
                $("#g"+rp08.pos).children('.rpsta').children('.p_hp').text(rp08.hp);
                //$("#g"+rp08.pos).children('.rpsta').children('.p_pro').text(rp08.pro);
                $("#g"+rp08.pos).children('.rpsta').children('.p_attack').text(rp08.attack);
        
                $("#p08").click( function() {
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p08' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#rival").attr('src', hero);
                        $("#rival").attr('style', "opacity:1");
                        if(kan[rp08.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#hero").attr('style', "opacity:0");
                            $("#hhp").hide();
                            $("#rhp").show();
                            var rhp = rp08.hp/rp08.ori_hp;
                            $("#ghp2").text("HP:"+rp08.hp+"/"+rp08.ori_hp);
                            $(".gaze2").width(rhp*100+"%");
                            if(rp08.hp>rp08.ori_hp){
                                    $(".gaze2").width(100+"%");
                                }
                        }else{
                            $("#hero").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                yk08=null;
                $("#p08").parent().children('.rpsta').remove();
                $("#p08").remove();
           }
        
        if(mk01!=null){
            
                var pbppl01 = document.createElement('img');
                pbppl01.setAttribute("id","p1");
                pbppl01.setAttribute("class","pon");
                document.getElementById("g49").appendChild(pbppl01);

                var pbpstad01 = document.createElement('div');
                pbpstad01.setAttribute("class","bpsta");
                document.getElementById("g49").appendChild(pbpstad01);

                var pbp_atd01 = document.createElement('a');
                pbp_atd01.setAttribute("class","p_attack");
                $("#g49").children(".bpsta").append(pbp_atd01);
            
                var pbp_prod01 = document.createElement('div');
                pbp_prod01.setAttribute("class","p_pro");
                $("#g49").children(".bpsta").append(pbp_prod01);
                var pasrc = getpro_img('phone','b');
                $("#g49>.bpsta>.p_pro").css("background-image",'url('+pasrc+')');

                var pbp_hpd01 = document.createElement('a');
                pbp_hpd01.setAttribute("class","p_hp");
                $("#g49").children(".bpsta").append(pbp_hpd01);
            
                bp01 = Create(siro);
                bp01.setval(mk01.name,mk01.hp,mk01.attack,"phone",mk01.pos,'b','p1');
                bp01.src = mk01.src;
                bp01.ori_hp = mk01.hp;
                bp01.ori_attack = mk01.attack;
            
                $("#p1").attr("src",mk01.src);
                $("#g"+mk01.pos).children('.bpsta').children('.p_hp').text(mk01.hp);
                //$("#g"+mk01.pos).children('.bpsta').children('.p_pro').text(mk01.pro);
                $("#g"+mk01.pos).children('.bpsta').children('.p_attack').text(mk01.attack);
                
                $("#p1").click( function() {
                    //var bp01 = bp01;
                    if(grandc=="false"){
                        cid = "p1";
                        cpi = bp01;
                        epass="true";
                    }
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p1' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', hero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[bp01.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = bp01.hp/bp01.ori_hp;
                            $("#ghp").text("HP:"+bp01.hp+"/"+bp01.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(bp01.hp>bp01.ori_hp){
                                    $(".gaze").width(100+"%");
                                }
                        }else{
                            $("#rival").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                mk01=null;
                $("#p1").parent().children('.bpsta').remove();
                $("#p1").remove();
           }
            
        if(mk02!=null){
            
                var pbppl02 = document.createElement('img');
                pbppl02.setAttribute("id","p2");
                pbppl02.setAttribute("class","pon");
                document.getElementById("g50").appendChild(pbppl02);

                var pbpstad02 = document.createElement('div');
                pbpstad02.setAttribute("class","bpsta");
                document.getElementById("g50").appendChild(pbpstad02);

                var pbp_atd02 = document.createElement('a');
                pbp_atd02.setAttribute("class","p_attack");
                $("#g50").children(".bpsta").append(pbp_atd02);
            
                var pbp_prod02 = document.createElement('div');
                pbp_prod02.setAttribute("class","p_pro");
                $("#g50").children(".bpsta").append(pbp_prod02);
                var pasrc2 = getpro_img('phone','b');
                $("#g50>.bpsta>.p_pro").css("background-image",'url('+pasrc2+')');

                var pbp_hpd02 = document.createElement('a');
                pbp_hpd02.setAttribute("class","p_hp");
                $("#g50").children(".bpsta").append(pbp_hpd02);
            
                bp02 = Create(siro);
                bp02.setval(mk02.name,mk02.hp,mk02.attack,"phone",mk02.pos,'b','p2');
                bp02.src = mk02.src;
                bp02.ori_hp = mk02.hp;
                bp02.ori_attack = mk02.attack;
                
                $("#p2").attr("src",mk02.src);
                $("#g"+mk02.pos).children('.bpsta').children('.p_hp').text(mk02.hp);
                //$("#g"+mk02.pos).children('.bpsta').children('.p_pro').text(mk02.pro);
                $("#g"+mk02.pos).children('.bpsta').children('.p_attack').text(mk02.attack);
        
                $("#p2").click( function() {
                    if(grandc=="false"){
                        cid = "p2";
                        cpi = bp02;
                        epass="true";
                    }
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p2' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', hero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[bp02.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = bp02.hp/bp02.ori_hp;
                            $("#ghp").text("HP:"+bp02.hp+"/"+bp02.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(bp02.hp>bp02.ori_hp){
                                    $(".gaze").width(100+"%");
                                }
                        }else{
                            $("#rival").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                mk02=null;
                $("#p2").parent().children('.bpsta').remove();
                $("#p2").remove();
           }
        
        if(mk03!=null){
            
                var pbppl03 = document.createElement('img');
                pbppl03.setAttribute("id","p3");
                pbppl03.setAttribute("class","pon");
                document.getElementById("g51").appendChild(pbppl03);

                var pbpstad03 = document.createElement('div');
                pbpstad03.setAttribute("class","bpsta");
                document.getElementById("g51").appendChild(pbpstad03);

                var pbp_atd03 = document.createElement('a');
                pbp_atd03.setAttribute("class","p_attack");
                $("#g51").children(".bpsta").append(pbp_atd03);
            
                var pbp_prod03 = document.createElement('div');
                pbp_prod03.setAttribute("class","p_pro");
                $("#g51").children(".bpsta").append(pbp_prod03);
                var pasrc3 = getpro_img('phone','b');
                $("#g51>.bpsta>.p_pro").css("background-image",'url('+pasrc3+')');

                var pbp_hpd03 = document.createElement('a');
                pbp_hpd03.setAttribute("class","p_hp");
                $("#g51").children(".bpsta").append(pbp_hpd03);
            
                bp03 = Create(siro);
                bp03.setval(mk03.name,mk03.hp,mk03.attack,"phone",mk03.pos,'b','p3');
                bp03.src = mk03.src;
                bp03.ori_hp = mk03.hp;
                bp03.ori_attack = mk03.attack;
                
                $("#p3").attr("src",mk03.src);
                $("#g"+mk03.pos).children('.bpsta').children('.p_hp').text(mk03.hp);
                //$("#g"+mk03.pos).children('.bpsta').children('.p_pro').text(mk03.pro);
                $("#g"+mk03.pos).children('.bpsta').children('.p_attack').text(mk03.attack);
                
                $("#p3").click( function() {
                    if(grandc=="false"){
                        cid = "p3";
                        cpi = bp03;
                        epass="true";
                    }
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p3' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', hero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[bp03.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = bp03.hp/bp03.ori_hp;
                            $("#ghp").text("HP:"+bp03.hp+"/"+bp03.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(bp03.hp>bp03.ori_hp){
                                    $(".gaze").width(100+"%");
                                }
                        }else{
                            $("#rival").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                mk03=null;
                $("#p3").parent().children('.bpsta').remove();
                $("#p3").remove();
           }
        
        if(mk04!=null){
            
                var pbppl04 = document.createElement('img');
                pbppl04.setAttribute("id","p4");
                pbppl04.setAttribute("class","pon");
                document.getElementById("g52").appendChild(pbppl04);

                var pbpstad04 = document.createElement('div');
                pbpstad04.setAttribute("class","bpsta");
                document.getElementById("g52").appendChild(pbpstad04);

                var pbp_atd04 = document.createElement('a');
                pbp_atd04.setAttribute("class","p_attack");
                $("#g52").children(".bpsta").append(pbp_atd04);
            
                var pbp_prod04 = document.createElement('div');
                pbp_prod04.setAttribute("class","p_pro");
                $("#g52").children(".bpsta").append(pbp_prod04);
                var pasrc4 = getpro_img('phone','b');
                $("#g52>.bpsta>.p_pro").css("background-image",'url('+pasrc4+')');

                var pbp_hpd04 = document.createElement('a');
                pbp_hpd04.setAttribute("class","p_hp");
                $("#g52").children(".bpsta").append(pbp_hpd04);
            
                bp04 = Create(siro);
                bp04.setval(mk04.name,mk04.hp,mk04.attack,"phone",mk04.pos,'b','p4');
                bp04.src = mk04.src;
                bp04.ori_hp = mk04.hp;
                bp04.ori_attack = mk04.attack;
        
                $("#p4").attr("src",mk04.src);
                $("#g"+mk04.pos).children('.bpsta').children('.p_hp').text(mk04.hp);
                //$("#g"+mk04.pos).children('.bpsta').children('.p_pro').text(mk04.pro);
                $("#g"+mk04.pos).children('.bpsta').children('.p_attack').text(mk04.attack);
            
                $("#p4").click( function() {
                    if(grandc=="false"){
                        cid = "p4";
                        cpi = bp04;
                        epass="true";
                    }
                    //alert(bp04.pos);
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p4' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', hero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[bp04.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = bp04.hp/bp04.ori_hp;
                            $("#ghp").text("HP:"+bp04.hp+"/"+bp04.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(bp04.hp>bp04.ori_hp){
                                    $(".gaze").width(100+"%");
                                }
                        }else{
                            $("#rival").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                mk04=null;
                $("#p4").parent().children('.bpsta').remove();
                $("#p4").remove();
           }
        
        if(mk05!=null){
            
                var pbppl05 = document.createElement('img');
                pbppl05.setAttribute("id","p5");
                pbppl05.setAttribute("class","pon");
                document.getElementById("g53").appendChild(pbppl05);

                var pbpstad05 = document.createElement('div');
                pbpstad05.setAttribute("class","bpsta");
                document.getElementById("g53").appendChild(pbpstad05);

                var pbp_atd05 = document.createElement('a');
                pbp_atd05.setAttribute("class","p_attack");
                $("#g53").children(".bpsta").append(pbp_atd05);
            
                var pbp_prod05 = document.createElement('div');
                pbp_prod05.setAttribute("class","p_pro");
                $("#g53").children(".bpsta").append(pbp_prod05);
                var pasrc5 = getpro_img('phone','b');
                $("#g53>.bpsta>.p_pro").css("background-image",'url('+pasrc5+')');

                var pbp_hpd05 = document.createElement('a');
                pbp_hpd05.setAttribute("class","p_hp");
                $("#g53").children(".bpsta").append(pbp_hpd05);
            
                bp05 = Create(siro);
                bp05.setval(mk05.name,mk05.hp,mk05.attack,"phone",mk05.pos,'b','p5');
                bp05.src = mk05.src;
                bp05.ori_hp = mk05.hp;
                bp05.ori_attack = mk05.attack;
            
                $("#p5").attr("src",mk05.src);
                $("#g"+mk05.pos).children('.bpsta').children('.p_hp').text(mk05.hp);
                //$("#g"+mk05.pos).children('.bpsta').children('.p_pro').text(mk05.pro);
                $("#g"+mk05.pos).children('.bpsta').children('.p_attack').text(mk05.attack);
            
                $("#p5").click( function() {
                    if(grandc=="false"){
                        cid = "p5";
                        cpi = bp05;
                        epass="true";
                    }
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p5' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', hero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[bp05.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = bp05.hp/bp05.ori_hp;
                            $("#ghp").text("HP:"+bp05.hp+"/"+bp05.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(bp05.hp>bp05.ori_hp){
                                    $(".gaze").width(100+"%");
                                }
                        }else{
                            $("#rival").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
               mk05=null;
               $("#p5").parent().children('.bpsta').remove();
               $("#p5").remove();
           }
        
        if(mk06!=null){
            
                var pbppl06 = document.createElement('img');
                pbppl06.setAttribute("id","p6");
                pbppl06.setAttribute("class","pon");
                document.getElementById("g54").appendChild(pbppl06);

                var pbpstad06 = document.createElement('div');
                pbpstad06.setAttribute("class","bpsta");
                document.getElementById("g54").appendChild(pbpstad06);

                var pbp_atd06 = document.createElement('a');
                pbp_atd06.setAttribute("class","p_attack");
                $("#g54").children(".bpsta").append(pbp_atd06);
            
                var pbp_prod06 = document.createElement('div');
                pbp_prod06.setAttribute("class","p_pro");
                $("#g54").children(".bpsta").append(pbp_prod06);
                var pasrc6 = getpro_img('phone','b');
                $("#g54>.bpsta>.p_pro").css("background-image",'url('+pasrc6+')');

                var pbp_hpd06 = document.createElement('a');
                pbp_hpd06.setAttribute("class","p_hp");
                $("#g54").children(".bpsta").append(pbp_hpd06);
            
                bp06 = Create(siro);
                bp06.setval(mk06.name,mk06.hp,mk06.attack,"phone",mk06.pos,'b','p6');
                bp06.src = mk06.src;
                bp06.ori_hp = mk06.hp;
                bp06.ori_attack = mk06.attack;
        
                $("#p6").attr("src",mk06.src);
                $("#g"+mk06.pos).children('.bpsta').children('.p_hp').text(mk06.hp);
                //$("#g"+mk06.pos).children('.bpsta').children('.p_pro').text(mk06.pro);
                $("#g"+mk06.pos).children('.bpsta').children('.p_attack').text(mk06.attack);
            
                $("#p6").click( function() {
                    if(grandc=="false"){
                        cid = "p6";
                        cpi = bp06;
                        epass="true";
                    }
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p6' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', hero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[bp06.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = bp06.hp/bp06.ori_hp;
                            $("#ghp").text("HP:"+bp06.hp+"/"+bp06.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(bp06.hp>bp06.ori_hp){
                                    $(".gaze").width(100+"%");
                                }
                        }else{
                            $("#rival").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                mk06=null;
                $("#p6").parent().children('.bpsta').remove();
                $("#p6").remove();
           }
        
        if(mk07!=null){
            
                var pbppl07 = document.createElement('img');
                pbppl07.setAttribute("id","p7");
                pbppl07.setAttribute("class","pon");
                document.getElementById("g55").appendChild(pbppl07);

                var pbpstad07 = document.createElement('div');
                pbpstad07.setAttribute("class","bpsta");
                document.getElementById("g55").appendChild(pbpstad07);

                var pbp_atd07 = document.createElement('a');
                pbp_atd07.setAttribute("class","p_attack");
                $("#g55").children(".bpsta").append(pbp_atd07);
            
                var pbp_prod07 = document.createElement('div');
                pbp_prod07.setAttribute("class","p_pro");
                $("#g55").children(".bpsta").append(pbp_prod07);
                var pasrc7 = getpro_img('phone','b');
                $("#g55>.bpsta>.p_pro").css("background-image",'url('+pasrc7+')');

                var pbp_hpd07 = document.createElement('a');
                pbp_hpd07.setAttribute("class","p_hp");
                $("#g55").children(".bpsta").append(pbp_hpd07);
            
                bp07 = Create(siro);
                bp07.setval(mk07.name,mk07.hp,mk07.attack,"phone",mk07.pos,'b','p7');
                bp07.src = mk07.src;
                bp07.ori_hp = mk07.hp;
                bp07.ori_attack = mk07.attack;
        
                $("#p7").attr("src",mk07.src);
                $("#g"+mk07.pos).children('.bpsta').children('.p_hp').text(mk07.hp);
                //$("#g"+mk07.pos).children('.bpsta').children('.p_pro').text(mk07.pro);
                $("#g"+mk07.pos).children('.bpsta').children('.p_attack').text(mk07.attack);
            
                $("#p7").click( function() {
                    if(grandc=="false"){
                        cid = "p7";
                        cpi = bp07;
                        epass="true";
                    }
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p7' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', hero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[bp07.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = bp07.hp/bp07.ori_hp;
                            $("#ghp").text("HP:"+bp07.hp+"/"+bp07.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(bp07.hp>bp07.ori_hp){
                                    $(".gaze").width(100+"%");
                                }
                        }else{
                            $("#rival").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
               mk07=null;
               $("#p7").parent().children('.bpsta').remove();
               $("#p7").remove();
           }
        
        if(mk08!=null){
            
                var pbppl08 = document.createElement('img');
                pbppl08.setAttribute("id","p8");
                pbppl08.setAttribute("class","pon");
                document.getElementById("g56").appendChild(pbppl08);

                var pbpstad08 = document.createElement('div');
                pbpstad08.setAttribute("class","bpsta");
                document.getElementById("g56").appendChild(pbpstad08);

                var pbp_atd08 = document.createElement('a');
                pbp_atd08.setAttribute("class","p_attack");
                $("#g56").children(".bpsta").append(pbp_atd08);
            
                var pbp_prod08 = document.createElement('div');
                pbp_prod08.setAttribute("class","p_pro"); 
                $("#g56").children(".bpsta").append(pbp_prod08);
                var pasrc8 = getpro_img('phone','b');
                $("#g56>.bpsta>.p_pro").css("background-image",'url('+pasrc8+')');

                var pbp_hpd08 = document.createElement('a');
                pbp_hpd08.setAttribute("class","p_hp");
                $("#g56").children(".bpsta").append(pbp_hpd08);
            
                bp08 = Create(siro);
                bp08.setval(mk08.name,mk08.hp,mk08.attack,"phone",mk08.pos,'b','p8');
                bp08.src = mk08.src;
                bp08.ori_hp = mk08.hp;
                bp08.ori_attack = mk08.attack;
                
                $("#p8").attr("src",mk08.src); 
                $("#g"+mk08.pos).children('.bpsta').children('.p_hp').text(mk08.hp);
                //$("#g"+mk08.pos).children('.bpsta').children('.p_pro').text(mk08.pro);
                $("#g"+mk08.pos).children('.bpsta').children('.p_attack').text(mk08.attack);
                
                $("#p8").click( function() {
                    if(grandc=="false"){
                        cid = "p8";
                        cpi = bp08;
                        epass="true";
                    }
                    if(swit=="true"){
                        var offset = $("#uptown").offset();
                        $('html, body').animate({scrollTop : offset.top}, 300);
                        var hero = document.getElementById( 'p8' ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', hero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[bp08.pos-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = bp08.hp/bp08.ori_hp;
                            $("#ghp").text("HP:"+bp08.hp+"/"+bp08.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(bp08.hp>bp08.ori_hp){
                                    $(".gaze").width(100+"%");
                                }
                        }else{
                            $("#rival").attr('style', "opacity:1");
                        }
                    }else{
                        $('#cutton').css('display','none');
                        swit="true";
                    }
			});
           }else{
                mk08=null;
                $("#p8").parent().children('.bpsta').remove();
                $("#p8").remove();
           }
        
        socket.emit('ready game', mesd, yousd);
    });
    
   socket.on('set gameid', function(me,you){
       mesd = me;
       yousd = you;
       isgame="true";
   });
   socket.on('hero sturn', function(sn){
        var hasn = 64-sn+1;
        kan[hasn-1].sturn="true";
        kan[hasn-1].sturn_count=2;
        var cstad3 = document.createElement('div');
        cstad3.setAttribute("class","sturn");
        document.getElementById('g'+hasn).appendChild(cstad3);
    }); 
    
    
    socket.on('hero sturn', function(sn){
        var hasn = 64-sn+1;
        kan[hasn-1].sturn="true";
        kan[hasn-1].sturn_count=2;
        
        var cstad3 = document.createElement('div');
        cstad3.setAttribute("class","sturn");
        document.getElementById('g'+hasn).appendChild(cstad3);
    });
    socket.on('hero trap_sturn', function(sn){
        var hasn = 64-sn+1;
        kan[hasn-1].sturn="true";
        kan[hasn-1].sturn_count=2;
        kan[hasn-1].btrap="false";
        kan[hasn-1].bstrap=null;
        $("#g"+hasn).css("background-color","rgba(102,102,102,0.9)");
        $("#g"+hasn).hover(function(){
            $(this).css("background-color","yellow");
        },function(){
            $(this).css("background-color","rgba(102,102,102,0.9)");
        });
        var cstad3 = document.createElement('div');
        cstad3.setAttribute("class","sturn");
        document.getElementById('g'+hasn).appendChild(cstad3);
    });
    
    socket.on('set rival', function(place,msn){
        var rivalp;
        var rivalid;
        var rsn = 64-msn+1;
        var gsn = 64-place+1;
        rivalp = kan[gsn-1].rhero;
        rivalid = kan[gsn-1].rhero.id;
        
        var npos = rivalp.pos;
        kan[rsn-1].rhero = rivalp;
        
        var rpl = document.createElement('img');
        rpl.setAttribute("id",rivalid);
        rpl.setAttribute("src",rivalp.src);
					
        $("#"+rivalid).remove();
        var rl_id= "g"+rsn;
        document.getElementById(rl_id).appendChild(rpl);
        
        var mid=rivalid;
        var rhp;
        $("#g"+rivalp.pos).children('.rpsta').remove();
					
        var pstad = document.createElement('div');
        pstad.setAttribute("class","rpsta");
        document.getElementById(rl_id).appendChild(pstad);
        var pl_id = $("#g"+rsn).children('.rpsta');
        var p_hpd = document.createElement('a');
        p_hpd.setAttribute("class","p_hp");
        var p_text = document.createTextNode(''+rivalp.hp);
        p_hpd.appendChild( p_text );
        pl_id.append(p_hpd);
        var p_prod = document.createElement('div');
        p_prod.setAttribute("class","p_pro");
        pl_id.append(p_prod);
        var psrc = getpro_img(kan[gsn-1].rhero.pro,'r');
        $("#g"+rsn+">.rpsta>.p_pro").css("background-image",'url('+psrc+')');
        var p_atd = document.createElement('a');
        p_atd.setAttribute("class","p_attack");
        var p_text3 = document.createTextNode(''+rivalp.attack); 
        p_atd.appendChild( p_text3 );
        pl_id.append(p_atd);
        
        var rpsta = $("#g"+rsn).children('.rpsta');
        
        kan[rsn-1].count+=10;
        $("#"+rivalid).click( function() {
            
							if(swit=="true"){
                                var offset = $("#uptown").offset();
                                $('html, body').animate({scrollTop : offset.top}, 300);
								var hero = document.getElementById(mid).getAttribute('src');
								//var xcpi = rivalp;
								$('#cutton').css('display','block');
								swit="false";
								$("#rival").attr('src', hero);
					            $("#rival").attr('style', "opacity:1");
								
								if(kan[rivalp.pos-1].count!=30) {
									$("#hero").attr('style', "opacity:0");
						            $("#hhp").hide();
						            $("#rhp").show();
									var rhp2 = rivalp.hp/rivalp.ori_hp;
									$("#ghp2").text("HP:"+rivalp.hp+"/"+rivalp.ori_hp);
									$(".gaze2").width(rhp2*100+"%");
                                    if(rivalp.hp>rivalp.ori_hp){
                                        $(".gaze2").width(100+"%");
                                    }
								}else{
									
									$("#hero").attr('style', "opacity:1");
								}
							}else{
								$('#cutton').css('display','none');
								swit="true";
							}
						});
        
                    rivalp.pos=rsn;
					if(kan[rsn-1].bhero!=null){
						var rrival = kan[rsn-1].bhero.pro;
						var rchp2;
						if(rrival=="king"){
							rchp2=100;
						}else if(rrival=="queen"){
							rchp2=90;
						}else if(rrival=="rook"){
							rchp2=30;
						}else if(rrival=="knight"){
							rchp2=20;
						}else if(rrival=="bishop"){
							rchp2=10;
						}else{
							rchp2=10;
						}
					}
                    
					if(kan[rsn-1].count==30){
                        var bpsta = $("#g"+rsn).children('.bpsta');
						bacount=1;
                        var rhero = get_hero(rsn,"r");
                        var bhero = get_hero(rsn,"b");
                        console.log("r : "+rhero);
                        console.log("b : "+bhero);
						var bat = document.createElement('img');
						bat.setAttribute("class","battle");
						bat.setAttribute("src","./pub/board/battle.jpg");
						var bat_id="g"+rsn;
						document.getElementById(bat_id).appendChild(bat); 
						$("#"+rhero).attr("style","opacity:0");
						$("#"+bhero).attr("style","opacity:0");
                        rpsta.hide();
						bpsta.hide();
						var recpi = rivalp;
						$("#"+rivalid).parent().children(".battle").click(function(){
							var regpos = recpi.pos;
							if(swit=="true" && kan[regpos-1].count==30){
                                var offset = $("#uptown").offset();
                                $('html, body').animate({scrollTop : offset.top}, 300);
								$("#hhp").show();
								$("#rhp").show();
								var arhp2 = kan[rsn-1].rhero.hp/kan[rsn-1].rhero.ori_hp;
								var arhp3 = kan[rsn-1].bhero.hp/kan[rsn-1].bhero.ori_hp;
								$("#ghp2").text("HP:"+kan[rsn-1].rhero.hp+"/"+kan[rsn-1].rhero.ori_hp);
								$(".gaze2").width(arhp2*100+"%");
                                if(kan[rsn-1].rhero.hp>kan[rsn-1].rhero.ori_hp){
                                        $(".gaze2").width(100+"%");
                                    }
								$("#ghp").text("HP:"+kan[rsn-1].bhero.hp+"/"+kan[rsn-1].bhero.ori_hp);
								$(".gaze").width(arhp3*100+"%");
                                if(kan[rsn-1].bhero.hp>kan[rsn-1].bhero.ori_hp){
                                        $(".gaze").width(100+"%");
                                    }

								$('#cutton').css('display','block');
								swit="false";
								$("#hero").attr("src",kan[rsn-1].bhero.src);
								$("#hero").attr("style","opacity:1");
								$("#rival").attr("src",kan[rsn-1].rhero.src);
								$("#rival").attr("style","opacity:1");
                                
                                console.log("현재 이 칸의 bhero : "+kan[rsn-1].bhero.name);
                                
								//cid=kan[rsn-1].bhero.id;
								//cpi=kan[rsn-1].bhero;
                                set_c(rsn);
								epass="true";
                                //alert("id : "+kan[rsn-1].bhero.id+" name: "+kan[rsn-1].bhero.name);
                                //bswitch=="true";
							}else{
								$('#cutton').css('display','none');
								swit="true";
							}
						});
					}
					if(kan[npos-1].count==30 && npos>0){
						var dgid = document.getElementById("g"+npos);
						dgid.removeChild(dgid.lastChild);
						$("#"+kan[npos-1].bhero.id).attr("style","opacity:1");
                        $("#g"+kan[npos-1].bhero.pos).children('.bpsta').show();
						$("#g"+kan[npos-1].bhero.pos).children('.bpsta').attr("style","opacity:1");
					}
					kan[npos-1].count-=10;
					kan[npos-1].rhero=null;
   });
    socket.on('kill all', function(yyid, mmid, asn){
       
       var dsn = 64-asn+1;   
       if(kan[dsn-1].rhero.pro=="king" || kan[dsn-1].bhero.pro=="king"){
           socket.emit('you draw', yousd);
       }
       var yid = kan[dsn-1].rhero.id;
       var mid = kan[dsn-1].bhero.id;
       kan[dsn-1].rhero=null;
       kan[dsn-1].bhero=null;
       kan[dsn-1].count=0;
       
       var aid = document.getElementById("g"+dsn);
       aid.removeChild(aid.lastChild);
       $("#"+yid).remove();
       $("#"+mid).remove();
       $("#g"+dsn).children('.bpsta').remove();
       $("#g"+dsn).children('.rpsta').remove();
       
   }); 
    socket.on('kill red', function(yyid, mmid, asn){
       
       var dsn = 64-asn+1;
       kan[dsn-1].count=10;
        
        if(kan[dsn-1].bhero.pro=="king"){
            socket.emit('you win', yousd);
        }
       var yid = kan[dsn-1].rhero.id;
       var mid = kan[dsn-1].bhero.id;
       
       var aid = document.getElementById("g"+dsn);
       aid.removeChild(aid.lastChild);
       $("#"+mid).remove();
       kan[dsn-1].rhero.hp-=kan[dsn-1].bhero.attack;
       $("#hero").hide();
       $("#"+yid).attr("style","opacity:1;");
       kan[dsn-1].bhero=null; 
       
       $("#g"+kan[dsn-1].rhero.pos).children('.bpsta').remove();
       $("#g"+kan[dsn-1].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[dsn-1].rhero.hp+'');
       $("#g"+kan[dsn-1].rhero.pos).children('.rpsta').show();
       $("#g"+kan[dsn-1].rhero.pos).children('.rpsta').attr("style","opacity:1;");
   });
    socket.on('kill blue', function(yyid, mmid, asn){
       
       var dsn = 64-asn+1;
       kan[dsn-1].count=20;
       if(kan[dsn-1].rhero.pro=="king"){
            socket.emit('you lose', yousd);
          }
       var yid = kan[dsn-1].rhero.id;
       var mid = kan[dsn-1].bhero.id;
    
       var aid = document.getElementById("g"+dsn);
       aid.removeChild(aid.lastChild);
       $("#"+yid).remove();
       kan[dsn-1].bhero.hp-=kan[dsn-1].rhero.attack;
       $("#rival").hide();
       $("#"+mid).attr("style","opacity:1;");
       kan[dsn-1].rhero=null;
       
       $("#g"+kan[dsn-1].bhero.pos).children('.rpsta').remove();
       $("#g"+kan[dsn-1].bhero.pos).children('.bpsta').children('.p_hp').text(kan[dsn-1].bhero.hp+'');
       $("#g"+kan[dsn-1].bhero.pos).children('.bpsta').show();
       $("#g"+kan[dsn-1].bhero.pos).children('.bpsta').attr("style","opacity:1;");
   });
    socket.on('attack two', function(yyid, mmid, asn){ 
       
       var dsn = 64-asn+1;
       var yid = kan[dsn-1].rhero.id;
       var mid = kan[dsn-1].bhero.id;
       //var dnum = dsn-1;
       kan[dsn-1].bhero.hp-=kan[dsn-1].rhero.attack;
       kan[dsn-1].rhero.hp-=kan[dsn-1].bhero.attack;
       $("#g"+dsn).children('.bpsta').children('.p_hp').text(''+kan[dsn-1].bhero.hp);
       $("#g"+dsn).children('.rpsta').children('.p_hp').text(kan[dsn-1].rhero.hp+'');
   });
    socket.on('ch_trap_hp_attack', function(pos){
         var rpos = 64-pos+1;
         $("#g"+rpos).css("background-color","rgba(102,102,102,0.9)");
         var b_hp = kan[rpos-1].rhero.hp;
         var b_attack = kan[rpos-1].rhero.attack;
         kan[rpos-1].rhero.hp = b_attack;
         kan[rpos-1].rhero.attack = b_hp;
         //$(".change_ha").remove();
         $("#g"+kan[rpos-1].rhero.pos).children('.rpsta').children('.p_hp').text(kan[rpos-1].rhero.hp);
         $("#g"+kan[rpos-1].rhero.pos).children('.rpsta').children('.p_attack').text(kan[rpos-1].rhero.attack);
         
     });
   socket.on('play game', function(smessage){
            document.getElementById('jk').play();
            $("#main_view").hide();
            $("#daichi").show();
			kan[0] = new Make(bom);
            if(rl01!=null){
                    kan[0].set_rh(rl01);
                    kan[0].set_count(10);
               }else{
                   kan[0].set_count(0);
               }
			kan[1] = new Make(bom);
            if(rk01!=null){
                    kan[1].set_rh(rk01);
			        kan[1].set_count(10);
               }else{
                   kan[1].set_count(0);
               }
			kan[2] = new Make(bom);
            if(rb01!=null){
                    kan[2].set_rh(rb01);
			        kan[2].set_count(10);
               }else{
                   kan[2].set_count(0);
               }
			kan[3] = new Make(bom);
            if(rking!=null){
                    kan[3].set_rh(rking);
			        kan[3].set_count(10);
               }else{
                   kan[3].set_count(0);
               }
			kan[4] = new Make(bom);
            if(rqueen!=null){
                    kan[4].set_rh(rqueen);
			        kan[4].set_count(10);
               }else{
                   kan[4].set_count(0);
               }
			kan[5] = new Make(bom);
            if(rb02!=null){
                    kan[5].set_rh(rb02);
			        kan[5].set_count(10);
               }else{
                   kan[5].set_count(0);
               }
			kan[6] = new Make(bom);
            if(rk02!=null){
                    kan[6].set_rh(rk02);
			        kan[6].set_count(10);
               }else{
                   kan[6].set_count(0);
               }
			kan[7] = new Make(bom);
            if(rl02!=null){
                    kan[7].set_rh(rl02);
			        kan[7].set_count(10);
               }else{
                   kan[7].set_count(0);
               }
			kan[8] = new Make(bom);
            if(rp01!=null){
                    kan[8].set_rh(rp01);
			        kan[8].set_count(10);
               }else{
                   kan[8].set_count(0);
               }
			kan[9] = new Make(bom);
            if(rp02!=null){
                    kan[9].set_rh(rp02);
			        kan[9].set_count(10);
               }else{
                   kan[9].set_count(0);
               }
			kan[10] = new Make(bom);
            if(rp03!=null){
                    kan[10].set_rh(rp03);
			        kan[10].set_count(10);
               }else{
                   kan[10].set_count(0);
               }
			kan[11] = new Make(bom);
            if(rp04!=null){
                    kan[11].set_rh(rp04);
			        kan[11].set_count(10);
               }else{
                   kan[11].set_count(0);
               }
			kan[12] = new Make(bom);
            if(rp05!=null){
                    kan[12].set_rh(rp05);
			        kan[12].set_count(10);
               }else{
                   kan[12].set_count(0);
               }
			kan[13] = new Make(bom);
            if(rp06!=null){
                    kan[13].set_rh(rp06);
			        kan[13].set_count(10);
               }else{
                   kan[13].set_count(0);
               }
			kan[14] = new Make(bom);
            if(rp07!=null){
                    kan[14].set_rh(rp07);
			        kan[14].set_count(10);
               }else{
                   kan[14].set_count(0);
               }
			kan[15] = new Make(bom);
            if(rp08!=null){
                    kan[15].set_rh(rp08);
			        kan[15].set_count(10);
               }else{
                   kan[15].set_count(0);
               }
			
			kan[48] = new Make(bom);
            if(bp01!=null){
                    kan[48].set_bh(bp01);
			        kan[48].set_count(20);
               }else{
                   kan[48].set_count(0);
               }
			kan[49] = new Make(bom);
            if(bp02!=null){
                    kan[49].set_bh(bp02);
			        kan[49].set_count(20);
               }else{
                   kan[49].set_count(0);
               }
			kan[50] = new Make(bom);
            if(bp03!=null){
                    kan[50].set_bh(bp03);
			        kan[50].set_count(20);
               }else{
                   kan[50].set_count(0);
               }
			kan[51] = new Make(bom);
            if(bp04!=null){
                    kan[51].set_bh(bp04);
			        kan[51].set_count(20);
               }else{
                   kan[51].set_count(0);
               }
			kan[52] = new Make(bom);
            if(bp05!=null){
                    kan[52].set_bh(bp05);
			        kan[52].set_count(20);
               }else{
                   kan[52].set_count(0);
               }
			kan[53] = new Make(bom);
            if(bp06!=null){
                    kan[53].set_bh(bp06);
			        kan[53].set_count(20);
               }else{
                   kan[53].set_count(0);
               }
			kan[54] = new Make(bom);
            if(bp07!=null){
                    kan[54].set_bh(bp07);
			        kan[54].set_count(20);
               }else{
                   kan[54].set_count(0);
               }
			kan[55] = new Make(bom);
            if(bp08!=null){
                    kan[55].set_bh(bp08);
			        kan[55].set_count(20);
               }else{
                   kan[55].set_count(0);
               }
			kan[56] = new Make(bom);
            if(bl01!=null){
                    kan[56].set_bh(bl01);
			        kan[56].set_count(20);
               }else{
                   kan[56].set_count(0);
               }
			kan[57] = new Make(bom);
            if(bk01!=null){
                    kan[57].set_bh(bk01);
			        kan[57].set_count(20);
               }else{
                   kan[57].set_count(0);
               }
			kan[58] = new Make(bom);
            if(bb01!=null){
                    kan[58].set_bh(bb01);
			        kan[58].set_count(20);
               }else{
                   kan[58].set_count(0);
               }
			kan[59] = new Make(bom);
            if(bqueen!=null){
                    kan[59].set_bh(bqueen);
			        kan[59].set_count(20);
               }else{
                   kan[59].set_count(0);
               }
			kan[60] = new Make(bom);
            if(bking!=null){
                    kan[60].set_bh(bking);
			        kan[60].set_count(20);
               }else{
                   kan[60].set_count(0);
               }
			kan[61] = new Make(bom);
            if(bb02!=null){
                    kan[61].set_bh(bb02);
			        kan[61].set_count(20);
               }else{
                   kan[61].set_count(0);
               }
			kan[62] = new Make(bom);
            if(bk02!=null){
                    kan[62].set_bh(bk02);
			        kan[62].set_count(20);
               }else{
                   kan[62].set_count(0);
               }
			kan[63] = new Make(bom);
            if(bl02!=null){
                    kan[63].set_bh(bl02);
			        kan[63].set_count(20);
               }else{
                   kan[63].set_count(0);
               }
			
            //console.log("kan에대한 실험 : kan0: "+kan[0].rhero.name);
			for(var i=16;i<48;i++){
				kan[i] = new Make(bom);
				kan[i].set_count(0); 
			}
            
       
			$('.game').on("mouseover",function(){
				var ppl = document.createElement('img');
				ppl.setAttribute("id","bunk");
				ppl.setAttribute("src","./board/kae02.jpg");  
				document.getElementById("g24").appendChild(ppl);
				$("#bunk").click( function() {
					alert("ss");
				});
				$('.game').on("mouseout",function(){
					$("#bunk").remove();
				});
			});
			
			
            if(rk01!=null){
                $("#ni01").on({
                    mousedown: function(){
                        pass="true";
                        pid="ni01";
                        pname=rk01;
                    },
                    mouseup: function(){
                        psrc=null;
                        pass="false";
                        pid=null;
                        pname=null;
                    }
                });
            }
			$("#g17").on({
				mouseover: function(){
					if(pass=="true"){
						//alert(psrc);
						ppid=document.getElementById(pid);
						ppid.remove();
						pass=false;
						swit="true";
						//document.getElementById("g17").innerHTML=psrc;
						var ppl = document.createElement('img');
						ppl.setAttribute("id",pid);
						ppl.setAttribute("src",pname.src);  
						//var pl_id=$(e.target).parent().attr("id")+"";
						document.getElementById("g17").appendChild(ppl);
						var hid=pid;
						$("#"+pid).click( function() { 
							//alert("dddd");
				            if(swit=="true"){
								var hero = document.getElementById( hid ).getAttribute('src');
								$('#cutton').css('display','block');
								swit="false";
								$("#hero").attr('src', hero);
							}else{
								$('#cutton').css('display','none');
								swit="true";
							} 
				        });
						pid=null;
						psrc=null;
						pname.pos=17;
						pname=null;
					}
				}
			});
			
			
            $(".mirai").on({
				click: function(e){
                    var x = $(e.target);
					mirai_click(x);
				}
			});
			$("#close").click( function() {
				closing();
			});
			$("#move").click(function(){
                if(m_turn=="true"){
                    moving();
                }
				
			});
			$("#attack").on({
				click:function(){
                    if(m_turn=="true"){
					   attacking();
                    }
				}
			});
        entry_range_click();
        socket.emit('determine turn',yousd,mesd);
    });
    
    socket.on('set turn', function(start){
       alert("제 턴의 시작 입니다.");
       turn_count=turn_count+1;
       m_turn="true";
       swit="true";
       cid=null;
       cpi=null;
       grandc="false";
       onepiece="false";
       de_cost=6;
       $("#b_accost").text(de_cost+"");
       sturn_check();
       bhuda_opacity();
       obstacle_check();
       $("#tend").html("턴 종료");
       timer=setTimeout(function(){
           if(m_turn=="true"){
                round_huda();
                isSelecthuda="false";
                m_turn="false";
                $("#tend").html("상대 턴");
                socket.emit('turn pass',yousd);
                clearTimeout(timer);
           }
       },30000);
   });
    
    socket.on('standby card', function(start){
        if(turn_c==0){
            turn_c++;
            socket.emit('give card',yousd,mesd);
        }
    });
    
    socket.on('ready card', function(start){
        socket.emit('give first',ori_name,mesd);
    });
     
    socket.on('attack part', function(team,pos, num){
        var rpos = 64-pos-1;
        var inc_rpos = rpos+1;
        if(team=='r'){
                kan[rpos].bhero.hp-=num;
                $("#g"+inc_rpos).children('.bpsta').children('.p_hp').text(kan[rpos].bhero.hp); 
             
        }else{            
                kan[rpos].rhero.hp-=num;
                $("#g"+inc_rpos).children('.rpsta').children('.p_hp').text(kan[rpos].rhero.hp);
        }
         
     });
    
    socket.on('debuff part', function(team, pos, num){
            var rpos = 64-pos-1;
            var inc_rpos = rpos+1;
            if(team=='r'){
                 kan[rpos].bhero.attack-=num;
                 if(kan[rpos].bhero.attack<=0){
                     kan[rpos].bhero.attack=0;
                 }
                 $("#g"+inc_rpos).children('.bpsta').children('.p_attack').text(kan[rpos].bhero.attack);
            }else{
                 kan[rpos].rhero.attack-=num;
                 if(kan[rpos].rhero.attack<=0){
                     kan[rpos].rhero.attack=0;
                 }
                 $("#g"+inc_rpos).children('.rpsta').children('.p_attack').text(kan[rpos].rhero.attack);
            }
     });
     
    socket.on('hp half', function(cid,sn){
        var hasn = 64-sn+1;
        //$("g"+hasn).css("background-color","rgba(102,102,102,0.9)");
        kan[hasn-1].rhero.hp=kan[hasn-1].rhero.hp/2;
        kan[hasn-1].btrap="false";
        kan[hasn-1].bstrap=null;
        $("#g"+hasn).children('.rpsta').children('.p_hp').text(kan[hasn-1].rhero.hp);
        $("#g"+hasn).css("background-color","rgba(102,102,102,0.9)");
        $("#g"+hasn).hover(function(){
            $(this).css("background-color","yellow");
        },function(){
            $(this).css("background-color","rgba(102,102,102,0.9)");
        });
    });
    
    socket.on('rival_hp zero', function(sn){
        var zasn = 64-sn;
        kan[zasn-1].bhero.hp=0;
        
        $("#g"+zasn).children('.bpsta').remove();
        $("#"+kan[zasn-1].bhero.id).remove();
        kan[zasn-1].bhero=null;
        $("#g"+zasn).css("background-color","rgba(102,102,102,0.9)");
        kan[zasn-1].count-=20;
        $("#g"+zasn).hover(function(){
            $(this).css("background-color","yellow");
        },function(){
            $(this).css("background-color","rgba(102,102,102,0.9)");
        });
     }); 
    
    socket.on('hp zero', function(sn){
        var zasn = 64-sn+1;
        //$("g"+zasn).css("background-color","rgba(102,102,102,0.9)");
        kan[zasn-1].rhero.hp=0;
        kan[zasn-1].btrap="false";
        kan[zasn-1].bstrap=null;
        if(kan[zasn-1].count==30){
            var hzid = document.getElementById("g"+zasn);
            hzid.removeChild(hzid.lastChild);
            $("#"+kan[zasn-1].bhero.id).attr("style","opacity:1");
            $("#"+kan[zasn-1].bhero.id).show();
            $("#g"+kan[zasn-1].bhero.pos).children('.bpsta').attr("style","opacity:1");
            $("#g"+kan[zasn-1].bhero.pos).children('.bpsta').show();
        }
        $("#g"+zasn).children('.rpsta').remove();
        $("#"+kan[zasn-1].rhero.id).remove();
        kan[zasn-1].rhero=null;
        $("#g"+zasn).css("background-color","rgba(102,102,102,0.9)");
        kan[zasn-1].count-=10;
        $("#g"+zasn).hover(function(){
            $(this).css("background-color","yellow");
        },function(){
            $(this).css("background-color","rgba(102,102,102,0.9)");
        });
        
    });
    
    socket.on('rival_hp debuff', function(sn,damage){
        var dasn = 64-sn+1;
        //$("g"+dasn).css("background-color","rgba(102,102,102,0.9)");
        kan[dasn-1].bhero.hp=kan[dasn-1].bhero.hp-damage;
        kan[dasn-1].btrap="false";
        kan[dasn-1].bstrap=null;
        $("#g"+dasn).children('.bpsta').children('.p_hp').text(kan[dasn-1].bhero.hp);
        $("#g"+dasn).css("background-color","rgba(102,102,102,0.9)");
        $("#g"+dasn).hover(function(){
            $(this).css("background-color","yellow");
        },function(){
            $(this).css("background-color","rgba(102,102,102,0.9)");
        });
    });
    socket.on('hp debuff', function(sn,damage){
        var dasn = 64-sn+1;
        //$("g"+dasn).css("background-color","rgba(102,102,102,0.9)");
        kan[dasn-1].rhero.hp=kan[dasn-1].rhero.hp-damage;
        kan[dasn-1].btrap="false";
        kan[dasn-1].bstrap=null;
        $("#g"+dasn).children('.rpsta').children('.p_hp').text(kan[dasn-1].rhero.hp);
        $("#g"+dasn).css("background-color","rgba(102,102,102,0.9)");
        $("#g"+dasn).hover(function(){
            $(this).css("background-color","yellow");
        },function(){
            $(this).css("background-color","rgba(102,102,102,0.9)");
        });
    });
    
    socket.on('attack half', function(sn){
        var atsn = 64-sn+1;
        //$("g"+atsn).css("background-color","rgba(102,102,102,0.9)");
        kan[atsn-1].rhero.attack=kan[atsn-1].rhero.attack/2;
        kan[atsn-1].btrap="false";
        kan[atsn-1].bstrap=null;
        $("#g"+atsn).children('.rpsta').children('.p_attack').text(kan[atsn-1].rhero.attack);
        $("#g"+atsn).css("background-color","rgba(102,102,102,0.9)");
        $("#g"+atsn).hover(function(){
            $(this).css("background-color","yellow");
        },function(){
            $(this).css("background-color","rgba(102,102,102,0.9)");
        });
    });
    
    socket.on('attack zero', function(sn){
        
        var atzn = 64-sn+1;
        //$("g"+atzn).css("background-color","rgba(102,102,102,0.9)");
        kan[atzn-1].rhero.attack=0;
        kan[atzn-1].btrap="false";
        kan[atzn-1].bstrap=null;
        $("#g"+atzn).children('.rpsta').children('.p_attack').text(0);
        $("#g"+atzn).css("background-color","rgba(102,102,102,0.9)");
        $("#g"+atzn).hover(function(){
            $(this).css("background-color","yellow");
        },function(){
            $(this).css("background-color","rgba(102,102,102,0.9)");
        });
    });
    
    socket.on('attack debuff', function(sn,damage){
        var atdn = 64-sn+1;
        //$("g"+atdn).css("background-color","rgba(102,102,102,0.9)");
        kan[atdn-1].rhero.attack=kan[atdn-1].rhero.attack-damage;
        kan[atdn-1].btrap="false";
        kan[atdn-1].bstrap=null;
        $("#g"+atdn).children('.rpsta').children('.p_attack').text(kan[atdn-1].rhero.attack);
        $("#g"+atdn).css("background-color","rgba(102,102,102,0.9)");
        $("#g"+atdn).hover(function(){
            $(this).css("background-color","yellow");
        },function(){
            $(this).css("background-color","rgba(102,102,102,0.9)");
        });
    });
    socket.on('attack ranged', function(pos, num){
         var rpos = 64-pos-1;
         kan[rpos].bhero.hp-=num;
         $("#g"+kan[rpos].bhero.pos).children('.bpsta').children('.p_hp').text(''+kan[rpos].bhero.hp);
         if(kan[rpos].bhero.hp<=0){
                kan[rpos].count-=20;
                $("#g"+kan[rpos].bhero.pos).children('.bpsta').remove();
                $("#"+kan[rpos].bhero.id).remove();
         }
         
     });
    
    socket.on('magic hp', function(pos,yang){
        var mhp = 64-pos+1;
        kan[mhp-1].rhero.hp=kan[mhp-1].rhero.hp+yang;
        if(kan[mhp-1].rhero.hp<=0){
           kan[mhp-1].rhero.hp=0;
        }
        $("#g"+mhp).children('.rpsta').children('.p_hp').text(kan[mhp-1].rhero.hp);
    });
     socket.on('magic attack', function(pos,yang){
        var mat = 64-pos+1;
        kan[mat-1].rhero.attack=kan[mat-1].rhero.attack+yang;
        if(kan[mat-1].rhero.attack<=0){
           kan[mat-1].rhero.attack=0;
        }
        $("#g"+mat).children('.rpsta').children('.p_attack').text(kan[mat-1].rhero.attack);
    });
     socket.on('magic duo', function(pos,yang){
        var mdo = 64-pos+1;
        kan[mdo-1].rhero.hp=kan[mdo-1].rhero.hp+yang;
        $("#g"+mdo).children('.rpsta').children('.p_hp').text(kan[mdo-1].rhero.hp);
        kan[mdo-1].rhero.attack=kan[mdo-1].rhero.attack+yang;
        $("#g"+mdo).children('.rpsta').children('.p_attack').text(kan[mdo-1].rhero.attack); 
    });
    socket.on('win you', function(){
        alert("you win");
        $("#cutton").hide();
        retry_setting();
    });
    socket.on('draw you', function(){
        alert("you draw");
        $("#cutton").hide();
        retry_setting();
    });
    socket.on('lose you', function(){
        alert("you lose");
        $("#cutton").hide();
        retry_setting();
    });
    
    $("#tend").on({
        click : function(){
            if(m_turn=="true"){
                round_huda();
                isSelecthuda="false";
                m_turn="false";
                socket.emit('turn pass',yousd);
                clearTimeout(timer);
           }
        }
    });
    
    function moving(){
        if(onepiece=="false"){
        if(cpi!=null){
        var u_pi = cpi;
        var u_pro = u_pi.pro;
        var u_num = u_pi.pos;
        var u_t = u_pi.team;
        if(grandc=="false"){
				bswitch="false";
				//var pm_id=$("#"+cid).parent().attr("id")+"";
				//var smt = pm_id.substring(1).trim();
				gplace=u_num;
				$('#cutton').css('display','none');
				swit="true";
				//alert(u_num);
                var dai_p = new Array();
                var dai_c = 0;
				if(u_pro=="knight"){
					//alert(u_num);
					if(u_t=='b'){
						grandc="true";
						//alert(u_num);
						var umok = parseInt(u_num/8);
						var ures = parseInt(u_num%8);
						if(umok==7){
							if(ures==0){
								//var y_p = new Array();
								dai_p[dai_c++]=u_num-8-8-1;
								dai_p[dai_c++]=u_num-8-1-1;
								dai_p[dai_c++]=u_num+8-1-1;
							}
							else if(ures==1){
								//alert(u_num);
								//var y_p = new Array();
								dai_p[dai_c++]=u_num-8-8+1;
								dai_p[dai_c++]=u_num-8+1+1;
							}
							else if(ures==2){
								
								dai_p[dai_c++]=u_num-8-8+1;
								dai_p[dai_c++]=u_num-8+1+1;
								dai_p[dai_c++]=u_num-8-8-1;
							}
							else if(ures>=3 && ures<=6){
								dai_p[dai_c++]=u_num-8-8+1;
								dai_p[dai_c++]=u_num-8+1+1;
								dai_p[dai_c++]=u_num-8-8-1;
								dai_p[dai_c++]=u_num-8-1-1;
							}
							else if(ures==7){
								dai_p[dai_c++]=u_num-8-8+1;
								dai_p[dai_c++]=u_num-8-8-1;
								dai_p[dai_c++]=u_num-8-1-1;
							}
							else if(ures==7){
								dai_p[dai_c++]=u_num+1-8-8;
								dai_p[dai_c++]=u_num-1-8-8;
								dai_p[dai_c++]=u_num-1-1-8;
							}
						}
						else if(umok>=2 && umok<=5){
							if(ures==0){
								dai_p[dai_c++]=u_num+8+8-1;
								dai_p[dai_c++]=u_num+8-1-1;
								dai_p[dai_c++]=u_num-8-1-1;
								dai_p[dai_c++]=u_num-8-8-1;
							}
							else if(ures==1){
								
								dai_p[dai_c++]=u_num+8+8+1;
								dai_p[dai_c++]=u_num+8+1+1;
								dai_p[dai_c++]=u_num-8+1+1;
								dai_p[dai_c++]=u_num-8-8+1;
							}
							else if(ures==2){
								
								dai_p[dai_c++]=u_num+8+8+1;
								dai_p[dai_c++]=u_num+8+1+1;
								dai_p[dai_c++]=u_num-8+1+1;
								dai_p[dai_c++]=u_num-8-8+1;
								dai_p[dai_c++]=u_num-8-8-1;
								dai_p[dai_c++]=u_num+8+8-1;
							}
							else if(ures>=3 && ures<=6){
								
								dai_p[dai_c++]=u_num-8-1-1;
								dai_p[dai_c++]=u_num-8-8-1;
								dai_p[dai_c++]=u_num+8-1-1;
								dai_p[dai_c++]=u_num+8+8-1;
								dai_p[dai_c++]=u_num+8+8+1;
								dai_p[dai_c++]=u_num+8+1+1;
								dai_p[dai_c++]=u_num-8+1+1;
								dai_p[dai_c++]=u_num-8-8+1;
							}
							else if(ures==7){
								dai_p[dai_c++]=u_num-8-8+1;
								dai_p[dai_c++]=u_num-8-8-1;
								dai_p[dai_c++]=u_num-8-1-1;
								dai_p[dai_c++]=u_num+8-1-1;
								dai_p[dai_c++]=u_num+8+8-1;
								dai_p[dai_c++]=u_num+8+8+1;
							}
						}
						else if(umok==6){
							if(ures==0){
								dai_p[dai_c++]=u_num-8-8-1;
								dai_p[dai_c++]=u_num-8-1-1;
								dai_p[dai_c++]=u_num+8-1-1;
								dai_p[dai_c++]=u_num+8+8-1;
							}
							else if(ures==1){
								dai_p[dai_c++]=u_num-8-8+1;
								dai_p[dai_c++]=u_num-8+1+1;
								dai_p[dai_c++]=u_num+8+1+1;
							}
							else if(ures==2){
								dai_p[dai_c++]=u_num-8-8+1;
								dai_p[dai_c++]=u_num-8+1+1;
								dai_p[dai_c++]=u_num+8+1+1;
								dai_p[dai_c++]=u_num-8-8-1;
							}
							else if(ures>=3 && ures<=6){
								dai_p[dai_c++]=u_num-8-8+1;
								dai_p[dai_c++]=u_num-8+1+1;
								dai_p[dai_c++]=u_num+8+1+1;
								dai_p[dai_c++]=u_num-8-8-1;
								dai_p[dai_c++]=u_num-8-1-1;
								dai_p[dai_c++]=u_num+8-1-1;
							}
							else if(ures==7){
								dai_p[dai_c++]=u_num-8-8+1;
								dai_p[dai_c++]=u_num-8-8-1;
								dai_p[dai_c++]=u_num-8-1-1;
								dai_p[dai_c++]=u_num+8-1-1;
							}
						}
						else if(umok==0){
							if(ures==1){
								dai_p[dai_c++]=u_num+8+1+1;
								dai_p[dai_c++]=u_num+8+8+1;
							}
							else if(ures==2){
								
								dai_p[dai_c++]=u_num+8+1+1;
								dai_p[dai_c++]=u_num+8+8+1;
								dai_p[dai_c++]=u_num+8+8-1;
							}
							else if(ures>=3 && ures<=6){
								dai_p[dai_c++]=u_num+8+1+1;
								dai_p[dai_c++]=u_num+8+8+1;
								dai_p[dai_c++]=u_num+8-1-1;
								dai_p[dai_c++]=u_num+8+8-1;
							}
							else if(ures==7){
								dai_p[dai_c++]=u_num+8+8+1;
								dai_p[dai_c++]=u_num+8+8-1;
								dai_p[dai_c++]=u_num+8+8-1;
							}
						}
						else if(umok==1){
							if(ures==0){
								dai_p[dai_c++]=u_num+8+8-1;
								dai_p[dai_c++]=u_num+8+8-1;
							}
							else if(ures==1){
								
								dai_p[dai_c++]=u_num+8+1+1;
								dai_p[dai_c++]=u_num+8+8+1;
								dai_p[dai_c++]=u_num-8+1+1;
							}
							else if(ures==2){
								dai_p[dai_c++]=u_num+8+1+1;
								dai_p[dai_c++]=u_num+8+8+1;
								dai_p[dai_c++]=u_num-8+1+1;
								dai_p[dai_c++]=u_num+8+8-1;
							}
							else if(ures>=3 && ures<=6){
								dai_p[dai_c++]=u_num+8+1+1;
								dai_p[dai_c++]=u_num+8+8+1;
								dai_p[dai_c++]=u_num+8+8-1;
								dai_p[dai_c++]=u_num+8-1-1;
								dai_p[dai_c++]=u_num-8-1-1;
								dai_p[dai_c++]=u_num-8+1+1;
							}
							else if(ures==7){
								dai_p[dai_c++]=u_num+8+8+1;
								dai_p[dai_c++]=u_num+8+8-1;
								dai_p[dai_c++]=u_num+8-1-1;
								dai_p[dai_c++]=u_num-8-1-1;
							}
						}
						else if(umok==8){
							
								dai_p[dai_c++]=u_num-8-8-1;
								dai_p[dai_c++]=u_num-8-1-1;
                                
						}
					}
				}else if(u_pro=="phone"){
					//alert("wf");
					if(u_t=='b'){
						grandc="true";
						var umok = parseInt(u_num/8);
						var ures = parseInt(u_num%8);
                        var ph_co = 0;
						if(umok==1 && ures==0){}
						else if(umok!=0 && umok!=8){
							var p_p = u_num-8;
							if(kan[p_p-1].count<20 && kan[p_p-1].count!=10){
										dai_p[dai_c++]=p_p;
							}
							var p_r = p_p-1;
							var p_l = p_p+1;
							if(kan[p_r-1].count==10 && ures!=1){
										dai_p[dai_c++]=p_r;
							}
							if(kan[p_l-1].count==10 && ures!=0){
										dai_p[dai_c++]=p_l;
							}
						}
					}
				}
				else if(u_pro=="rook"){
					if(u_t=='b'){
						grandc="true";
						var umok = parseInt(u_num/8);
						var ures = parseInt(u_num%8);
						var l_p = new Array();
						var pcount=0;
						var cmok1=umok, cmok2=umok;
						var lres1=ures, lres2=ures;
						var lcheck = u_num+8-ures;
						var lsink = "true";
						var lsouth="true", lnorth="true", least="true", lwest="true";
						while(cmok1>=1){
							cmok1-=1;
							var presult1=u_num-8*(umok-cmok1);
							console.log(presult1);
							if(presult1==0) break;
							if(kan[presult1-1].count>=20 || kan[presult1-1].count==10){
								if(kan[presult1-1].count==10 && lsouth=="true"){ 
									dai_p[dai_c++]=u_num-8*(umok-cmok1);
									lsouth = "false";
									break;
								}
								break;
							}
							dai_p[dai_c++]=u_num-8*(umok-cmok1);
						}
						while(cmok2<7){
							cmok2+=1;
							var presult2=u_num+8*(cmok2-umok);
							if(kan[presult2-1].count>=20 || kan[presult2-1].count==10){
								if(kan[presult2-1].count==10 && lsouth=="true"){
									dai_p[dai_c++]=u_num+8*(cmok2-umok);
									lsouth="false";
									break;
								}
								break;
							}
							dai_p[dai_c++]=u_num+8*(cmok2-umok);
						}
						while(lres1>=2 && ures!=0){
							lres1-=1;
							//var presult=unum-1;
							var presult3 = u_num-1*(ures-lres1);
							console.log(presult3);
							if(kan[presult3-1].count>=20 || kan[presult3-1].count==10){
								if(kan[presult3-1].count==10 && lwest=="true"){
									 dai_p[dai_c++]=u_num-1*(ures-lres1);
									 lwest="false";
									 break;
								}
								break;
							}
							dai_p[dai_c++]=u_num-1*(ures-lres1);
						}
						while(lres2<7 && ures!=0){
							lres2+=1;
							var presult4=u_num+1*(lres2-ures);
							if(kan[presult4-1].count>=20 || kan[presult4-1].count==10){
								if(kan[presult4-1].count==10 && least=="true"){
									dai_p[dai_c++]=u_num+1*(lres2-ures);
									least="false";
									break;
								}
								lsink = "false";
								break;
							}
							dai_p[dai_c++]=u_num+1*(lres2-ures);
						}
						if(ures==0){
							var decount=8;
							var incount=1;
							var rocup;
							while(decount>1){
								rocup = u_num-incount;
								if(kan[rocup-1].count>=20 || kan[rocup-1].count==10){
									if(kan[rocup-1].count==10 && lwest=="true"){
										dai_p[dai_c++]=u_num-incount;
										lwest="false";
										decount--;
										incount++;
										break;
									}
									break;
								}
								dai_p[dai_c++]=u_num-incount;
								decount--;
								incount++;
							}
						}
						//alert(lcheck);
						if(ures!=0 && lsink=="true"){
							if(kan[lcheck-1].count<20 && least=="true"){
								if(kan[lcheck-1].count!=10){
									dai_p[dai_c++]=u_num+8-ures;
									least="false"
								}else{
									dai_p[dai_c++]=u_num+8-ures;
								}
							}
						}
                        		
					}
				}
				else if(u_pro=="bishop"){
					if(u_t=='b'){
						grandc="true";
						var umok = parseInt(u_num/8);
						var ures = parseInt(u_num%8);
						var bs_p = new Array();
						var bsmok1 = umok, bsmok2=umok, bsmok3=umok, bsmok4=umok, bsmok5=umok, bsmok6=umok;
						var bsres1 = ures, bsres2=ures, bsres3=ures, bsres4=ures, bsres5=ures, bsres6=ures;
						var bscount = 0;
						var bsbox;
						var bv1="true",bv2="true",bv3="true",bv4="true";
						//console.log(bscount-1);
						while(bsmok1>0 && bsres1<=7){
							if(ures==0) break;
							bsmok1-=1;
							bsres1+=1;
							bsbox=u_num-8*(umok-bsmok1)+1*(bsres1-ures);
							//alert(bsbox);
							if(bsres1==8){
								var bsbox2 = u_num-8*(umok-bsmok1)+1*(bsres1-ures);
								if(kan[bsbox2-1].count>=20 || kan[bsbox-1].count==10){
									if(kan[bsbox2-1].count==10 && bv1=="true"){
										dai_p[dai_c++]=u_num-8*(umok-bsmok1)+1*(bsres1-ures);
										bv1="false";
										break;
									}
									break;
								}
								dai_p[dai_c++] = u_num-8*(umok-bsmok1)+1*(bsres1-ures);
								//console.log(bs_p[bscount-1]);
								//alert(bsmok1);
								break;
							}
							if(kan[bsbox-1].count>=20 || kan[bsbox-1].count==10){
								if(kan[bsbox-1].count==10 && bv1=="true"){
									dai_p[dai_c++]=u_num-8*(umok-bsmok1)+1*(bsres1-ures);
									bv1="false";
									break;
								}
								break;
							}
							dai_p[dai_c++] = u_num-8*(umok-bsmok1)+1*(bsres1-ures);
							//console.log(bs_p[bscount-1]);
						}
						while(bsmok2>0 && bsres2>=2){
							if(ures==0) break;
							bsmok2-=1;
							bsres2-=1;
							bsbox=u_num-8*(umok-bsmok2)-1*(ures-bsres2);
							//alert(bsbox);
							if(kan[bsbox-1].count>=20 || kan[bsbox-1].count==10){
								if(kan[bsbox-1].count==10 && bv2=="true"){
									dai_p[dai_c++]=u_num-8*(umok-bsmok2)-1*(ures-bsres2);
									bv2="false";
									break;
								}
								break;
							}
							dai_p[dai_c++] =u_num-8*(umok-bsmok2)-1*(ures-bsres2);
							//console.log(bs_p[bscount-1]);
						}
						while(bsmok3<7 && bsres3>=2){
							if(ures==0) break;
							bsmok3+=1;
							bsres3-=1;
							bsbox=u_num+8*(bsmok3-umok)-1*(ures-bsres3);
							//alert(bsbox);
							if(kan[bsbox-1].count>=20 || kan[bsbox-1].count==10){
								if(kan[bsbox-1].count==10 && bv3=="true"){
									dai_p[dai_c++]=u_num+8*(bsmok3-umok)-1*(ures-bsres3);
									bv3="false";
									break;
								}
								break;
							}
							dai_p[dai_c++]=u_num+8*(bsmok3-umok)-1*(ures-bsres3);
							//console.log(bs_p[bscount-1]);
						}
						while(bsmok4<7 && bsres4<=7){
							if(ures==0) break;
							bsmok4+=1;
							bsres4+=1;
							bsbox=u_num+8*(bsmok4-umok)+1*(bsres4-ures);
							//alert(bsbox);
							if(bsres4==8){
								var bsbox2 = u_num+8*(bsmok4-umok)+1*(bsres4-ures);
								if(kan[bsbox2-1].count>=20 || kan[bsbox-1].count==10){
									if(kan[bsbox2-1].count==10 && bv4=="true"){
										dai_p[dai_c++]=u_num+8*(bsmok4-umok)+1*(bsres4-ures);
										bv4="false";
										break;
									}
									break;
								}
								dai_p[dai_c++] = u_num+8*(bsmok4-umok)+1*(bsres4-ures);
								//console.log(bs_p[bscount-1]);
								//alert(bsmok1);
								break;
							}
							if(kan[bsbox-1].count>=20 || kan[bsbox-1].count==10){
								if(kan[bsbox-1].count==10 && bv4=="true"){
									dai_p[dai_c++]=u_num+8*(bsmok4-umok)+1*(bsres4-ures);
									bv4="false";
									break;
								}
								break;
							}
							dai_p[dai_c++] = u_num+8*(bsmok4-umok)+1*(bsres4-ures);
							//console.log(bs_p[bscount-1]);
						}
						if(ures==0){
							bsres5=8;
							bsres6=8;
							while(bsmok5>1 && bsres5>2){
								bsmok5-=1;
								bsres5-=1;
								bsbox=u_num-8*(umok-bsmok5)-1*(8-bsres5);
								if(kan[bsbox-1].count>=20 || kan[bsbox-1].count==10){
									if(kan[bsbox-1].count==10 && bv2=="true"){
										dai_p[dai_c++]=u_num-8*(umok-bsmok5)-1*(8-bsres5);
										bv2="false";
										break;
									}
									break;
								}
								dai_p[dai_c++] = u_num-8*(umok-bsmok5)-1*(8-bsres5);
							}
							while(bsmok6<7 && bsres6>2){
								bsmok6+=1;
								bsres6-=1;
								bsbox=u_num+8*(bsmok6-umok)-1*(8-bsres6);
								if(kan[bsbox-1].count>=20 || kan[bsbox-1].count==10){
									if(kan[bsbox-1].count==10 && bv3=="true"){
										dai_p[dai_c++]=u_num+8*(bsmok6-umok)-1*(8-bsres6);
										bv3="false";
										break;
									}
									break;
								}
								dai_p[dai_c++] = u_num+8*(bsmok6-umok)-1*(8-bsres6);
							}
						}
                        
					}
				}
				else if(u_pro=="queen"){
					if(u_t=='b'){
						grandc="true";
						var umok = parseInt(u_num/8);
						var ures = parseInt(u_num%8);
						var qs_p = new Array();
						var qsmok1 = umok, qsmok2=umok, qsmok3=umok, qsmok4=umok, qsmok5=umok, qsmok6=umok;
						var qsres1 = ures, qsres2=ures, qsres3=ures, qsres4=ures, qsres5=ures, qsres6=ures;
						var qscount = 0;
						var qsbox;
						var qlsouth="true", qlnorth="true", qleast="true", qlwest="true";
						var qcmok1=umok, qcmok2=umok;
						var qlres1=ures, qlres2=ures;
						var qlcheck = u_num+8-ures;
						var qlsink = "true";
						var qbv1="true",qbv2="true",qbv3="true",qbv4="true";
						//alert(cpi.name);
						while(qsmok1>0 && qsres1<=7){
							if(ures==0) break;
							qsmok1-=1;
							qsres1+=1;
							qsbox=u_num-8*(umok-qsmok1)+1*(qsres1-ures);
							//alert(bsbox);
							if(qsres1==8){
								var qsbox2 = u_num-8*(umok-qsmok1)+1*(qsres1-ures);
								if(kan[qsbox2-1].count>=20 || kan[qsbox-1].count==10){
									if(kan[qsbox2-1].count==10 && qbv1=="true"){
										dai_p[dai_c++]=u_num-8*(umok-qsmok1)+1*(qsres1-ures);
										qbv1="false";
										break;
									}
									break;
								}
								dai_p[dai_c++] = u_num-8*(umok-qsmok1)+1*(qsres1-ures);
								//console.log(bs_p[bscount-1]);
								//alert(bsmok1);
								break;
							}
							if(kan[qsbox-1].count>=20 || kan[qsbox-1].count==10){
								if(kan[qsbox-1].count==10 && qbv1=="true"){
										dai_p[dai_c++]=u_num-8*(umok-qsmok1)+1*(qsres1-ures);
										qbv1="false";
										break;
								}
								break;
							}
							dai_p[dai_c++] = u_num-8*(umok-qsmok1)+1*(qsres1-ures);
							//console.log(bs_p[bscount-1]);
						}
						while(qsmok2>0 && qsres2>=2){
							if(ures==0) break;
							qsmok2-=1;
							qsres2-=1;
							qsbox=u_num-8*(umok-qsmok2)-1*(ures-qsres2);
							//alert(bsbox);
							if(kan[qsbox-1].count>=20 || kan[qsbox-1].count==10){
								if(kan[qsbox-1].count==10 && qbv2=="true"){
										dai_p[dai_c++]=u_num-8*(umok-qsmok2)-1*(ures-qsres2);
										qbv2="false";
										break;
								}
								break;
							}
							dai_p[dai_c++] = u_num-8*(umok-qsmok2)-1*(ures-qsres2);
							//console.log(bs_p[bscount-1]);
						}
						while(qsmok3<7 && qsres3>=2){
							if(ures==0) break;
							qsmok3+=1;
							qsres3-=1;
							qsbox=u_num+8*(qsmok3-umok)-1*(ures-qsres3);
							//alert(bsbox);
							if(kan[qsbox-1].count>=20 || kan[qsbox-1].count==10){
								if(kan[qsbox-1].count==10 && qbv3=="true"){
										dai_p[dai_c++]=u_num+8*(qsmok6-umok)-1*(8-qsres6);
										qbv3="false";
										break;
								}
								break;
							}
							dai_p[dai_c++]=u_num+8*(qsmok3-umok)-1*(ures-qsres3);
							//console.log(bs_p[bscount-1]);
						}
						while(qsmok4<7 && qsres4<=7){
							if(ures==0) break;
							qsmok4+=1;
							qsres4+=1;
							qsbox=u_num+8*(qsmok4-umok)+1*(qsres4-ures);
							//alert(bsbox);
							if(qsres4==8){
								var qsbox2 = u_num+8*(qsmok4-umok)+1*(qsres4-ures);
								if(kan[qsbox2-1].count>=20 || kan[qsbox-1].count==10){
									if(kan[qsbox2-1].count==10 && qbv4=="true"){
										dai_p[dai_c++]=u_num+8*(qsmok4-umok)+1*(qsres4-ures);
										qbv4="false";
										break;
									}
									break;
								}
								dai_p[dai_c++] = u_num+8*(qsmok4-umok)+1*(qsres4-ures);
								//console.log(bs_p[bscount-1]);
								//alert(bsmok1);
								break;
							}
							if(kan[qsbox-1].count>=20 || kan[qsbox-1].count==10){
								if(kan[qsbox-1].count==10 && qbv4=="true"){
										dai_p[dai_c++]=u_num+8*(qsmok4-umok)+1*(qsres4-ures);
										qbv4="false";
										break;
								}
								break;
							}
							dai_p[dai_c++] = u_num+8*(qsmok4-umok)+1*(qsres4-ures);
							//console.log(bs_p[bscount-1]);
						}

						if(ures==0){
							qsres5=8;
							qsres6=8;
							var qdecount=8;
							var qincount=1;
							var qrocup;
							while(qdecount>1){
								qrocup = u_num-qincount;
								if(kan[qrocup-1].count>=20 || kan[qrocup-1].count==10){
									if(kan[qrocup-1].count==10 && qlwest=="true"){
										dai_p[dai_c++]=u_num-qincount;
										qlwest="false";
										qdecount--;
										qincount++;
										break;
									}
									break;
								}
								dai_p[dai_c++]=u_num-qincount;
								qdecount--;
								qincount++;
							}
							while(qsmok5>1 && qsres5>2){
								qsmok5-=1;
								qsres5-=1;
								qsbox=u_num-8*(umok-qsmok5)-1*(8-qsres5);
								if(kan[qsbox-1].count>=20 || kan[qsbox-1].count==10){
									if(kan[qsbox-1].count==10 && qbv2=="true"){
										dai_p[dai_c++]=u_num-8*(umok-qsmok5)-1*(8-qsres5);
										qbv2="false";
										break;
									}
									break;
								}
								dai_p[dai_c++] = u_num-8*(umok-qsmok5)-1*(8-qsres5);
							}
							while(qsmok6<7 && qsres6>2){
								qsmok6+=1;
								qsres6-=1;
								qsbox=u_num+8*(qsmok6-umok)-1*(8-qsres6);
								if(kan[qsbox-1].count>=20 || kan[qsbox-1].count==10){
									if(kan[qsbox-1].count==10 && qbv3=="true"){
										dai_p[dai_c++]=u_num+8*(qsmok6-umok)-1*(8-qsres6);
										qbv3="false";
										break;
									}
									break;
								}
								dai_p[dai_c++] = u_num+8*(qsmok6-umok)-1*(8-qsres6);
							}
						}
						//alert("Ddd");

						while(qcmok1>=1){
							qcmok1-=1;
							var qpresult1=u_num-8*(umok-qcmok1);
							if(qpresult1==0) break;
							if(kan[qpresult1-1].count>=20 || kan[qpresult1-1].count==10){
								if(kan[qpresult1-1].count==10 && qlsouth=="true"){ 
									dai_p[dai_c++]=u_num-8*(umok-qcmok1);
									qlsouth = "false";
									break;
								}
										break;
							}
							dai_p[dai_c++]=u_num-8*(umok-qcmok1);
						}

						while(qcmok2<7){
							qcmok2+=1;
							var qpresult2=u_num+8*(qcmok2-umok);
							if(kan[qpresult2-1].count>=20 || kan[qpresult2-1].count==10){
								if(kan[qpresult2-1].count==10 && qlsouth=="true"){
									dai_p[dai_c++]=u_num+8*(qcmok2-umok);
									qlsouth="false";
									break;
								}
										break;
							}
							dai_p[dai_c++]=u_num+8*(qcmok2-umok);
						}

						while(qlres1>=2 && ures!=0){
							qlres1-=1;
							//var presult=unum-1;
							var qpresult3 = u_num-1*(ures-qlres1);
							console.log(qpresult3);
							if(kan[qpresult3-1].count>=20 || kan[qpresult3-1].count==10){
								if(kan[qpresult3-1].count==10 && qlwest=="true"){
									 dai_p[dai_c++]=u_num-1*(ures-qlres1);
									 qlwest="false";
									 break;
								}
										break;
							}
							dai_p[dai_c++]=u_num-1*(ures-qlres1);
						}

						while(qlres2<7 && ures!=0){
							qlres2+=1;
							var qpresult4=u_num+1*(qlres2-ures);
							if(kan[qpresult4-1].count>=20 || kan[qpresult4-1].count==10){
								if(kan[qpresult4-1].count==10 && qleast=="true"){
									dai_p[dai_c++]=u_num+1*(qlres2-ures);
									qleast="false";
									break;
								}
								qlsink = "false";
								break;
							}
							dai_p[dai_c++]=u_num+1*(qlres2-ures);
						}
						//alert(lcheck);

						if(ures!=0 && qlsink=="true"){
							if(kan[qlcheck-1].count<20 && qleast=="true"){
								if(kan[qlcheck-1].count!=10){
									dai_p[dai_c++]=u_num+8-ures;
									least="false"
								}else{
									dai_p[dai_c++]=u_num+8-ures;
								}
							}
						}
					}
				}
				else if(u_pro=="king"){
					if(u_t=='b'){
						grandc="true";
						var umok = parseInt(u_num/8);
						var ures = parseInt(u_num%8);
						var ks_p = new Array();
						var kscount=0;
						var kscc=0;
						var ksbox = new Array;
						var kscup;
						var kscheck = "true";
						if(ures==0 && umok==1) kscheck="false";
						if(u_num-8>0 && umok!=0 && kscheck=="true") ksbox[kscc++] = u_num-8;
						if(u_num-9>0 && ures!=1 && umok!=0 && kscheck=="true") ksbox[kscc++] = u_num-8-1;
						if(u_num-7>0 && umok!=0 && ures!=0) ksbox[kscc++] = u_num-8+1;
						if(u_num-1>0 && ures!=1) ksbox[kscc++] = u_num-1;
						if(u_num+1<65 && ures!=0) ksbox[kscc++] = u_num+1;
						if(u_num+8<65 && umok<7) ksbox[kscc++] = u_num+8;
						if(u_num+7<65 && ures!=1 && umok<7) ksbox[kscc++] = u_num+8-1;
						if(u_num+9<65 && umok<7 && ures!=0) ksbox[kscc++] = u_num+8+1;
						for(var i in ksbox){
							kscup = ksbox[i];
							if(kan[kscup-1].count!=20 && kan[kscup-1].count!=30){
								dai_p[dai_c++]=ksbox[i];
							}
						}
						
						//ksbox = unum-8-1;
					}
				}
            if(dai_p.length==0){
                swit="true";
                cid=null;
                cpi=null;
                grandc="false";
            }
            
            for(var i in dai_p){
                if(kan[dai_p[i]-1].count<20){			
							$("#g"+dai_p[i]).children(".mirai").css("display","block");
						}
            }
            
        }
        }else alert("음.. cpi가 없네.");
        }else{
            alert("이미 이번 턴에는 한번 움직이셨네요");
        }
    }
    function mirai_click(ex){
                    var vcid=cid;
					var vcpi=cpi;
					$(".mirai").hide();
					
                    if(vcpi!=null){
                        
					   var ppl = document.createElement('img');
					   ppl.setAttribute("id",vcid);
					   ppl.setAttribute("src",vcpi.src);
                       console.log(vcpi.name);
                    
					
					$("#"+vcid).remove();
					var pl_id= ex.parent().attr("id")+"";
					//document.getElementById(pl_id).innerHTML+=plus;
					document.getElementById(pl_id).appendChild(ppl); 
                    var rpsta = $("#"+pl_id).children(".rpsta");
                        
                    var pstad = document.createElement('div');
						pstad.setAttribute("class","bpsta");
						document.getElementById(pl_id).appendChild(pstad);
					var p_hpd = document.createElement('a');
						p_hpd.setAttribute("class","p_hp");
					var p_text = document.createTextNode(''+cpi.hp);
						p_hpd.appendChild( p_text );
						$("#"+pl_id).children(".bpsta").append(p_hpd);
					var p_prod = document.createElement('div');
						p_prod.setAttribute("class","p_pro");
					    $("#"+pl_id).children(".bpsta").append(p_prod);
                    var psrc = getpro_img(vcpi.pro,'b');
                    $("#"+pl_id+">.bpsta>.p_pro").css("background-image",'url('+psrc+')');
                        
					var p_atd = document.createElement('a');
						p_atd.setAttribute("class","p_attack");
					var p_text3 = document.createTextNode(''+cpi.attack); 
						p_atd.appendChild( p_text3 );
						$("#"+pl_id).children(".bpsta").append(p_atd);    
                        
					//alert(cid);
					var mid=vcid;
					var chp;
					if(cpi.pro=="king"){
						chp=100;
					}else if(cpi.pro=="queen"){
						chp=90;
					}else if(cpi.pro=="rook"){
						chp=30;
					}else if(cpi.pro=="knight"){
						chp=20;
					}else if(cpi.pro=="bishop"){
						chp=10;
					}else{
						chp=10;
					}
                            
					$("#"+vcid).click( function() {
							//alert(mid);
							if(swit=="true"){
                                var offset = $("#uptown").offset();
                                $('html, body').animate({scrollTop : offset.top}, 300);
								var hero = document.getElementById(mid).getAttribute('src');
								var xcpi=vcpi;
								$('#cutton').css('display','block');
								swit="false";
								$("#hero").attr('src', hero);
								if(grandc=="false"){
									cid = vcid;
									cpi = vcpi;
									epass="true";
								}
								$("#hero").attr('style', "opacity:1");
								if(kan[xcpi.pos-1].count!=30) {
									//$("#hero").attr('src', "./black.jpg");
									$("#rival").attr('style', "opacity:0");
									$("#rhp").hide();
									$("#hhp").show();
									var rhp = xcpi.hp/xcpi.ori_hp;
									$("#ghp").text("HP:"+xcpi.hp+"/"+xcpi.ori_hp);
									$(".gaze").width(rhp*100+"%");
                                    if(xcpi.hp>xcpi.ori_hp){
                                        $(".gaze").width(100+"%");
                                    }
								}else{
									//alert(kan[cpi.pos-1].count);
									$("#rival").attr('style', "opacity:1.0");
								}
							}else{
								$('#cutton').css('display','none');
								swit="true";
							}
						});
					var st = pl_id.substring(1).trim();
					var sn = parseInt(st);
					kan[sn-1].count+=20;
					kan[sn-1].bhero=cpi;
					//alert(sn);
					vcpi.pos=sn;
					if(kan[sn-1].rhero!=null){
						var rrival = kan[sn-1].rhero.pro;
						var chp2;
						if(rrival=="king"){ 
							chp2=100;
						}else if(rrival=="queen"){
							chp2=90;
						}else if(rrival=="rook"){
							chp2=30;
						}else if(rrival=="knight"){
							chp2=20;
						}else if(rrival=="bishop"){
							chp2=10;
						}else{
							chp2=10;
						}
					}
                    //var rhero = kan[sn-1].rhero.id;
                    //var bhero = kan[sn-1].bhero.id;
                        
                    var bpsta = $("#"+pl_id).children(".bpsta");
					$("#g"+gplace).children(".bpsta").remove();    
					if(kan[sn-1].count==30){
						bacount=1;
                        var rhero = get_hero(sn,"r");
                        var bhero = get_hero(sn,"b");
                        console.log("r : "+rhero);
                        console.log("b : "+bhero);
						var bat = document.createElement('img');
						bat.setAttribute("class","battle");
						bat.setAttribute("src","./pub/board/battle.jpg");
						var bat_id=ex.parent().attr("id")+"";
						document.getElementById(bat_id).appendChild(bat); 
						$("#"+rhero).attr("style","opacity:0");
						$("#"+bhero).attr("style","opacity:0");
                        rpsta.hide();
						bpsta.hide();
						var recpi = vcpi;
						ex.parent().children(".battle").click(function(){
							var regpos = recpi.pos;
							if(swit=="true" && kan[regpos-1].count==30){
                                var offset = $("#uptown").offset();
                                $('html, body').animate({scrollTop : offset.top}, 300);
								$("#hhp").show();
								$("#rhp").show();
								var rhp2 = kan[sn-1].rhero.hp/kan[sn-1].rhero.ori_hp;
								var rhp3 = kan[sn-1].bhero.hp/kan[sn-1].bhero.ori_hp;
								$("#ghp2").text("HP:"+kan[sn-1].rhero.hp+"/"+kan[sn-1].rhero.ori_hp);
								$(".gaze2").width(rhp2*100+"%");
                                if(kan[sn-1].rhero.hp>kan[sn-1].rhero.ori_hp){ 
                                        $(".gaze2").width(100+"%");
                                    }
								$("#ghp").text("HP:"+kan[sn-1].bhero.hp+"/"+kan[sn-1].bhero.ori_hp);
								$(".gaze").width(rhp3*100+"%");
                                if(kan[sn-1].bhero.hp>kan[sn-1].bhero.ori_hp){
                                        $(".gaze").width(100+"%");
                                    }

								//alert("ss");
								$('#cutton').css('display','block');
								swit="false";
								$("#hero").attr("src",kan[sn-1].bhero.src);
								$("#hero").attr("style","opacity:1");
								$("#rival").attr("src",kan[sn-1].rhero.src);
								$("#rival").attr("style","opacity:1");
                                
                                console.log("현재 이 칸의 bhero : "+kan[sn-1].bhero.name);
                                
								cid=kan[sn-1].bhero.id;
								cpi=kan[sn-1].bhero;
								epass="true";
                                //bswitch=="true";
							}else{
								$('#cutton').css('display','none');
								swit="true";
							} 
						});
					} 
					if(kan[gplace-1].count==30 && gplace>0){
						var dgid = document.getElementById("g"+gplace);
				        dgid.removeChild(dgid.lastChild);
						$("#"+kan[gplace-1].rhero.id).attr("style","opacity:1");
                        $("#g"+kan[gplace-1].rhero.pos).children('.rpsta').show();
						$("#g"+kan[gplace-1].rhero.pos).children('.rpsta').attr("style","opacity:1");
					}
					kan[gplace-1].count-=20;
					kan[gplace-1].bhero=null;
                    socket.emit('move rival', yousd,gplace,sn); 
					if(kan[sn-1].rtrap=="true"){
                        $("g"+sn).css("background-color","rgba(102,102,102,0.9)");
                        if(kan[sn-1].rstrap.pro=="dehp"){
                            dehp_commit(sn);
                        }else if(kan[sn-1].rstrap.pro=="dehp_half"){
                             dehp_half_commit(sn);
                        }else if(kan[sn-1].rstrap.pro=="dehp_zero"){
                             dehp_zero_commit(sn);
                        }else if(kan[sn-1].rstrap.pro=="deat"){
                             deat_commit(sn);   
                        }else if(kan[sn-1].rstrap.pro=="deat_half"){
                             deat_half_commit(sn);
                        }else if(kan[sn-1].rstrap.pro=="deat_zero"){
                             deat_zero_commit(sn);   
                        }else if(kan[sn-1].rstrap.pro=="deduo"){
                            //다시 생각해보기
                             dehp_commit(sn);
                             deat_commit(sn);    
                        }else if(kan[sn-1].rstrap.pro=="trap_sturn"){
                              trap_sturn_commit(sn);
                        }else if(kan[sn-1].rstrap.pro=="ch_ha"){
                              change_ha_commit(sn);
                        }else if(kan[sn-1].rstrap.pro=="dehp_all"){
                              dehp_all_commit(sn,"r");
                              dehp_all_commit(sn,"b");
                        }else if(kan[sn-1].rstrap.pro=="deduo_half"){
                              dehp_half_commit(sn);
                              deat_half_commit(sn);
                        }else if(kan[sn-1].rstrap.pro=="dehp_self"){
                              dehp_self_commit(sn);
                        }else if(kan[sn-1].rstrap.pro=="dehp_ran"){
                              dehp_ran_commit(sn);
                        }
                        kan[sn-1].rtrap="false";
                        kan[sn-1].rstrap=null;
                    }
                    cid=null;
					cpi=null;
					epass="false";
					gplace=0;
					grandc="false";
					bswitch="true";
                    onepiece="true";
                    }
				
    }
    function attacking(){
        if(isgame=="true"){
        if(de_cost>=2){
            if(d_click=="true"){
                d_click="false";
                if(cpi!=null && bswitch=="true"){
                    console.log("공격하는 놈은 : "+cpi.name); 
                    
                    if(cpi.team!='r' && kan[cpi.pos-1].count==30){
                        if(kan[cpi.pos-1].rhero.armor>0){
                            magical_hat();
                            d_click="true";
                            return;
                        }
                        else{
                            de_cost-=2;
                            $("#b_accost").text(de_cost+"");
							var ppl = document.createElement('img');
							ppl.setAttribute("id","effe");
							ppl.setAttribute("src","./pub/board/dark.gif");
							ppl.setAttribute("style","top:0; left:60%; z-index:10; width:40%; height:100%; position:absolute;")
							$("#cutton").append(ppl);
							var timer=setTimeout(function(){
                                d_click="true";
								$("#effe").remove();
								clearTimeout(timer);
							},1500);
							var ground = cpi.pos;
							var attacker1 = cpi.attack;
							var attacker2 = kan[ground-1].rhero.attack;
							var ahp1 = cpi.hp;
							var ahp2 = kan[ground-1].rhero.hp;
							var apro01=cpi.pro, apro02=kan[ground-1].rhero.pro;
							var ahps01,ahps02;
							//alert(attacker2);
							if(apro01=="king"){
								ahps01=100;
							}else if(apro01=="queen"){
								ahps01=90;
							}else if(apro01=="rook"){
								ahps01=30;
							}else if(apro01=="knight"){
								ahps01=20;
							}else if(apro01=="bishop"){
								ahps01=10;
							}else{
								ahps01=10;
							}

							if(apro02=="king"){
								ahps02=100;
							}else if(apro02=="queen"){ 
								ahps02=90;
							}else if(apro02=="rook"){
								ahps02=30;
							}else if(apro02=="knight"){ 
								ahps02=20;
							}else if(apro02=="bishop"){
								ahps02=10;
							}else{
								ahps02=10;
							}
							
							if(attacker1>=ahp2){
								//alert("ss");
								var bapos = cpi.pos;
								//alert(bapos);
								kan[ground-1].rhero.hp=0;
								$("#ghp2").text("HP:0/"+ahps02);
								$(".gaze2").width("0");
								$("#rhp").hide();
								$("#rival").attr("style","opacity:0;");
								$("#"+kan[bapos-1].rhero.id).remove();
								bacount=0;
								var adgid = document.getElementById("g"+bapos);
								adgid.removeChild(adgid.lastChild);
								if(attacker2>=ahp1){
                                    socket.emit('all kill',yousd,kan[bapos-1].bhero.id,kan[bapos-1].rhero.id,kan[bapos-1].bhero.pos);
                                    sikabane[sika_inc++]=kan[bapos-1].rhero;
                                    
                                    var jumon = "#g"+bapos+'>.sturn'; 
                                    $(jumon).remove();
                                    kan[bapos-1].sturn="false";
                                    kan[bapos-1].sturn_count=0;
                                    socket.emit('release sturn', bapos, yousd);
                                    $("#g"+kan[bapos-1].bhero.pos).children('.bpsta').remove();
									cpi.hp=0;
                                    var ctype = cpi.pro;
									$("#ghp").text("HP:0/"+cpi.ori_hp);
								    $(".gaze").width("0");
									$("#hhp").hide();
									$("#"+kan[bapos-1].bhero.id).remove();
									$("#hero").attr("style","opacity:0;");
									kan[bapos-1].bhero=null;
									cid=null;
									cpi=null;
									epass="flase";
									kan[bapos-1].count-=20;
									kan[bapos-1].bhero=null;
                                    
                                    if(sikabane[sika_inc-1].pro!="king"){
                                        sikabane[sika_inc-1].hp=sikabane[sika_inc-1].ori_hp;
                                        sikabane[sika_inc-1].attack=sikabane[sika_inc-1].ori_attack; 
                                    }
								}else{
                                    socket.emit('red kill',yousd,kan[bapos-1].bhero.id,kan[bapos-1].rhero.id,kan[bapos-1].bhero.pos);
                                    sikabane[sika_inc++]=kan[bapos-1].rhero;
                                    
                                    var jumon = "#g"+bapos+'>.sturn'; 
                                    $(jumon).remove();
                                    kan[bapos-1].sturn="false";
                                    kan[bapos-1].sturn_count=0;
                                    socket.emit('release sturn', bapos, yousd);
									cpi.hp=cpi.hp-attacker2;
									//alert(cpi.hp);
									var cbhp = cpi.hp;
									var pbhp = cpi.hp/ahps01*100;
                                    var ctype2 = cpi.pro;
									$("#ghp").text("HP:"+cbhp+"/"+cpi.ori_hp);
									$(".gaze").width(pbhp+"%");
									$("#"+kan[bapos-1].bhero.id).attr("style","opacity:1;");
                                    $("#g"+kan[bapos-1].bhero.pos).children('.bpsta').children('.p_hp').text(''+cpi.hp);
									$("#g"+kan[bapos-1].bhero.pos).children('.bpsta').show();
									$("#g"+kan[bapos-1].bhero.pos).children('.bpsta').attr("style","opacity:1;");
                                    
                                    if(sikabane[sika_inc-1].pro!="king"){
                                        sikabane[sika_inc-1].hp=sikabane[sika_inc-1].ori_hp;
                                        sikabane[sika_inc-1].attack=sikabane[sika_inc-1].ori_attack;
                                    }
								}
                                kan[bapos-1].rhero=null;
								kan[bapos-1].count-=10; 
								
							}
							else if(attacker1<ahp2){ 
								var bapos2 = cpi.pos;
                                //alert(cpi.name); 
								if(attacker2>=ahp1){ 
                                    socket.emit('blue kill',yousd,kan[bapos2-1].bhero.id,kan[bapos2-1].rhero.id,kan[bapos2-1].bhero.pos);
                                    $("#g"+kan[bapos2-1].rhero.pos).children('.bpsta').remove();
									$("#g"+kan[bapos2-1].rhero.pos).children('.rpsta').children('.p_hp').text(ahp2-attacker1+'');
									$("#g"+kan[bapos2-1].rhero.pos).children('.rpsta').show();
                                    $("#g"+kan[bapos2-1].rhero.pos).children('.rpsta').attr("style","opacity:1;");
									cpi.hp=0;
                                    ctype3=cpi.pro;
									$("#ghp").text("HP:0/"+cpi.ori_hp);
									$(".gaze").width("0");
									$("#hhp").hide();
									$("#"+kan[bapos2-1].bhero.id).remove();
									$("#hero").attr("style","opacity:0;");
									kan[bapos2-1].bhero=null;
									$("#"+cid).remove();
									cid=null;
									cpi=null;
									epass="flase";
									kan[bapos2-1].count-=20;
									var edgid = document.getElementById("g"+bapos2); 
									edgid.removeChild(edgid.lastChild);
									$("#"+kan[bapos2-1].rhero.id).attr("style","opacity:1;");
                                    if(ctype3=="king"){
                                        //socket.emit('you win', yousd); 
                                    }
								}else{
                                    socket.emit('two attack',yousd,kan[bapos2-1].bhero.id,kan[bapos2-1].rhero.id,kan[bapos2-1].bhero.pos);
									cpi.hp-=attacker2;
									var attackedhp = cpi.hp/cpi.ori_hp*100;
									$("#ghp").text("HP:"+cpi.hp+"/"+cpi.ori_hp);
									$(".gaze").width(attackedhp+"%");
                                    $("#g"+kan[bapos2-1].bhero.pos).children('.bpsta').children('.p_hp').text(''+cpi.hp);
								}
								kan[bapos2-1].rhero.hp-=attacker1;
								var damagedhp = kan[bapos2-1].rhero.hp/kan[bapos2-1].rhero.ori_hp*100;
								$("#ghp2").text("HP:"+kan[bapos2-1].rhero.hp+"/"+kan[bapos2-1].rhero.ori_hp);
								$(".gaze2").width(damagedhp+"%");
                                $("#g"+kan[bapos2-1].rhero.pos).children('.rpsta').children('.p_hp').text(ahp2-attacker1+'');
							}
							if(rking.hp==0 && bking.hp==0){
								socket.emit('you draw', yousd);
                                
							}
							else if(rking.hp==0){
								socket.emit('you lose', yousd);
                                
							}else if(bking.hp==0){
								socket.emit('you win', yousd); 
                                
							}
                        }
						}else{
							console.log("check your battle state.");
						}
					}else{
						console.log("this is not your turn.");
					}
            }
        }
        }
    }
    function get_hero(sn,team){ 
        console.log(sn);
        console.log(kan[sn-1].rhero.name);
        if(team=="r"){
            return kan[sn-1].rhero.id;
        }else{
             return kan[sn-1].bhero.id;
        }
    }
    function closing(){
        $('#cutton').css('display','none');
        swit="true";
        cid=null;
        cpi=null;
        $(".mirai").hide();
        grandc="false";
    }
    function set_c(rsn){
        cid = kan[rsn-1].bhero.id;
        cpi = kan[rsn-1].bhero;
    }
    function check_hero(target){
        var x;
        for(x=0; x<64; x++){ 
            //console.log("target : "+target);
            if(kan[x].bhero!=null){
                if(kan[x].bhero.name==target){
                    break;
                }
            }
        }
        return x;
    }
    function round_huda(){
        if(hudacount>=47){
            hudacount=-1;
            shuffle_huda();
        }
        var chuc=hudacount;
        var chuu=0;
        $("#huda1").attr("src",chuda[hudacount+1].src);
        $("#huda2").attr("src",chuda[hudacount+2].src);
        $("#huda3").attr("src",chuda[hudacount+3].src);
        $("#huda4").attr("src",chuda[hudacount+4].src);
        $("#huda5").attr("src",chuda[hudacount+5].src);
        $("#huda6").attr("src",chuda[hudacount+6].src);
        $("#huda7").attr("src",chuda[hudacount+7].src);
        $("#huda8").attr("src",chuda[hudacount+8].src);
        $("#cost_1").html(chuda[hudacount+1].cost);
        $("#cost_2").html(chuda[hudacount+2].cost);
        $("#cost_3").html(chuda[hudacount+3].cost);
        $("#cost_4").html(chuda[hudacount+4].cost);
        $("#cost_5").html(chuda[hudacount+5].cost);
        $("#cost_6").html(chuda[hudacount+6].cost);
        $("#cost_7").html(chuda[hudacount+7].cost);
        $("#cost_8").html(chuda[hudacount+8].cost);
        
        for(var i=hudacount+1; i<=chuc+8; i++){
                hucard[chuu++]=chuda[i];
            }
        hudacount=hudacount+8; 
    }
    function shuffle_huda(){
        var j, x, i;
        for (i = chuda.length; i; i -= 1) {
            j = Math.floor(Math.random() * i);
            x = chuda[i - 1];
            chuda[i - 1] = chuda[j];
            chuda[j] = x;
        }
    }
    function retry_setting(){
        document.getElementById('jk').pause();
        $("#setting").hide();
        $("#back_img").hide();
        for(var a=0;a<64;a++){
            kan[a].rhero=null;
            kan[a].bhero=null;
            kan[a].count=0;
            kan[a].btrap=null;
            kan[a].bstrap=null;
            kan[a].rtrap=null;
            kan[a].rstrap=null; 
        }
        cid=null;
        cpi=null;
        grandc=="false";
        swit="true";
        hudacount=0;
        done_num = 1;
        done_id=null;
        isgame = "false";
        isSelecthuda='false';
        kan = new Array();
        chuda = new Array();
        
        l_count=0;
        //room_check=false;
        m_turn=null;
        pass="false";
        psrc=null;
        pid=null;
        pname=null;
    
        epass="false";
        gplace=null;
    
        bswitch="true";
        bacount=0;
        stone = "true";
        d_click="true";
        timer=null;
        f_check = "true";
        turn_c = 0;
        onepiece=false;
        de_cost = 6;
        turn_count=0;
        
        start_condition=1;
        done_ready=1;
        hucard = new Array();
        hsn=null;
        
        sikabane = new Array();
        sika_inc=0;
        sika_forth = new Array();
        sika_count=0;
        yeto = 1;
        rival_sika = new Array();
        r_sika_count = 0;
        
        bking=null;
        rking=null;
        rqueen=null;
        bqueen=null; 
        rb01=null;
        rb02=null;
        bb01=null;
        bb02=null;
        rk01=null;
        rk02=null;
        bk01=null;
        bk02=null;
        rl01=null; 
        rl02=null;
        bl01=null;
        bl02=null;
        rp01=null;
        rp02=null;
        rp03=null;
        rp04=null;
        rp05=null;
        rp06=null;
        rp07=null;
        rp08=null;
        bp01=null;
        bp02=null;
        bp03=null;
        bp04=null;
        bp05=null;
        bp06=null;
        bp07=null;
        bp08=null;
        live1=null;
        live2=null;
        img_firstation();
        set_waitview();
        bhuda_opacity();
        
        //release_range_attack();
    }
    function img_firstation(){
        for(var i=1; i<65; i++){
            //$("#g"+i).empty();
            var cell = document.getElementById("g"+i); 
            while ( cell.hasChildNodes() ) { 
                cell.removeChild( cell.firstChild ); 
            }
        }
        
        for(var j=1; j<65; j++){
            var mira = document.createElement('div');
            mira.setAttribute("class","mirai");
            document.getElementById("g"+j).appendChild(mira);
        }
        
    }
    function set_waitview(){
        $("#daichi").hide();
        $("#main_view").show();
        $("#ready").hide();
        
    }
    function sturn_check(){
        for(var i=0; i<64; i++){
            if(kan[i].sturn_count>0){
                var chck_count = kan[i].sturn_count-1;
                if(chck_count==0 && kan[i].count==20){
                    var num = i+1;
                    var jumon = "#g"+num+'>.sturn';
                    $(jumon).remove();
                    kan[i].sturn="false";
                    kan[i].sturn_count=0;
                    socket.emit('release sturn', num, yousd);
                }else{
                    kan[i].sturn_count=kan[i].sturn_count-1;
                }
            }
        }
    }
    function degeki(){
        
        swit="false";
        for(var i=0;i<63;i++){
				if(kan[i].count==10 && kan[i].sturn!="true"){
                        
				    var num = i+1;
				    var te='g'+num;
				    var cstad = document.createElement('div');
				    cstad.setAttribute("class","kaminari");
                    document.getElementById(te).appendChild(cstad);
				}
        }
        $(".kaminari").on("click",function(e){
				var plid = $(e.target).parent().attr("id")+"";
                var trid = plid.substring(1).trim();
                var trnum = parseInt(trid);
                kan[trnum-1].sturn="true";
                kan[trnum-1].sturn_count=1;
				var cstad2 = document.createElement('div');
				cstad2.setAttribute("class","sturn");
				$(".kaminari").remove();
                document.getElementById(plid).appendChild(cstad2);
                swit="true";
                socket.emit('sturn hero', trnum, yousd);
        });
    }
    function bhuda_opacity(){
        for(var i=1; i<9; i++){
            $("#bhuda"+i).css("opacity",0.0);
        }
    }
    function mind_control(){
        swit="false";
        for(var i=0;i<63;i++){
				if(kan[i].count==10 && kan[i].sturn!="true" && kan[i].rhero.pro!="king"){
                        
				    var num2 = i+1;
				    var te2='g'+num2;
				    var cstad2 = document.createElement('div');
				    cstad2.setAttribute("class","erabi");
                    document.getElementById(te2).appendChild(cstad2);
				}
        }
        $(".erabi").on("click",function(e){
				//$(e.target).
				var eplid = $(e.target).parent().attr("id")+"";
				var est = eplid.substring(1).trim();
				var esn = parseInt(est);
				kan[esn-1].bhero = kan[esn-1].rhero;
				kan[esn-1].rhero = null;
				kan[esn-1].count = kan[esn-1].count-10+20;
				var mindid = kan[esn-1].bhero.id;
				var mmid = kan[esn-1].bhero;
				mmid.team='b';
				swit="true";
				$("#g"+esn+">#"+mindid).remove();
                $("#g"+esn+">.rpsta").remove();
				var ecstad2 = document.createElement('img');
				ecstad2.setAttribute("src",mmid.src);
				ecstad2.setAttribute("class",mmid.pro);
				ecstad2.setAttribute("id",mindid);
				document.getElementById("g"+esn).appendChild(ecstad2);
            
                var pstad = document.createElement('div');
				pstad.setAttribute("class","bpsta");
				document.getElementById("g"+esn).appendChild(pstad);
				var p_hpd = document.createElement('a');
				p_hpd.setAttribute("class","p_hp");
				var p_text = document.createTextNode(''+mmid.hp);
				p_hpd.appendChild( p_text );
				$("#g"+esn).children(".bpsta").append(p_hpd);
            
				var p_prod = document.createElement('div');
				p_prod.setAttribute("class","p_pro");
				$("#g"+esn).children(".bpsta").append(p_prod);
				var ksrc = getpro_img(mmid.pro,'b');
				$("#g"+esn+">.bpsta>.p_pro").css("background-image",'url('+ksrc+')');
            
				var p_atd = document.createElement('a');
				p_atd.setAttribute("class","p_attack");
				var p_text3 = document.createTextNode(''+mmid.attack); 
				p_atd.appendChild( p_text3 );
				$("#g"+esn).children(".bpsta").append(p_atd); 

				$("#"+mindid).click( function() {

				    if(grandc=="false"){
							cid = mindid;
							cpi = kan[esn-1].bhero;
							epass="true";
				    }
				    if(swit=="true"){
                        var ehero = document.getElementById( mindid ).getAttribute('src');
                        $('#cutton').css('display','block');
                        swit="false";
                        $("#hero").attr('src', ehero);
                        $("#hero").attr('style', "opacity:1");
                        if(kan[esn-1].count!=30) {
                            //$("#hero").attr('src', "./black.jpg");
                            $("#rival").attr('style', "opacity:0");
                            $("#rhp").hide();
                            $("#hhp").show();
                            var rhp = mmid.hp/mmid.ori_hp;
                            $("#ghp").text("HP:"+mmid.hp+"/"+mmid.ori_hp);
                            $(".gaze").width(rhp*100+"%");
                            if(mmid.hp>mmid.ori_hp){
                                $(".gaze").width(100+"%");
                            }
                        }else{
                                $("#rival").attr('style', "opacity:1");
                            }
				    }else{
							$('#cutton').css('display','none');
							swit="true";
				    }
				});	
				$(".erabi").remove();
                socket.emit('mind control', esn, yousd);
        });
    }
    function sikabane_show(){
        swit="false";
        if(sika_count+3>sikabane.length-1){
                var x =  sikabane.length-sika_count;
                $("#dead_hero1").hide();
                $("#dead_hero2").hide();
                $("#dead_hero3").hide();
                $("#dead_hero4").hide();
                for(var i=0;i<x;i++){
                    var j = i+1;
                    sika_forth[i]=sikabane[sika_count+i]; 
                    $("#dead_hero"+j+">img").attr("src",sikabane[sika_count+i].src);
                    $("#dead_hero"+j+">.sika_name").text("name : "+sikabane[sika_count+i].name);
                    $("#dead_hero"+j+">.sika_hp").text("hp : "+sikabane[sika_count+i].hp);
                    $("#dead_hero"+j+">.sika_ak").text("atk : "+sikabane[sika_count+i].attack);
                    $("#dead_hero"+j).show();
                }
           }
        else{
                sika_forth[0]=sikabane[0];
                sika_forth[1]=sikabane[1];
                sika_forth[2]=sikabane[2];
                sika_forth[3]=sikabane[3];
                $("#dead_hero1>img").attr("src",sikabane[0].src);
                $("#dead_hero1>.sika_name").text("name : "+sikabane[0].name);
                $("#dead_hero1>.sika_hp").text("hp : "+sikabane[0].hp);
                $("#dead_hero1>.sika_ak").text("atk : "+sikabane[0].attack);
                $("#dead_hero2>img").attr("src",sikabane[1].src);
                $("#dead_hero2>.sika_name").text("name : "+sikabane[1].name);
                $("#dead_hero2>.sika_hp").text("hp : "+sikabane[1].hp);
                $("#dead_hero2>.sika_ak").text("atk : "+sikabane[1].attack);
                $("#dead_hero3>img").attr("src",sikabane[2].src);
                $("#dead_hero3>.sika_name").text("name : "+sikabane[2].name);
                $("#dead_hero3>.sika_hp").text("hp : "+sikabane[2].hp);
                $("#dead_hero3>.sika_ak").text("atk : "+sikabane[2].attack);
                $("#dead_hero4>img").attr("src",sikabane[3].src);
                $("#dead_hero4>.sika_name").text("name : "+sikabane[3].name);
                $("#dead_hero4>.sika_hp").text("hp : "+sikabane[3].hp);
                $("#dead_hero4>.sika_ak").text("atk : "+sikabane[3].attack);
           }
        
        $("#sikaba").show();
    }
    function magical_hat(){
        $("#silkhat").show();
    }
    function set_magical_hat(){
        swit="false";
        for(var i = 0; i<64; i++){
            if(kan[i].count==20){
				var num = i+1;
				var te='g'+num;
				var cstad = document.createElement('div');
				cstad.setAttribute("class","armor");
                document.getElementById(te).appendChild(cstad);
            }
        }
        $(".armor").click("click",function(er){
            swit="true";
            var hid = $(er.target).parent().attr("id");
            var did = parseInt(hid.substring(1));
            var val = Math.floor(Math.random() * 5) + 1;
            kan[did-1].bhero.armor = val;
            $(".armor").remove();
            socket.emit('inhence armor', yousd, did, val);
        });
    }
    function i_lose(){
        alert("you lose");
        $("#cutton").hide();
        retry_setting();
    }
    function change_ha(){
        swit="false";
        for(var i = 0; i<64; i++){
            if(kan[i].count==10){
				var num = i+1;
				var te='g'+num;
				var cstad = document.createElement('div');
				cstad.setAttribute("class","change_ha");
                document.getElementById(te).appendChild(cstad);
            }
        }
        $(".change_ha").click("click",function(er){
            swit="true";
            var hid = $(er.target).parent().attr("id");
            var did = parseInt(hid.substring(1)); 
            var b_hp = kan[did-1].rhero.hp;
            var b_attack = kan[did-1].rhero.attack;
            kan[did-1].rhero.hp = b_attack;
            kan[did-1].rhero.attack = b_hp;
            $(".change_ha").remove();
            $("#g"+kan[did-1].rhero.pos).children('.rpsta').children('.p_hp').text(kan[did-1].rhero.hp);
            $("#g"+kan[did-1].rhero.pos).children('.rpsta').children('.p_attack').text(kan[did-1].rhero.attack);
            socket.emit('change hp_attack', yousd, did);
        });
    }
    function change_ah(pos){
        var dpos = 64-pos+1;
        var ba_hp = kan[dpos-1].bhero.hp;
        var ba_attack = kan[dpos-1].bhero.attack;
        kan[dpos-1].bhero.hp = ba_attack;
        kan[dpos-1].bhero.attack = ba_hp;
        
        $("#g"+kan[dpos-1].bhero.pos).children('.bpsta').children('.p_hp').text(kan[dpos-1].bhero.hp);
        $("#g"+kan[dpos-1].bhero.pos).children('.bpsta').children('.p_attack').text(kan[dpos-1].bhero.attack);
    }
    function set_obstacle(){
        swit="false";
        for(var i = 0; i<64; i++){
            if(kan[i].count==0){
				var num = i+1;
				var te='g'+num;
				var cstad = document.createElement('div');
				cstad.setAttribute("class","set_obstacle");
                document.getElementById(te).appendChild(cstad);
            
            }
        }
        $(".set_obstacle").click("click",function(er){
            swit="true";
            var hid = $(er.target).parent().attr("id");
            var did = parseInt(hid.substring(1)); 
            var ecstad2 = document.createElement('img');
            ecstad2.setAttribute("src","./pub/board/obser.jpg");
            ecstad2.setAttribute("class","obstacle");
            document.getElementById("g"+did).appendChild(ecstad2);
            kan[did-1].count=30;
            kan[did-1].ob_count=2;
            $(".set_obstacle").remove();
            socket.emit('set obstacle', yousd, did);
            
        });
    }
    function set_obtwo(pos){
        var rpos = 64-pos+1;
        var ecstad2 = document.createElement('img');
        ecstad2.setAttribute("src","./pub/board/obser.jpg");
        ecstad2.setAttribute("class","obstacle");
        document.getElementById("g"+rpos).appendChild(ecstad2);
        kan[rpos-1].ob_count=2;
        kan[rpos-1].count=30;
    }
    function obstacle_check(){
        for(var i=0; i<64; i++){
            if(kan[i].ob_count>0){
                kan[i].ob_count-=1;
                if(kan[i].ob_count==0){
                    var count = i+1;
                    $("#g"+count).children('.obstacle').remove();
                    kan[i].count=0;
                    socket.emit('delete obstacle', yousd, count);
                }
            }
        }
    }
    function delete_obstacle(pos){
        var rpos = 64-pos+1;
        $("#g"+rpos).children('.obstacle').remove();
        kan[rpos-1].ob_count = 0;
        kan[rpos-1].count=0;
    }
    function getpro_img(pro,team){
        var src;
        if(pro=="king"){
            if(team=='b'){
                src = "pub/Type_Img/King.png"
            }else if(team=='r'){
                src = "pub/Type_Img/King_2.png"
            }
        }else if(pro=="queen"){
            if(team=='b'){
                src = "pub/Type_Img/Queen.png"
            }else if(team=='r'){
                src = "pub/Type_Img/Queen_2.png"
            }
        }else if(pro=="knight"){
            if(team=='b'){
                src = "pub/Type_Img/Knight.png"
            }else if(team=='r'){
                src = "pub/Type_Img/Knight_2.png"
            }
        }else if(pro=="rook"){
            if(team=='b'){
                src = "pub/Type_Img/Rook.png"
            }else if(team=='r'){
                src = "pub/Type_Img/Rook_2.png"
            }
        }else if(pro=="bishop"){
            if(team=='b'){
                src = "pub/Type_Img/Bishop.png"
            }else if(team=='r'){
                src = "pub/Type_Img/Bishop_2.png"
            }
        }else if(pro=="phone"){
            if(team=='b'){
                src = "pub/Type_Img/Pawn.png"
            }else if(team=='r'){
                src = "pub/Type_Img/Pawn_2.png"
            }
        }
        return src;
    }
    function excalibur(name){
        live1 = parseInt(check_hero_here(name));
        console.log("hero : "+live1);
        excaribur_damage=kan[live1].bhero.attack;
        //var ex_kan = kan;
        if(live1!=null){
            //alert(live);
            $("#set_arrow").show();
        }
    }
    function one_directionAttack(name,num){ 
        live1 = parseInt(check_hero_here(name));
        excaribur_damage=num;
        console.log("hero : "+live1);
        //var ex_kan = kan;
        if(live1!=null){
            //alert(live);
            $("#set_arrow").show();
        }
    }
    function range_attack(name,num,count){ 
        live2 = parseInt(check_hero_here(name));
        console.log("hero : "+live2);
        range_damage=num;
        range_count=count;
        console.log("count : "+count);
        //var ex_kan = kan;
        if(live2!=null){
            //alert(live);
            $("#set_arrow2").show();
        }
    }
    function check_hero_here(hname){
        var check=null;
        for(var i in kan){
            if(kan[i].count==20){
                if(kan[i].bhero.name==hname)
                    check=i;
            }
        }
        return check;
    }
    function all_commit_hp(team,num){
        if(team=="r"){
            for(var i in kan){
                if(kan[i].get_count()==10){
                    //kan[i].rhero.hp-=num;
                    if(kan[i].rhero.hp<=num){
                        kan[i].rhero.hp=0;
                        var inc_i = i+1;
                        $("#"+kan[i].rhero.id).remove();
                        $("#g"+kan[i].rhero.pos).children('.rpsta').remove();
                        var bbpro = kan[i].rhero.pro;
                        kan[i].rhero=null;
                        kan[i].count-=10;
                        socket.emit('zero rival_hp', yousd, i);
                        if(bbpro=="king"){
                            socket.emit('you lose', yousd);
                            alert("you win");
                            retry_setting();
                        }
                    }else{
                            kan[i].rhero.hp-=num;
                            var increas_i = parseInt(i)+1;
                            $("#g"+increas_i).children('.rpsta').children('.p_hp').text(kan[i].rhero.hp);
                            socket.emit('part attack', yousd, i, num,'r');
                    }
                }
            }
        }else{
            for(var i in kan){
                if(kan[i].get_count()==20){
                    //kan[i].bhero.hp+=num;
                    if(kan[i].bhero.hp<=num){
                        kan[i].bhero.hp=0;
                        $("#"+kan[i].bhero.id).remove();
                        $("#g"+kan[i].bhero.pos).children('.bpsta').remove();
                        var bbpro = kan[i].bhero.pro;
                        var bbpos = kan[i].bhero.pos;
                        kan[i].bhero=null;
                        kan[i].count-=20;
                        socket.emit('zero hp', yousd, bbpos);
                        if(bbpro=="king"){
                            socket.emit('you win', yousd);
                            alert("you lose");
                            retry_setting();
                        }
                    }else{
                            kan[i].bhero.hp-=num;
                            var increas_i2 = parseInt(i)+1;
                            $("#g"+increas_i2).children('.bpsta').children('.p_hp').text(kan[i].bhero.hp);
                            socket.emit('part attack', yousd, i, num,'b');
                    }
                }
            }
        }
    }
    function all_commit_attack(team,num){
        if(team=="r"){
            for(var i in kan){
                if(kan[i].get_count()==10){
                    //kan[i].rhero.attack-=num;
                    if(kan[i].rhero.attack<=num){
                            kan[i].rhero.attack=0;
                            var increas_i = parseInt(i)+1;
                            $("#g"+increas_i).children('.rpsta').children('.p_attack').text(0);
                            socket.emit('part debuff', yousd, i, num,'r');
                    }else{
                            kan[i].rhero.attack-=num;
                            var increas_i2 = parseInt(i)+1;
                            $("#g"+increas_i2).children('.rpsta').children('.p_attack').text(kan[i].rhero.attack);
                            socket.emit('part debuff', yousd, i, num,'r');
                    }
                }
            }
        }else{
            for(var i in kan){
                if(kan[i].get_count()==20){
                    //kan[i].bhero.attack+=num;
                    if(kan[i].bhero.attack<=num){
                            kan[i].bhero.attack=0;
                            var increas_i3 = parseInt(i)+1;
                            $("#g"+increas_i3).children('.bpsta').children('.p_attack').text(0);
                            socket.emit('part debuff', yousd, i, num,'b');
                    }else{
                            kan[i].bhero.attack-=num;
                            var increas_i4 = parseInt(i)+1;
                            $("#g"+increas_i4).children('.bpsta').children('.p_attack').text(kan[i].bhero.attack);
                            socket.emit('part debuff', yousd, i, num,'b');
                    }
                }
            }
        }
    }
    function release_range_attack(){
        $("#upper_arrow").removeEventListener("click");
        $("#downfer_arrow").removeEventListener("click");
        $("#righter_arrow").removeEventListener("click");
        $("#lefter_arrow").removeEventListener("click");
        
        $("#upper_arrow2").removeEventListener("click");
        $("#downfer_arrow2").removeEventListener("click");
        $("#righter_arrow2").removeEventListener("click");
        $("#lefter_arrow2").removeEventListener("click");
        
    }
    function entry_range_click(){
        $("#upper_arrow").click(function(){
            if(live1!=null){
                    $("#set_arrow").hide();
                    
                    for(var i=live1;i>0;i=i-8){
                        if(kan[i].count==10){
                            kan[i].rhero.hp-=excaribur_damage;
                            $("#g"+kan[i].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[i].rhero.hp);
                            if(kan[i].rhero.pro=="king"){
                                    if(kan[i].rhero.hp<=0){
                                        socket.emit('you lose', yousd);
                                        alert("you win");
                                        retry_setting();
                                    }else{
                                        socket.emit('ranged attack',yousd,i,excaribur_damage);
                                    }
                            }else{
                                    if(kan[i].rhero.hp<=0){
                                            console.log(kan[live1].bhero.name);
                                            console.log(kan[i].rhero.hp);
                                            kan[i].count-=10;
                                            $("#g"+kan[i].rhero.pos).children('.rpsta').remove();
                                            $("#"+kan[i].rhero.id).remove();
                                        }
                                    socket.emit('ranged attack',yousd,i,excaribur_damage);
                            }
                        }
                    }
                    live1=null;
                }
            });
        $("#downfer_arrow").click(function(){
            if(live1!=null){
                    $("#set_arrow").hide();
                    var j=live1;
                    while(j<64){
                        if(kan[j].count==10){
                                console.log("r:"+kan[j].rhero.name);
                                kan[j].rhero.hp-=excaribur_damage;
                                $("#g"+kan[j].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[j].rhero.hp);
                                if(kan[j].rhero.pro=="king"){
                                        if(kan[j].rhero.hp<=0){
                                            socket.emit('you lose', yousd);
                                            alert("you win");
                                            retry_setting();
                                        }else{
                                            socket.emit('ranged attack',yousd,j,excaribur_damage);
                                        }
                                }else{
                                        if(kan[j].rhero.hp<=0){
                                            kan[j].count-=10;
                                            $("#g"+kan[j].rhero.pos).children('.rpsta').remove();
                                            $("#"+kan[j].rhero.id).remove();
                                        }
                                        socket.emit('ranged attack',yousd,j,excaribur_damage);
                                }
                            }
                        j=j+8;
                    }
                    live1=null;
                }
            });
        $("#righter_arrow").click(function(){
            if(live1!=null){
                    $("#set_arrow").hide();
                    var i=0;
                    for(i=live1;(i%8)!=7;i++){
                        if(kan[i].count==10){
                            kan[i].rhero.hp-=excaribur_damage;
                            $("#g"+kan[i].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[i].rhero.hp);
                            if(kan[i].rhero.pro=="king"){
                                    if(kan[i].rhero.hp<=0){
                                        socket.emit('you lose', yousd);
                                        alert("you win");
                                        retry_setting();
                                    }else{
                                        socket.emit('ranged attack',yousd,i,excaribur_damage);
                                    }
                            }else{
                                    if(kan[i].rhero.hp<=0){
                                            kan[i].count-=10;
                                            $("#g"+kan[i].rhero.pos).children('.rpsta').remove();
                                            $("#"+kan[i].rhero.id).remove();
                                        }
                                    socket.emit('ranged attack',yousd,i,excaribur_damage);
                            }
                        }
                    }
                    if(kan[i].count==10){
                            kan[i].rhero.hp-=excaribur_damage;
                            $("#g"+kan[i].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[i].rhero.hp);
                            if(kan[i].rhero.pro=="king"){
                                    if(kan[i].rhero.hp<=0){
                                        socket.emit('you lose', yousd);
                                        alert("you win");
                                        retry_setting();
                                    }else{
                                        socket.emit('ranged attack',yousd,i,excaribur_damage);
                                    }
                            }else{
                                    if(kan[i].rhero.hp<=0){
                                            kan[i].count-=10;
                                            $("#g"+kan[i].rhero.pos).children('.rpsta').remove();
                                            $("#"+kan[i].rhero.id).remove();
                                        }
                                    socket.emit('ranged attack',yousd,i,excaribur_damage);
                            }
                    }
                    live1=null;
                }
            });
        $("#lefter_arrow").click(function(){
            if(live1!=null){
                    $("#set_arrow").hide();
                    var i=0;
                    for(i=live1;(i%8)!=0;i--){
                        if(kan[i].count==10){
                            kan[i].rhero.hp-=excaribur_damage;
                            $("#g"+kan[i].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[i].rhero.hp);
                            if(kan[i].rhero.pro=="king"){
                                    if(kan[i].rhero.hp<=0){
                                        socket.emit('you lose', yousd);
                                        alert("you win");
                                        retry_setting();
                                    }else{
                                        socket.emit('ranged attack',yousd,i,excaribur_damage);
                                    }
                            }else{
                                    if(kan[i].rhero.hp<=0){
                                            kan[i].count-=10;
                                            $("#g"+kan[i].rhero.pos).children('.rpsta').remove();
                                            $("#"+kan[i].rhero.id).remove();
                                        }
                                    socket.emit('ranged attack',yousd,i,excaribur_damage);
                            }
                        }
                    }
                    if(kan[i].count==10){
                            kan[i].rhero.hp-=excaribur_damage;
                            $("#g"+kan[i].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[i].rhero.hp);
                            if(kan[i].rhero.pro=="king"){
                                    if(kan[i].rhero.hp<=0){
                                        socket.emit('you lose', yousd);
                                        alert("you win");
                                        retry_setting();
                                    }else{
                                        socket.emit('ranged attack',yousd,i,excaribur_damage);
                                    }
                            }else{
                                    if(kan[i].rhero.hp<=0){
                                            kan[i].count-=10;
                                            $("#g"+kan[i].rhero.pos).children('.rpsta').remove();
                                            $("#"+kan[i].rhero.id).remove();
                                        }
                                    socket.emit('ranged attack',yousd,i,excaribur_damage);
                            }
                    }
                    live1=null;
                }
            });
        
        $("#upper_arrow2").click(function(){
            if(live2!=null){
                    var num=-1;
                    $("#set_arrow2").hide();
                    for(var i=parseInt(live2);i>=0;i=i-8){
                        num++;
                        if(kan[i].count==10){
                            console.log("range2 : "+kan[i].rhero.name+num);
                            console.log("range2 : "+kan[i].rhero.name+range_count);
                            if(num==range_count){
                                console.log("range : "+kan[i].rhero.name);
                                kan[i].rhero.hp-=range_damage;
                                $("#g"+kan[i].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[i].rhero.hp);
                                if(kan[i].rhero.pro=="king"){
                                    if(kan[i].rhero.hp<=0){
                                        socket.emit('you lose', yousd);
                                        alert("you win");
                                        retry_setting();
                                    }else{
                                        socket.emit('ranged attack',yousd,i,range_damage);
                                    }
                                }else{
                                    if(kan[i].rhero.hp<=0){
                                        kan[i].count-=10;
                                        $("#g"+kan[i].rhero.pos).children('.rpsta').remove();
                                        $("#"+kan[i].rhero.id).remove();
                                    }
                                    socket.emit('ranged attack',yousd,i,range_damage);
                                }
                            }
                        }

                    }
                    live2=null;
                }
                
            });
        $("#downfer_arrow2").click(function(){
            if(live2!=null){
                    var num=-1;
                    $("#set_arrow2").hide();
                    var j=live2;
                    while(j<64){
                        num=-1;
                        if(kan[j].count==10){
                                if(range_count==num){
                                    //console.log("r:"+kan[j].rhero.name);
                                    kan[j].rhero.hp-=range_damage;
                                    $("#g"+kan[j].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[j].rhero.hp);
                                    if(kan[j].rhero.pro=="king"){
                                        if(kan[j].rhero.hp<=0){
                                            socket.emit('you lose', yousd);
                                            alert("you win");
                                            retry_setting();
                                        }else{
                                            socket.emit('ranged attack',yousd,j,range_damage);
                                        }
                                    }else{
                                        if(kan[j].rhero.hp<=0){
                                            kan[j].count-=10;
                                            $("#g"+kan[j].rhero.pos).children('.rpsta').remove();
                                            $("#"+kan[j].rhero.id).remove();
                                        }
                                        socket.emit('ranged attack',yousd,j,range_damage);
                                    }
                                }   
                            }
                        j=j+8;
                    }
                    live2=null;
                }
            });
        $("#righter_arrow2").click(function(){
            if(live2!=null){
                    var num=-1;
                    $("#set_arrow2").hide();
                    var i=0;
                    for(i=live2;(i%8)!=7;i++){
                        num++;
                        if(kan[i].count==10){
                            if(range_count==num){
                                kan[i].rhero.hp-=range_damage;
                                $("#g"+kan[i].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[i].rhero.hp);
                                if(kan[i].rhero.pro=="king"){
                                    if(kan[i].rhero.hp<=0){
                                        socket.emit('you lose', yousd);
                                        alert("you win");
                                        retry_setting();
                                    }else{
                                        socket.emit('ranged attack',yousd,i,range_damage);
                                    }
                                }else{
                                    if(kan[i].rhero.hp<=0){
                                            kan[i].count-=10; 
                                            $("#g"+kan[i].rhero.pos).children('.rpsta').remove();
                                            $("#"+kan[i].rhero.id).remove();
                                    }
                                    socket.emit('ranged attack',yousd,i,range_damage);
                                }
                            }
                        }
                    }
                    if(kan[i].count==10){
                        num++;
                        if(range_count==num){
                            kan[i].rhero.hp-=range_damage;
                            $("#g"+kan[i].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[i].rhero.hp);
                            if(kan[i].rhero.pro=="king"){
                                    if(kan[i].rhero.hp<=0){
                                        socket.emit('you lose', yousd);
                                        alert("you win");
                                        retry_setting();
                                    }else{
                                        socket.emit('ranged attack',yousd,i,range_damage);
                                    }
                            }else{
                                    if(kan[i].rhero.hp<=0){
                                            kan[i].count-=10;
                                            $("#g"+kan[i].rhero.pos).children('.rpsta').remove();
                                            $("#"+kan[i].rhero.id).remove();
                                    }
                                    socket.emit('ranged attack',yousd,i,range_damage);
                            }
                        }
                    }
                    live2=null;
                }
            });
        $("#lefter_arrow2").click(function(){
            if(live2!=null){
                    var num=-1;
                    $("#set_arrow2").hide();
                    var i=0;
                    for(i=live2;(i%8)!=0;i--){
                        num++;
                        if(kan[i].count==10){
                            if(range_count==num){
                                kan[i].rhero.hp-=range_damage;
                                $("#g"+kan[i].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[i].rhero.hp);
                                if(kan[i].rhero.pro=="king"){
                                    if(kan[i].rhero.hp<=0){
                                        socket.emit('you lose', yousd);
                                        alert("you win");
                                        retry_setting();
                                    }else{
                                        socket.emit('ranged attack',yousd,yousd,i,range_damage);
                                    }
                                }else{
                                    if(kan[i].rhero.hp<=0){
                                            kan[i].count-=10;
                                            $("#g"+kan[i].rhero.pos).children('.rpsta').remove();
                                            $("#"+kan[i].rhero.id).remove();
                                        }
                                    socket.emit('ranged attack',yousd,yousd,i,range_damage);
                                }
                            }
                        }
                    }
                    if(kan[i].count==10){
                        num++;
                        if(range_count==num){
                            kan[i].rhero.hp-=range_damage;
                            $("#g"+kan[i].rhero.pos).children('.rpsta').children('.p_hp').text(''+kan[i].rhero.hp);
                            if(kan[i].rhero.pro=="king"){
                                    if(kan[i].rhero.hp<=0){
                                        socket.emit('you lose', yousd);
                                        alert("you win");
                                        retry_setting();
                                    }else{
                                        socket.emit('ranged attack',yousd,i,range_damage);
                                    }
                            }else{
                                    if(kan[i].rhero.hp<=0){
                                            kan[i].count-=10;
                                            $("#g"+kan[i].rhero.pos).children('.rpsta').remove();
                                            $("#"+kan[i].rhero.id).remove();
                                        }
                                    socket.emit('ranged attack',yousd,i,range_damage);
                            }
                        }
                    }
                    live2=null;
                }
                
            });
    }
    function dehp_commit(sn){
        if(kan[sn-1].bhero.hp<=kan[sn-1].rstrap.enumber){
                if(kan[sn-1].count==30){
                    var hzeo2 = document.getElementById("g"+sn);
                    hzeo2.removeChild(hzeo2.lastChild);
                    $("#"+kan[sn-1].bhero.id).attr("style","opacity:1");
                    $("#"+kan[sn-1].bhero.id).show();
                    $("#g"+kan[sn-1].bhero.pos).children('.bpsta').attr("style","opacity:1");
                    $("#g"+kan[sn-1].bhero.pos).children('.bpsta').show();
                }
                kan[sn-1].bhero.hp=0;
                $("#"+kan[sn-1].bhero.id).remove();
                $("#g"+sn).children('.bpsta').remove();
                var bbpro = kan[sn-1].bhero.pro;
                kan[sn-1].bhero=null;
                kan[sn-1].count-=20;
                socket.emit('zero hp', yousd, sn);
                if(bbpro=="king"){
                    socket.emit('you win', yousd);
                    alert("you lose");
                    retry_setting();
                }
        }else{
            var damage = kan[sn-1].rstrap.enumber;
            kan[sn-1].bhero.hp=kan[sn-1].bhero.hp-kan[sn-1].rstrap.enumber;
            $("#g"+sn).children('.bpsta').children('.p_hp').text(kan[sn-1].bhero.hp);
            socket.emit('debuff hp', yousd, sn, damage);
        }
    }
    function dehp_zero_commit(sn){
        alert("hp제로 함정에 걸리셨습니다.+현재 칸 "+sn);
        kan[sn-1].bhero.hp=kan[sn-1].bhero.hp/2;
        $("#g"+sn).children('.bpsta').children('.p_hp').text(kan[sn-1].bhero.hp);
        socket.emit('zero hp', yousd,sn);
        
        if(kan[sn-1].count==30){
                var hzeo = document.getElementById("g"+sn);
                hzeo.removeChild(hzeo.lastChild);
                $("#"+kan[sn-1].rhero.id).attr("style","opacity:1");
                $("#"+kan[sn-1].rhero.id).show();
                $("#g"+kan[sn-1].rhero.pos).children('.rpsta').attr("style","opacity:1");
                $("#g"+kan[sn-1].rhero.pos).children('.rpsta').show();
						            
        }
        kan[sn-1].bhero.hp=0;
        $("#"+kan[sn-1].bhero.id).remove();
        $("#g"+sn).children('.bpsta').remove();
        var bbpro2 = kan[sn-1].bhero.pro;
        kan[sn-1].bhero=null;
        kan[sn-1].count-=20;
        socket.emit('zero hp', yousd, sn);
        if(bbpro2=="king"){
            socket.emit('you win', yousd);
            alert("you lose");
            retry_setting();
        }
    }
    function dehp_half_commit(sn){
        alert("hp절반 함정에 걸리셨습니다.+현재 칸 "+sn);
        kan[sn-1].bhero.hp=kan[sn-1].bhero.hp/2;
        $("#g"+sn).children('.bpsta').children('.p_hp').text(kan[sn-1].bhero.hp);
        socket.emit('half hp', yousd,cid,sn);
    }
    function deat_commit(sn){
        if(kan[sn-1].bhero.attack<=kan[sn-1].rstrap.enumber){
                kan[sn-1].bhero.attack=0;
                $("#g"+sn).children('.bpsta').children('.p_attack').text(0);
                socket.emit('zero attack', yousd, sn);
        }else{
                var damage = kan[sn-1].rstrap.enumber;
                kan[sn-1].bhero.attack=kan[sn-1].bhero.attack-kan[sn-1].rstrap.enumber;
                $("#g"+sn).children('.bpsta').children('.p_attack').text(kan[sn-1].bhero.attack);
                socket.emit('debuff attack', yousd, sn, damage);
        }
    }
    function deat_zero_commit(sn){
        alert("attack 제로 함정에 걸리셨습니다.+현재 칸 "+sn);
        kan[sn-1].bhero.attack=0;
        $("#g"+sn).children('.bpsta').children('.p_attack').text(0);
        socket.emit('zero attack', yousd, sn);
    }
    function deat_half_commit(sn){
        alert("attack 절반 함정에 걸리셨습니다.+현재 칸 "+sn);
        kan[sn-1].bhero.attack=kan[sn-1].bhero.attack/2;
        $("#g"+sn).children('.bpsta').children('.p_attack').text(kan[sn-1].bhero.attack);
        socket.emit('half attack', yousd,sn);
    }
    function trap_sturn_commit(sn){
        var plid = "g"+kan[sn-1].bhero.pos;
        var trid = sn;
        //var trnum = parseInt(sn);
        kan[sn-1].sturn="true";
        kan[sn-1].sturn_count=1;
        var cstad2 = document.createElement('div');
        cstad2.setAttribute("class","sturn");
        document.getElementById(plid).appendChild(cstad2);
        socket.emit('trap_sturn hero', yousd, sn);
    }
    function change_ha_commit(sn){
        //swit="true";
        var hid = "g"+kan[sn-1].bhero.pos;
        //var did = parseInt(hid.substring(1)); 
        var b_hp = kan[sn-1].bhero.hp;
        var b_attack = kan[sn-1].bhero.attack;
        kan[sn-1].bhero.hp = b_attack;
        kan[sn-1].bhero.attack = b_hp;
        //$(".change_ha").remove();
        $("#g"+kan[sn-1].bhero.pos).children('.bpsta').children('.p_hp').text(kan[sn-1].bhero.hp);
        $("#g"+kan[sn-1].bhero.pos).children('.bpsta').children('.p_attack').text(kan[sn-1].bhero.attack);
        socket.emit('change trap_hp_attack', yousd, sn);
    }
    function dehp_all_commit(sn,team){
        if(team=='b'){
            for(var i in kan){
                if(kan[i].count==20){
                    if(kan[i].bhero.hp<=kan[sn-1].rstrap.enumber){
                        kan[i].bhero.hp=0;
                        $("#"+kan[i].bhero.id).remove();
                        $("#g"+kan[i].bhero.pos).children('.bpsta').remove();
                        var bbpro = kan[i].bhero.pro;
                        var bopos = kan[i].bhero.pos;
                        kan[i].bhero=null;
                        kan[i].count-=20;
                        socket.emit('zero hp', yousd,bopos);
                        if(bbpro=="king"){
                            socket.emit('you win', yousd);
                            alert("you lose");
                            retry_setting();
                        }
                    }else{
                            var damage = kan[sn-1].rstrap.enumber;
                            kan[i].bhero.hp=kan[i].bhero.hp-kan[sn-1].rstrap.enumber;
                            $("#g"+kan[i].bhero.pos).children('.bpsta').children('.p_hp').text(kan[i].bhero.hp);
                            var all_pos = parseInt(i)+1;
                            socket.emit('debuff hp', yousd, all_pos, damage);
                    }
                }
            }
        }else{
            for(var i in kan){
                if(kan[i].count==10){
                    if(kan[i].rhero.hp<=kan[sn-1].rstrap.enumber){
                        kan[i].rhero.hp=0;
                        $("#"+kan[i].rhero.id).remove();
                        $("#g"+kan[i].rhero.pos).children('.rpsta').remove();
                        var bbpro = kan[i].rhero.pro;
                        var bopos2 = parseInt(i);
                        kan[i].rhero=null;
                        kan[i].count-=10;
                        socket.emit('zero rival_hp', yousd,bopos2);
                        if(bbpro=="king"){
                            socket.emit('you lose', yousd);
                            alert("you win");
                            retry_setting();
                        }
                    }else{
                            var damage2 = kan[sn-1].rstrap.enumber;
                            kan[i].rhero.hp=kan[i].rhero.hp-kan[sn-1].rstrap.enumber;
                            $("#g"+kan[i].rhero.pos).children('.rpsta').children('.p_hp').text(kan[i].rhero.hp);
                            var all_pos2 = parseInt(i)+1;
                            socket.emit('debuff rival_hp', yousd, all_pos2, damage2);
                    }
                }
            }
        }
    }
    function dehp_self_commit(sn){
        if(kan[sn-1].bhero.hp<=kan[sn-1].bhero.attack){
                if(kan[sn-1].count==30){
                    var hzeo2 = document.getElementById("g"+sn);
                    hzeo2.removeChild(hzeo2.lastChild);
                    $("#"+kan[sn-1].bhero.id).attr("style","opacity:1");
                    $("#"+kan[sn-1].bhero.id).show();
                    $("#g"+kan[sn-1].bhero.pos).children('.bpsta').attr("style","opacity:1");
                    $("#g"+kan[sn-1].bhero.pos).children('.bpsta').show();
                }
                kan[sn-1].bhero.hp=0;
                $("#"+kan[sn-1].bhero.id).remove();
                $("#g"+sn).children('.bpsta').remove();
                var bbpro = kan[sn-1].bhero.pro;
                kan[sn-1].bhero=null;
                kan[sn-1].count-=20;
                socket.emit('zero hp', yousd, sn);
                if(bbpro=="king"){
                    socket.emit('you win', yousd);
                    alert("you lose");
                    retry_setting();
                }
        }else{
            var damage = kan[sn-1].bhero.attack;
            kan[sn-1].bhero.hp=kan[sn-1].bhero.hp-kan[sn-1].bhero.attack;
            $("#g"+sn).children('.bpsta').children('.p_hp').text(kan[sn-1].bhero.hp);
            socket.emit('debuff hp', yousd, sn, damage);
        }
    }
    function dehp_ran_commit(sn){
        var ran_dam = Math.floor(Math.random() * kan[sn-1].rstrap.enumber) + 1;
        if(kan[sn-1].bhero.hp<=ran_dam){
                if(kan[sn-1].count==30){
                    var hzeo2 = document.getElementById("g"+sn);
                    hzeo2.removeChild(hzeo2.lastChild);
                    $("#"+kan[sn-1].bhero.id).attr("style","opacity:1");
                    $("#"+kan[sn-1].bhero.id).show();
                    $("#g"+kan[sn-1].bhero.pos).children('.bpsta').attr("style","opacity:1");
                    $("#g"+kan[sn-1].bhero.pos).children('.bpsta').show();
                }
                kan[sn-1].bhero.hp=0;
                $("#"+kan[sn-1].bhero.id).remove();
                $("#g"+sn).children('.bpsta').remove();
                var bbpro = kan[sn-1].bhero.pro;
                kan[sn-1].bhero=null;
                kan[sn-1].count-=20;
                socket.emit('zero hp', yousd, sn);
                if(bbpro=="king"){
                    socket.emit('you win', yousd);
                    alert("you lose");
                    retry_setting();
                }
        }else{
            var damage = ran_dam;
            kan[sn-1].bhero.hp=kan[sn-1].bhero.hp-ran_dam;
            $("#g"+sn).children('.bpsta').children('.p_hp').text(kan[sn-1].bhero.hp);
            socket.emit('debuff hp', yousd, sn, damage);
        }
    }
    function inhp_ran_commit(target,number){
        var target_pos = check_hero_here(target);
        if (target_pos!=nul){
            var ppis = parseInt(target_pos)+1;
            var ran_heal = Math.floor(Math.random() * number) + 1;
            kan[target_pos].bhero.hp += ran_heal;
            $("#g"+ppis).children('.bpsta').children('.p_hp').text(kan[target_pos].bhero.hp);

            socket.emit('set rival_magichp', yousd,ppis,ran_heal);
        }
    }
    function inhp_commit(target,number){
        if (target_pos!=nul){
            var target_pos = check_hero_here(target);
            var ppis = parseInt(target_pos)+1;
            kan[target_pos].bhero.hp += number;
            if(kan[target_pos].bhero.hp<=0){
                kan[target_pos].bhero.hp = 0;

                if(kan[target_pos].count==30){
                        var hzeo2 = document.getElementById("g"+ppis);
                        hzeo2.removeChild(hzeo2.lastChild);
                        $("#"+kan[target_pos].bhero.id).attr("style","opacity:1");
                        $("#"+kan[target_pos].bhero.id).show();
                        $("#g"+kan[target_pos].bhero.pos).children('.bpsta').attr("style","opacity:1");
                        $("#g"+kan[target_pos].bhero.pos).children('.bpsta').show();
                    }
                    kan[target_pos].bhero.hp=0;
                    $("#"+kan[target_pos].bhero.id).remove();
                    $("#g"+ppis).children('.bpsta').remove();
                    var bbpro = kan[target_pos].bhero.pro;
                    kan[target_pos].bhero=null;
                    kan[target_pos].count-=20;
                    socket.emit('zero hp', yousd, ppis);
                    if(bbpro=="king"){
                        socket.emit('you win', yousd);
                        alert("you lose");
                        retry_setting();
                    }

            }else{
                $("#g"+ppis).children('.bpsta').children('.p_hp').text(kan[target_pos].bhero.hp);
                socket.emit('set rival_magichp', yousd,ppis,number);
            }
        }
    }
    function inat_commit(target,number){
        var target_pos = check_hero_here(target);
        if (target_pos!=nul){
            var ppis = parseInt(target_pos)+1;
            kan[target_pos].bhero.attack += number;
            if(kan[target_pos].bhero.attack<=0){
                kan[target_pos].bhero.attack = 0;
            }
            $("#g"+ppis).children('.bpsta').children('.p_attack').text(kan[target_pos].bhero.attack);
            socket.emit('set rival_magicat', yousd,ppis,number);
        }
    }
</script>
<script src="./pub/Gacha/Gacha.js"></script>
<script src="./pub/Deck/Deck.js"></script>
<script src="./pub/Deck_Skill/Deck_Skill.js"></script>
</body>
<script src="https://mattstow.com/experiment/responsive-image-maps/jquery.rwdImageMaps.min.js"></script> 

<script> 
    (function($){ 
        $(document).ready(function(e) { 
            $('img[usemap]').rwdImageMaps();
        }); 
    })(jQuery);
    
    $('.mapmouseover').bind('click', function(){ pagemove(this.id); });
    $('.mapmouseover').bind('mouseover', function(){ $('#' + this.id + '_text').show(); $('#mouseover_total_id').show(); });
    $('.mapmouseover').bind('mouseout', function(){ $('#' + this.id + '_text').hide(); $('#mouseover_total_id').hide(); });
    
    function pagemove(where) {

	if (where == "gacha_id") { $('#main_view').hide(); $('#gacha_main').show(); sell_fisrt_loading(); }
	else if (where == "deck_id") { $('#main_view').hide(); $('#deck_main').show(); field_update(); }
	else if (where == "skill_deck_id") { $('#main_view').hide(); $('#deck_skill_main').show(); first_loading(); }
    }
    
    var info_count = false;
    var cfield_count = true;
    
    $('#info_on').css('color', 'red');
    
    $('#info_on').bind('click', function(){ 
        if(info_count) {
            $('#mit').show();
            $('#mit_back').show();
            info_count = false;
            $('#info_on').css('color', 'red');
        } 
        else { 
            $('#mit').hide(); 
            $('#mit_back').hide();
            info_count=true;
             $('#info_on').css('color', 'white');
        } 
    }); 
    
    $('#chat_on').bind('click', function(){
        if(cfield_count) {
            $('#cfield').show();
            $('#cfield_back').show();
            cfield_count = false;
            $('#chat_on').css('color', 'red');
            $('#black_eft').show();

        } 
        else { 
            $('#cfield').hide(); 
            $('#cfield_back').hide();
            cfield_count=true;
            $('#chat_on').css('color', 'white');
            $('#black_eft').hide();
        } 
    }); 
    
    var player_info = new Array();
    var exp = 0;
    
    socket.on('login_push_result', function(result){
        //alert("dd");
        player_info = result;
        player_info_update();
    });
    
    function player_info_update() {
        
        level_check();
        
        $('#profile_level').html("Level : " + player_info[0].lv);
        $('#profile_exp').html("Need Exp : " + exp);
	    $('#profile_gold').html("Gold : " + player_info[0].gold);
        $('#profile_win').html("Win : " + player_info[0].win);
	    $('#profile_lose').html("Lose : " + player_info[0].lose);
    }
    
    function level_check() {
	var lv_score = player_info[0].win*100 - player_info[0].lose*80 + 800;

	player_info[0].lv = lv_score/800;
	exp = 800 - lv_score%800;
}

</script>
</html>